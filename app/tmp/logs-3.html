<body style="border: 10px solid blue;">
  <script>
    // make sure global mdn object exists
    var mdn = window.mdn || {};

    (function(win) {
        'use strict';

        win.mdn.features = {};
        win.mdn.stripePublicKey = 'pk_live_GZl4tCi8J5mWhKbJeRey4DSy';
        win.mdn.contributionSupportEmail = 'mdn-support@mozilla.com';

        win.mdn.siteUrl = 'https://developer.mozilla.org';
        win.mdn.wikiSiteUrl = 'https://wiki.developer.mozilla.org';
        win.mdn.staticPath = '/static/';
        win.mdn.wiki = {
            autosuggestTitleUrl: '/en-US/docs/get-documents'
        };

        win.mdn.notifications = [];

        

        // interactive editor config
        win.mdn.interactiveEditor = {
            siteUrl: "https://developer.mozilla.org",
            editorUrl: "https://interactive-examples.mdn.mozilla.net"
        };
        win.mdn.langCookieName = "django_language";

    })(this);
</script>

  

  <div id="react-container" data-component-name="SPA"><div class="loading-bar"></div><ul id="nav-access" data-testid="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-language" href="#language">Select language</a></li><li><a id="skip-search" href="#main-q">Skip to search</a></li></ul><header class="page-header" data-testid="header"><a href="/en-US/" class="logo" aria-label="MDN Web Docs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 219 48" role="img"><path d="M49.752 30.824h59.917v17.132H49.75zm57.23 12.3c-.103.03-.21.048-.316.05-.338 0-.514-.15-.514-.582v-3.256c0-1.71-1.352-2.543-2.976-2.543a7.206 7.206 0 00-3.21.676l-.29 1.724 1.71.182.245-.842a2.338 2.338 0 011.147-.216c1.214 0 1.23.913 1.23 1.69v.234c-.407-.048-.818-.07-1.23-.068-1.71 0-3.49.433-3.49 2.276 0 1.563 1.23 2.144 2.31 2.144a2.7 2.7 0 002.41-1.494c.018.88.77 1.563 1.648 1.494a2.89 2.89 0 001.353-.338zm-4.604-.05a.787.787 0 01-.88-.867c0-.815.677-1.015 1.432-1.015.36.008.722.04 1.078.098-.05 1.235-.852 1.783-1.63 1.783zM97.388 33l-3.24 11.433h2.11L99.5 33.002zm-4.353 0l-3.24 11.433h2.11L95.145 33zm-6.89 6.645h2.243V36.94h-2.242zm0 4.802h2.243v-2.706h-2.242zm-3.617-1.64H80.1l4.156-4.736-.166-1.13h-6.58l-.268 2.63 1.546.164.338-1.163h2.343l-4.123 4.734.216 1.13h6.544l.467-2.63-1.69-.164zM72.143 36.79c-2.706 0-4.02 1.812-4.02 4.004 0 2.394 1.595 3.804 3.905 3.804 2.394 0 4.122-1.51 4.122-3.905-.003-2.093-1.32-3.906-4.01-3.906zm-.054 6.154c-1.165 0-1.763-.997-1.763-2.292 0-1.414.676-2.23 1.778-2.23 1.015 0 1.83.677 1.83 2.196 0 1.438-.73 2.327-1.846 2.327zm-5.906-3.564c0-1.78-1.224-2.594-2.577-2.594a2.51 2.51 0 00-2.44 1.612c-.367-1.1-1.364-1.613-2.443-1.613a2.48 2.48 0 00-2.276 1.278v-1.13h-3.14v1.63h.996v4.24h-.997v1.63h4.572v-1.63h-1.432V40.2c0-1.048.433-1.78 1.448-1.78.845 0 1.278.502 1.278 1.797v4.224h3.14v-1.63h-.996v-2.612c0-1.048.433-1.78 1.447-1.78.846 0 1.278.502 1.278 1.797v4.214h3.142V42.8h-.998zm78.791-22.39h-6.29c.23-1.935 1.16-3.558 3.274-3.558 2.245 0 3.2 1.857 3.016 3.558zM218.952 0v29.137h-169.2V0zM71.706 6.885h-3.85L61.51 20.01h-.104L54.882 6.884h-3.84v1.65h2.19V21.98H51.12v1.65h5.927v-1.65h-2.012V11.24h.1l5.75 11.553H61.9l5.62-11.474h.105v10.66h-1.962v1.65h5.942v-1.65h-2.09V8.536h2.19zm9.993 16.76c5.285 0 8.484-3.48 8.484-8.42 0-4.847-3.094-8.353-8.56-8.353H74.12v1.623h2.114v13.527H74.12v1.623zm27.05-16.76h-6.426v1.65h2.526v11.268h-.1L95.21 6.885H91.6v1.65h2.22V21.98h-1.935v1.65h6.385v-1.65h-2.655V10.444h.1l9.724 13.202h1.21V8.535h2.09zm26.71 5.29h-5.156v1.467h1.83l-1.857 7.247h-.128l-3.586-8.716h-1.21l-3.423 8.718h-.127l-2.14-7.247h1.933v-1.47h-5.41v1.467h1.522l3.25 10.003h1.352l3.432-8.766h.13l3.496 8.765h1.393l3.122-10.003h1.573zm6.704 11.727c2.837 0 4.514-1.583 4.83-3.568l-1.523-.338c-.36 1.42-1.365 2.347-3.17 2.347-2.283 0-3.53-1.468-3.636-4.02h8.058c.1-.445.153-.898.156-1.354-.024-2.71-1.728-5.03-4.873-5.03-3.246 0-5.26 2.58-5.26 6.14 0 3.712 2.162 5.825 5.412 5.825zm13.408 0c3.663 0 5.134-3.25 5.134-6.294 0-3.642-2.063-5.67-4.924-5.67-2.19 0-3.402 1.186-4.1 2.603V5.905h-3.53v1.47h1.692v12.923a22.8 22.8 0 01-.338 3.35h1.805a44.05 44.05 0 00.235-1.906c.747 1.39 2.242 2.165 4.02 2.165zm26.198-1.728h-1.985V5.904h-4.6v1.47h2.798v6.653c-.748-1.342-2.15-2.09-3.842-2.09-3.74 0-5.183 3.2-5.183 6.267 0 3.584 1.958 5.698 4.924 5.698 2.087 0 3.352-1.224 4.1-2.577v2.323h3.784zm6.963 1.728c3.53 0 5.75-2.526 5.742-6.006 0-3.25-1.934-5.982-5.647-5.982s-5.67 2.735-5.67 6.087c0 3.457 2.09 5.905 5.568 5.905zm12.942 0c3.172 0 4.538-2.114 4.866-4.112l-1.548-.34c-.334 1.885-1.315 2.917-3.094 2.917-2.27 0-3.507-1.637-3.507-4.397 0-2.475.982-4.487 3.43-4.487a4.4 4.4 0 012.45.646l.42 1.936 1.496-.18-.44-2.758c-1.16-.876-2.397-1.187-3.92-1.187-3.556 0-5.362 2.966-5.362 6.14 0 3.685 2.036 5.825 5.208 5.825zm11.166 0c2.76 0 4.874-1.34 4.847-3.595 0-4.565-7.1-2.195-7.1-5.184 0-1.177 1.03-1.69 2.474-1.69.826-.015 1.64.18 2.368.567l.267 1.864 1.495-.18-.284-2.68a8.135 8.135 0 00-3.997-1.06c-2.088 0-4.255.903-4.255 3.328 0 4.46 7.193 2.063 7.193 5.208 0 1.315-1.495 1.934-3.095 1.934a5.812 5.812 0 01-2.553-.568l.078-1.522-1.444-.156-.362 2.604c.977.643 2.736 1.133 4.36 1.133zm-54.042-6.11c0 2.373-1.058 4.564-3.584 4.564a3.455 3.455 0 01-3.534-3.456v-1.728c.05-1.7 1.444-3.686 3.635-3.686 1.948 0 3.48 1.444 3.483 4.305zm19.18-1.06v1.833c-.076 1.73-1.57 3.79-3.634 3.79-1.985 0-3.48-1.47-3.48-4.28 0-2.425 1.133-4.59 3.686-4.59a3.36 3.36 0 013.43 3.248zm14.597 1.133c0 2.58-1.34 4.488-3.79 4.488-2.453 0-3.74-1.958-3.74-4.46 0-2.55 1.34-4.434 3.74-4.434 2.397 0 3.79 1.778 3.79 4.405zm-104.39-2.593c0 4.16-2.32 6.763-6.574 6.763h-3.478V8.508h3.466c4.254 0 6.574 2.71 6.587 6.764zM.116 0h47.956v47.956H.116zM42.01 22.02c-.036-.723-.12-1.448-.17-2.166a1.74 1.74 0 00-.395-.98 2.465 2.465 0 00-1.026-.74c-.808-.314-1.622-.664-2.435-.975a21.509 21.509 0 01-3.342-1.472 2.626 2.626 0 01-1.296-1.972 2.954 2.954 0 00-1.47-2.228 4.062 4.062 0 00-2.958-.35c-.734.176-1.5.165-2.23-.033l-1.112-.34-.302-.09-.873-.26c-1.57-.468-2.228-.713-4.773-.278a14.678 14.678 0 00-7.09 3.897l-6.37 6.76h5.72l-3.504 3.71h6.026l-3.503 3.71h4.844l-1.548 4.06c5.93 6.07 12.25 7.295 12.25 7.295 0-1.673.38-8.24.826-9.34a5.25 5.25 0 01.762-1.54 4.211 4.211 0 013.393-1.547c1.303 0 2.597.238 3.815.702.74.31 1.577.264 2.277-.122a38.42 38.42 0 001.498-.94.839.839 0 01.556-.18c.54.06 1.054-.237 1.27-.734.16-.33.35-.64.524-.97.472-.884.69-1.88.633-2.88z"></path></svg></a><nav class="main-nav" aria-label="Main menu"><button type="button" class="ghost main-menu-toggle" aria-haspopup="true" aria-label="Show Menu"></button><ul class="main-menu "><li class="top-level-entry-container"><button type="button" class="top-level-entry" aria-haspopup="true">Technologies</button><ul aria-expanded="false"><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web">Technologies Overview</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/HTML">HTML</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/CSS">CSS</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/JavaScript">JavaScript</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/Guide/Graphics">Graphics</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/HTTP">HTTP</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/API">APIs / DOM</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions">Browser Extensions</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/MathML">MathML</a></li></ul></li><li class="top-level-entry-container"><button type="button" class="top-level-entry" aria-haspopup="true">References &amp; Guides</button><ul aria-expanded="false"><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Learn">Learn web development</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web/Tutorials">Tutorials</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web/Reference">References</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web/Guide">Developer Guides</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web/Accessibility">Accessibility</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Games">Game development</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web">...more docs</a></li></ul></li><li class="top-level-entry-container"><button type="button" class="top-level-entry" aria-haspopup="true">Feedback</button><ul aria-expanded="false"><li data-item="Feedback" role="menuitem"><a href="/en-US/docs/MDN/Feedback">Send Feedback</a></li><li data-item="Feedback" role="menuitem"><a target="_blank" rel="noopener noreferrer" href="https://support.mozilla.org/">Get Firefox help<!-- --> 🌐</a></li><li data-item="Feedback" role="menuitem"><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/">Get web development help<!-- --> 🌐</a></li><li data-item="Feedback" role="menuitem"><a href="/en-US/docs/MDN/Community">Join the MDN community</a></li><li data-item="Feedback" role="menuitem"><a target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/sprints/issues/new?template=issue-template.md&amp;projects=mdn/sprints/2&amp;labels=user-report&amp;title=https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage">Report a content problem<!-- --> 🌐</a></li><li data-item="Feedback" role="menuitem"><a target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/kuma/issues/new/choose">Report an issue<!-- --> 🌐</a></li></ul></li></ul></nav><div class="header-search "><form id="nav-main-search" action="/en-US/search" method="get" role="search"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" class="search-icon"><path fill-rule="nonzero" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg><label for="main-q" class="visually-hidden">Search MDN</label><input type="search" class="search-input-field" id="main-q" name="q" placeholder="Search MDN" pattern="(.|\s)*\S(.|\s)*" required=""></form><button class="toggle-form"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" class="close-icon hide"><path d="M18.3 5.71a.996.996 0 00-1.41 0L12 10.59 7.11 5.7A.996.996 0 105.7 7.11L10.59 12 5.7 16.89a.996.996 0 101.41 1.41L12 13.41l4.89 4.89a.996.996 0 101.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z" fill-rule="nonzero"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" class="search-icon"><path fill-rule="nonzero" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg><span>Open search</span></button></div><a href="/en-US/users/account/signup-landing?next=/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage" rel="nofollow" class="signin-link">Sign in</a></header><main role="main"><header class="documentation-page-header"><div class="titlebar-container"><div class="titlebar"><h1 class="title">runtime.onMessage</h1></div></div><div class="full-width-row-container"><div class="max-content-width-container"><nav class="breadcrumbs" role="navigation"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla" class="breadcrumb-chevron" property="item" typeof="WebPage"><span class="pre-text">See<!-- -->&nbsp;</span><span property="name">Mozilla</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla/Add-ons" class="breadcrumb-chevron" property="item" typeof="WebPage"><span class="pre-text">See<!-- -->&nbsp;</span><span property="name">Add-ons</span></a><meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions" class="breadcrumb-chevron" property="item" typeof="WebPage"><span class="pre-text">See<!-- -->&nbsp;</span><span property="name">Browser Extensions</span></a><meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API" class="breadcrumb-chevron" property="item" typeof="WebPage"><span class="pre-text">See<!-- -->&nbsp;</span><span property="name">JavaScript APIs</span></a><meta property="position" content="4"></li><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime" class="breadcrumb-previous" property="item" typeof="WebPage"><span class="pre-text">See<!-- -->&nbsp;</span><span property="name">runtime</span></a><meta property="position" content="5"></li><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage" class="crumb-current-page" property="item" typeof="WebPage"><span property="name" aria-current="page">runtime.onMessage</span></a><meta property="position" content="6"></li></ol></nav><div class="dropdown-container language-menu"><button id="header-language-menu" type="button" class="dropdown-menu-label" aria-haspopup="true" aria-owns="language-menu" aria-label="Current language is English. Choose your preferred language.">English<span class="dropdown-arrow-down" aria-hidden="true">▼</span></button><ul id="language-menu" class="dropdown-menu-items right " aria-expanded="false" role="menu"><li role="menuitem" lang="fa"><a href="/fa/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage" title="Persian"><bdi>فارسی</bdi></a></li><li role="menuitem" lang="fr"><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage" title="French"><bdi>Français</bdi></a></li><li role="menuitem" lang="ja"><a href="/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage" title="Japanese"><bdi>日本語</bdi></a></li><li role="menuitem" lang="zh-CN"><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage" title="Chinese (Simplified)"><bdi>中文 (简体)</bdi></a></li><li><a href="https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage$locales" rel="nofollow" id="translations-add">Add a translation</a></li></ul></div></div></div></header><div class="wiki-left-present content-layout"><aside class="document-toc-container"><section class="document-toc"><header><h2>On this Page</h2><button type="button" class="toc-trigger-mobile">Jump to section<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 28" aria-hidden="true" role="img"><path d="M16 11a.99.99 0 01-.297.703l-7 7C8.516 18.89 8.265 19 8 19s-.516-.109-.703-.297l-7-7A.996.996 0 010 11c0-.547.453-1 1-1h14c.547 0 1 .453 1 1z"></path></svg></button></header><ul><li><a href="#Syntax" rel="internal">Syntax</a></li><li><a href="#addListener_syntax" rel="internal">addListener syntax</a></li><li><a href="#Browser_compatibility" rel="internal">Browser compatibility</a></li><li><a href="#Examples" rel="internal">Examples</a></li><li class="toc-related-topics"><a href="#sidebar-quicklinks">Related topics</a></li></ul></section></aside><div id="content" class="article text-content"><article id="wikiArticle"><nav></nav>

<p>Use this event to listen for messages from another part of your extension.</p>

<p>Some example use cases are:</p>

<ul>
 <li><strong>in a <a href="/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Content_scripts">content script</a></strong>, to listen for messages from a <a href="/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Background_scripts">background script.</a></li>
 <li><strong>in a background script</strong>, to listen for messages from a content script.</li>
 <li><strong>in an <a href="/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Options_pages">options page</a> or <a href="/en-US/Add-ons/WebExtensions/User_interface_components#Popups">popup</a> script</strong>, to listen for messages from a background script.</li>
 <li><strong>in a background script</strong>, to listen for messages from an options page or popup script.</li>
</ul>

<p>To send a message that is received by the <code>onMessage()</code> listener, use <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage" title="Sends a single message to event listeners within your extension or a different extension."><code>runtime.sendMessage()</code></a> or (to send a message to a content script) <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/sendMessage" title="Sends a single message from the extension's background scripts (or other privileged scripts, such as popup scripts or options page scripts) to any content scripts or extension pages/iframes that belong to the extension and are running in the specified tab."><code>tabs.sendMessage()</code></a>.</p>

<div class="blockIndicator note">
<p>Avoid creating multiple <code>onMessage()</code> listeners for the same type of message, because the order in which multiple listeners will fire is not guaranteed.</p>

<p>If you want to guarantee the delivery of a message to a specific end point, use the <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#Connection-based_messaging">connection-based approach to exchange messages</a>.</p>
</div>

<p>Along with the message itself, the listener is passed:</p>

<ul>
 <li>a <code>sender</code> object giving details about the message sender.</li>
 <li>a <code>sendResponse()</code> function that can be used&nbsp;to send a response back to the sender.</li>
</ul>

<p>You can send a synchronous response to the message by calling the <code>sendResponse()</code> function inside your listener. <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_a_synchronous_response">See an example</a>.</p>

<p>To send an asynchronous response, there are two options:</p>

<ul>
 <li>return <code>true</code> from the event listener. This keeps the <code>sendResponse()</code> function valid after the listener returns, so you can call it later. <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_an_asynchronous_response_using_sendResponse">See an example</a>.</li>
 <li>return a <code>Promise</code> from the event listener, and resolve when you have the response (or reject it in case of an error). <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_an_asynchronous_response_using_a_Promise">See an example</a>.</li>
</ul>

<div class="warning">
<p>Returning a <code>Promise</code> is now preferred, as <code>sendResponse()</code> <a class="external" href="https://github.com/mozilla/webextension-polyfill/issues/16#issuecomment-296693219" rel="noopener">will be removed from the W3C spec</a>.</p>

<p>The popular <a class="external" href="https://github.com/mozilla/webextension-polyfill" rel="noopener">webextension-polyfill</a> library has already removed the <code>sendResponse()</code> function from its implementation.</p>
</div>

<div class="blockIndicator note">
<p>You can also use a <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#Connection-based_messaging">connection-based approach to exchange messages</a>.</p>
</div>

<h2 id="Syntax">Syntax</h2>

<pre class="syntaxbox brush:js notranslate">browser.runtime.onMessage.addListener(<var>listener</var>)
browser.runtime.onMessage.removeListener(<var>listener</var>)
browser.runtime.onMessage.hasListener(<var>listener</var>)
</pre>

<p>Events have three functions:</p>

<dl>
 <dt><code>addListener(<var>listener</var>)</code></dt>
 <dd>Adds a listener to this event.</dd>
 <dt><code>removeListener(<var>listener</var>)</code></dt>
 <dd>Stop listening to this event. The <code><var>listener</var></code> argument is the listener to remove.</dd>
 <dt><code>hasListener(<var>listener</var>)</code></dt>
 <dd>Checks whether at least one&nbsp;listener is registered for this event. Returns <code>true</code> if it is listening, <code>false</code> otherwise.</dd>
</dl>

<h2 id="addListener_syntax">addListener syntax</h2>

<h3 id="Parameters">Parameters</h3>

<dl>
 <dt><code><var>listener</var></code></dt>
 <dd>
 <p>A callback function that will be called when this event occurs. The function will be passed the following arguments:</p>

 <dl class="reference-values">
  <dt><code><var>message</var></code></dt>
  <dd><code>object</code>. The message itself. This is a JSON-ifiable object.</dd>
  <dt><code><var>sender</var></code></dt>
  <dd>A <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/MessageSender" title="An object containing information about the sender of a message or connection request; this is passed to the runtime.onMessage() listener."><code>runtime.MessageSender</code></a> object representing the sender of the message.</dd>
  <dt><code><var>sendResponse</var></code></dt>
  <dd>
  <p>A function to call, at most once, to send a response to the <code><var>message</var></code>. The function takes a single argument, which may be any JSON-ifiable object. This argument is passed back to the message sender.</p>

  <p>If you have more than one <code>onMessage()</code> listener in the same document, then only one may send a response.</p>

  <p>To send a response synchronously, call <code>sendResponse()</code> before the listener function returns.</p>

  <p>To send a response asynchronously:</p>

  <ul>
   <li>either keep a reference to the <code>sendResponse()</code> argument and return <code>true</code> from the listener function. You will then be able to call <code>sendResponse()</code> after the listener function has returned.</li>
   <li>or return a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> from the listener function and resolve the promise when the response is ready. This is a preferred way.</li>
  </ul>
  </dd>
 </dl>

 <p>The <code><var>listener</var></code> function can return either a Boolean or a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a>.</p>

 <div class="blockIndicator note">
 <p><strong>Important:</strong> Do not call <code>addListener()</code> using an <code>async</code> function:</p>

 <pre class="brush: js example-bad notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// don't do this</span>
browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> sender</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'handle_me'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'done'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

 <p>This will cause the listener to consume every message it receives, effectively blocking all other listeners from receiving and processing messages.</p>

 <p>If you want to take an asynchronous approach, use a Promise instead, like this:</p>

 <pre class="brush: js example-good notranslate line-numbers language-js"><code class=" language-js">browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span> 
<span class="token function"> </span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> sender</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'handle_me'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
 </div>
 </dd>
</dl>

<h2 id="Browser_compatibility">Browser compatibility</h2>

<p class="hidden">The compatibility table in this page is generated from structured data. If you'd like to contribute to the data, please check out <a class="external" href="https://github.com/mdn/browser-compat-data" rel="noopener">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</p>

<p>No compatibility data found. Please contribute data for "webextensions.api.runtime.onMessage()" (depth: 1) to the <a class="external" href="https://github.com/mdn/browser-compat-data" rel="noopener">MDN compatibility data repository</a>.</p>

<h2 id="Examples">Examples</h2>

<h3 id="Simple_example">Simple example</h3>

<p>This content script listens for click events on the web page. If the click was on a link, it messages the background page with the target URL:</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// content-script.js</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> notifyExtension<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">notifyExtension</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName <span class="token operator">!=</span> <span class="token string">"A"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"url"</span><span class="token punctuation">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>href<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>The background script listens for these messages and displays a notification using the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/notifications">notifications</a></code> API:</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// background-script.js</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>notify<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">notify</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  browser<span class="token punctuation">.</span>notifications<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"basic"</span><span class="token punctuation">,</span>
    <span class="token string">"iconUrl"</span><span class="token punctuation">:</span> browser<span class="token punctuation">.</span>extension<span class="token punctuation">.</span><span class="token function">getURL</span><span class="token punctuation">(</span><span class="token string">"link.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"You clicked a link!"</span><span class="token punctuation">,</span>
    <span class="token string">"message"</span><span class="token punctuation">:</span> message<span class="token punctuation">.</span>url
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Sending_a_synchronous_response">Sending a synchronous response</h3>

<p>This content script sends a message to the background script when the user clicks on the page. It also logs any response sent by the background script:</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// content-script.js</span>

<span class="token keyword">function</span> <span class="token function">handleResponse</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">background script sent a response: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token punctuation">.</span>response<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">handleError</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> sending <span class="token operator">=</span> browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>content<span class="token punctuation">:</span> <span class="token string">"message from the content script"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sending<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>handleResponse<span class="token punctuation">,</span> handleError<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> sendMessage<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Here is a version of the corresponding background script, that sends a response synchronously, from inside in the listener:</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// background-script.js</span>

<span class="token keyword">function</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> sendResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">content script sent a message: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>request<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sendResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>response<span class="token punctuation">:</span> <span class="token string">"response from background script"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>handleMessage<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>And here is another version which uses <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve"><code>Promise.resolve()</code></a>:</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// background-script.js</span>

<span class="token keyword">function</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> sendResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">content script sent a message: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>request<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>response<span class="token punctuation">:</span> <span class="token string">"response from background script"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>handleMessage<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Sending_an_asynchronous_response_using_sendResponse">Sending an asynchronous response using sendResponse</h3>

<p>Here is an alternative version of the background script from the previous example. It sends a response asynchronously after the listener has returned. Note <code>return true;</code> in the listener: this tells the browser that you intend to use the <code>sendResponse</code> argument after the listener has returned.</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// background-script.js</span>

<span class="token keyword">function</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> sendResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">content script sent a message: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>request<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">sendResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>response<span class="token punctuation">:</span> <span class="token string">"async response from background script"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>handleMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Sending_an_asynchronous_response_using_a_Promise">Sending an asynchronous response using a Promise</h3>

<p>This content script gets the first <code>&lt;a&gt;</code> link on the page and sends a message asking if the link's location is bookmarked. It expects to get a Boolean response (<code>true</code> if the location is bookmarked, <code>false</code> otherwise):</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// content-script.js</span>

<span class="token keyword">const</span> firstLink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleResponse</span><span class="token punctuation">(</span><span class="token parameter">isBookmarked</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isBookmarked<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    firstLink<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bookmarked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> firstLink<span class="token punctuation">.</span>href
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>handleResponse<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Here is the background script. It uses <code><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks/search" title="The bookmarks.search() function searches for bookmark tree nodes matching the given query."><code>bookmarks.search()</code></a></code> to see if the link is bookmarked, which returns a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a>:</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// background-script.js</span>

<span class="token keyword">function</span> <span class="token function">isBookmarked</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> browser<span class="token punctuation">.</span>bookmarks<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> message<span class="token punctuation">.</span>url
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> results<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>isBookmarked<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>If the asynchronous handler doesn't return a Promise, you can explicitly construct a promise. This rather contrived example sends a response after a 1-second delay, using <code><a href="/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout">Window.setTimeout()</a></code>:</p>

<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// background-script.js</span>

<span class="token keyword">function</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> sendResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>response<span class="token punctuation">:</span> <span class="token string">"async response from background script"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>handleMessage<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Example_extensions">Example extensions</h3><ul><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/beastify" rel="noopener">beastify</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/content-script-register" rel="noopener">content-script-register</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/cookie-bg-picker" rel="noopener">cookie-bg-picker</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/devtools-panels" rel="noopener">devtools-panels</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/export-helpers" rel="noopener">export-helpers</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/find-across-tabs" rel="noopener">find-across-tabs</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/imagify" rel="noopener">imagify</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/mocha-client-tests" rel="noopener">mocha-client-tests</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n" rel="noopener">notify-link-clicks-i18n</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/store-collected-images" rel="noopener">store-collected-images</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/user-script-register" rel="noopener">user-script-register</a></li><li><a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/webpack-modules" rel="noopener">webpack-modules</a></li></ul>

<div class="note"><strong>Acknowledgements</strong>

<p>This API is based on Chromium's <a class="external" href="https://developer.chrome.com/extensions/runtime#event-onMessage" rel="noopener"><code>chrome.runtime</code></a> API. This documentation is derived from <a class="external" href="https://chromium.googlesource.com/chromium/src/+/master/extensions/common/api/runtime.json" rel="noopener"><code>runtime.json</code></a> in the Chromium code.</p>

<p>Microsoft Edge compatibility data is supplied by Microsoft Corporation and is included here under the Creative Commons Attribution 3.0 United States License.</p>
</div>

<div class="hidden">
<pre class="brush: js notranslate line-numbers language-js"><code class=" language-js"><span class="token comment">// Copyright 2015 The Chromium Authors. All rights reserved.</span>
<span class="token comment">//</span>
<span class="token comment">// Redistribution and use in source and binary forms, with or without</span>
<span class="token comment">// modification, are permitted provided that the following conditions are</span>
<span class="token comment">// met:</span>
<span class="token comment">//</span>
<span class="token comment">//    * Redistributions of source code must retain the above copyright</span>
<span class="token comment">// notice, this list of conditions and the following disclaimer.</span>
<span class="token comment">//    * Redistributions in binary form must reproduce the above</span>
<span class="token comment">// copyright notice, this list of conditions and the following disclaimer</span>
<span class="token comment">// in the documentation and/or other materials provided with the</span>
<span class="token comment">// distribution.</span>
<span class="token comment">//    * Neither the name of Google Inc. nor the names of its</span>
<span class="token comment">// contributors may be used to endorse or promote products derived from</span>
<span class="token comment">// this software without specific prior written permission.</span>
<span class="token comment">//</span>
<span class="token comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="token comment">// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="token comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="token comment">// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="token comment">// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="token comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="token comment">// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="token comment">// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="token comment">// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="token comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="token comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</div></article><div class="metadata"><section class="document-meta"><header class="visually-hidden"><h4>Metadata</h4></header> <ul><li class="last-modified"><b>Last modified:</b> <time datetime="2020-01-25T12:47:39.697331">Jan 25, 2020</time>,<!-- --> <a href="https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage$history" rel="nofollow">by MDN contributors</a></li></ul></section></div></div><div id="sidebar-quicklinks" class="sidebar"><div class="quick-links"><div class="quick-links-head sidebar-heading">Related Topics</div><div>
  <ol>
    <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions"><strong>Browser extensions</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Getting started</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions">What are extensions?</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension">Your first extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension">Your second extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension">Anatomy of an extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Examples">Example extensions</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/What_next_">What next?</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Concepts</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs">Using the JavaScript APIs</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts">Content scripts</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">Match patterns</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_files">Working with files</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Internationalization">Internationalization</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy">Content Security Policy</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">Native messaging</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations">Differences between API implementations</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities">Chrome incompatibilities</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>User interface</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface">User Interface</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action">Toolbar button</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions">Address bar button</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars">Sidebars</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items">Context menu items</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages">Options page</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages">Extension pages</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications">Notifications</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox">Address bar suggestions</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels">Developer tools panels</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>How to</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests">Intercept HTTP requests</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page">Modify a web page</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page">Insert external content</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts">Share objects with page scripts</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar">Add a button to the toolbar</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page">Implement a settings page</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API">Work with the Tabs API</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API">Work with the Bookmarks API</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API">Work with the Cookies API</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities">Work with contextual identities</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension">Build a cross-browser extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators">Firefox differentiators</a></summary>
      </details>
    </li>
    <li class="toggle">
      <details open="">
        <summary>JavaScript APIs</summary>
        <ol><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs">Browser support for JavaScript APIs</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/alarms">alarms</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks">bookmarks</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserAction">browserAction</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings">browserSettings</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browsingData">browsingData</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal">captivePortal</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/clipboard">clipboard</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/commands">commands</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts">contentScripts</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities">contextualIdentities</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies">cookies</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools">devtools</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.inspectedWindow">devtools.inspectedWindow</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.network">devtools.network</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.panels">devtools.panels</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/dns">dns</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/downloads">downloads</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/events">events</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension">extension</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes">extensionTypes</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/find">find</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/history">history</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n">i18n</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/identity">identity</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/idle">idle</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/management">management</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/menus">menus</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/notifications">notifications</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/omnibox">omnibox</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pageAction">pageAction</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/permissions">permissions</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11">pkcs11</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/privacy">privacy</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/proxy">proxy</a></li><li class="webextension-api-sidebar"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime">runtime</a><ol><li data-default-state="open"><a href="#"><strong>Methods</strong></a><ol><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connect" title="Make a connection between different contexts inside the extension."><code>connect()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connectNative" title="For more information, see Native messaging."><code>connectNative()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getBackgroundPage" title="Retrieves the&nbsp;Window object for the background page running inside the current extension."><code>getBackgroundPage()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getBrowserInfo" title="Returns information about the browser in which the extension is installed."><code>getBrowserInfo()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getManifest" title="None."><code>getManifest()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getPackageDirectoryEntry" title="Returns a DirectoryEntry object representing the package directory."><code>getPackageDirectoryEntry()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getPlatformInfo" title="Returns information about the current platform. This can only be called in the background script context."><code>getPlatformInfo()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getURL" title="string. The fully-qualified URL to the resource."><code>getURL()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/openOptionsPage" title="This is an asynchronous function that returns a Promise."><code>openOptionsPage()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/reload" title="Reloads the extension."><code>reload()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/requestUpdateCheck" title="Checks to see if an update for the extension is available."><code>requestUpdateCheck()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage" title="Sends a single message to event listeners within your extension or a different extension."><code>sendMessage()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendNativeMessage" title="Sends a single message from an extension to a native application."><code>sendNativeMessage()</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/setUninstallURL" title="Sets the URL to be visited when the extension is uninstalled. This may be used to clean up server-side data, do analytics, or implement surveys. The URL can be a maximum 255 characters."><code>setUninstallURL()</code></a></li></ol></li><li data-default-state="open"><a href="#"><strong>Properties</strong></a><ol><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/id" title="The ID of the extension."><code>id</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/lastError" title="This value is used to report an error message from an asynchronous API, when the asynchronous API is given a callback. This is useful for extensions that are using the callback-based version of the WebExtension APIs."><code>lastError</code></a></li></ol></li><li data-default-state="open"><a href="#"><strong>Types</strong></a><ol><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/MessageSender" title="An object containing information about the sender of a message or connection request; this is passed to the runtime.onMessage() listener."><code>MessageSender</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/OnInstalledReason" title="The reason that the runtime.onInstalled event is being dispatched."><code>OnInstalledReason</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/OnRestartRequiredReason" title="The reason that the onRestartRequired event is being dispatched."><code>OnRestartRequiredReason</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/PlatformArch" title="The machine's processor architecture."><code>PlatformArch</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/PlatformInfo" title="An object containing information about the current platform."><code>PlatformInfo</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/PlatformNaclArch" title="The native client architecture. This may be different from arch on some platforms."><code>PlatformNaclArch</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/PlatformOs" title="The operating system the browser is running on."><code>PlatformOs</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port" title="A Port object represents one end of a connection between two specific contexts, which can be used to exchange messages."><code>Port</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/RequestUpdateCheckStatus" title="Result of a call to runtime.requestUpdateCheck()."><code>RequestUpdateCheckStatus</code></a></li></ol></li><li data-default-state="open"><a href="#"><strong>Events</strong></a><ol><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onBrowserUpdateAvailable" title="Fired when an update for the browser is available, but it isn't installed immediately because a browser restart is required."><code>onBrowserUpdateAvailable</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect" title="Fired when a connection is made with either an extension process or a content script."><code>onConnect</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnectExternal" title="Fired when an extension receives a connection request from a different extension."><code>onConnectExternal</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onInstalled" title="Fired when the extension is first installed, when the extension is updated to a new version, and when the browser is updated to a new version."><code>onInstalled</code></a></li><li><em><code>onMessage</code></em></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessageExternal" title="This API can't be used in a content script."><code>onMessageExternal</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onRestartRequired" title="Fired when an app or the device that it runs on needs to be restarted. The app should close all its windows at its earliest convenience to let the restart happen. If the app does nothing, a restart will be enforced after a 24-hour grace period has passed. Currently, this event is only fired for Chrome OS kiosk apps."><code>onRestartRequired</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onStartup" title="Fired when a profile that has this extension installed first starts up. This event is not fired when a private browsing/incognito profile is started, even if this extension is operating in 'split' incognito mode."><code>onStartup</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onSuspend" title="Sent to the event page just before it is unloaded. This gives the extension an opportunity to do some cleanup. Note that since the page is unloading, any asynchronous operations started while handling this event are not guaranteed to complete."><code>onSuspend</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onSuspendCanceled" title="Sent after runtime.onSuspend to indicate that the app won't be unloaded after all."><code>onSuspendCanceled</code></a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onUpdateAvailable" title="Fired when an update to the extension is available. This event enables an extension to delay an update: for example, because it is in the middle of some operation which should not be interrupted."><code>onUpdateAvailable</code></a></li></ol></li></ol></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/search">search</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sessions">sessions</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction">sidebarAction</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage">storage</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs">tabs</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/theme">theme</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/topSites">topSites</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/types">types</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/userScripts">userScripts</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation">webNavigation</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest">webRequest</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/windows">windows</a></li></ol>
      </details>
    </li>
    <li class="toggle">
      <details>
      <summary>Manifest keys</summary>
      <ol><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author">author</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background">background</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action">browser_action</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides">chrome_settings_overrides</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides">chrome_url_overrides</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands">commands</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts">content_scripts</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy">content_security_policy</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale">default_locale</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description">description</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer">developer</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page">devtools_page</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries">dictionaries</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable">externally_connectable</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url">homepage_url</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons">icons</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito">incognito</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version">manifest_version</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name">name</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled">offline_enabled</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox">omnibox</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions">optional_permissions</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page">options_page</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui">options_ui</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action">page_action</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">permissions</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers">protocol_handlers</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name">short_name</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action">sidebar_action</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage">storage</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme">theme</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment">theme_experiment</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts">user_scripts</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version">version</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name">version_name</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources">web_accessible_resources</a></li></ol>
      </details>
    </li>
     <li class="toggle">
      <details>
        <summary>Extension Workshop</summary>
        <ol>
          <li><a class="external" href="https://extensionworkshop.com/documentation/develop/" rel="noopener">Develop</a></li>
          <li><a class="external" href="https://extensionworkshop.com/documentation/publish/" rel="noopener">Publish</a></li>
          <li><a class="external" href="https://extensionworkshop.com/documentation/manage/" rel="noopener">Manage</a></li>
          <li><a class="external" href="https://extensionworkshop.com/documentation/enterprise/" rel="noopener">Enterprise</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/en-US/docs/Mozilla/Add-ons/Contact_us"><strong>Contact us</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Channels</summary>
        <ol>
          <li><a class="external" href="https://blog.mozilla.org/addons" rel="noopener">Add-ons blog</a></li>
          <li><a class="external" href="https://discourse.mozilla.org/c/add-ons" rel="noopener">Add-ons forum</a></li>
          <li><a class="external" href="https://chat.mozilla.org/#/room/%23addons:mozilla.org" rel="noopener">Add-ons chat</a></li>
        </ol>
      </details>
    </li>
  </ol>
</div></div></div></div></main><section class="newsletter-container"><div id="newsletter-form-container" class="newsletter"><form class="newsletter-form nodisable" name="newsletter-form"><section class="newsletter-head"><h2 class="newsletter-teaser">Learn the best of web development</h2><p class="newsletter-description">Get the latest and greatest from MDN delivered straight to your inbox.</p><p class="hidden" aria-hidden="true">The newsletter is offered in English only at the moment.</p></section><fieldset class="newsletter-fields"><input type="hidden" name="fmt" value="H"><input type="hidden" name="newsletters" value="app-dev"><div class="form-group newsletter-group-email"><label for="newsletter-email-input" class="form-label offscreen">E-mail</label><input type="email" id="newsletter-email-input" name="email" class="form-input newsletter-input-email" placeholder="you@example.com" required=""></div><div id="newsletter-privacy" class="hidden" aria-hidden="true"><input type="checkbox" id="newsletter-privacy-input" name="privacy" required=""><label for="newsletter-privacy-input">I’m okay with Mozilla handling my info as explained in this <a href="https://www.mozilla.org/privacy/">Privacy Policy</a>.</label></div><div class="newsletter-group-submit"><button id="newsletter-submit" type="submit" class="button neutral newsletter-submit">Sign up now</button></div></fieldset></form><button type="button" class="only-icon newsletter-hide" aria-controls="newsletter-form-container"><span>Hide Newsletter Sign-up</span><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><path d="M18.3 5.71a.996.996 0 00-1.41 0L12 10.59 7.11 5.7A.996.996 0 105.7 7.11L10.59 12 5.7 16.89a.996.996 0 101.41 1.41L12 13.41l4.89 4.89a.996.996 0 101.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z" fill-rule="nonzero"></path></svg></button></div></section><footer id="nav-footer" class="nav-footer" data-testid="footer"><div class="content-container"><a href="/en-US/" class="nav-footer-logo">MDN Web Docs</a><ul class="link-list-mdn"><li><a href="/en-US/docs/Web">Web Technologies</a></li><li><a href="/en-US/docs/Learn">Learn Web Development</a></li><li><a href="/en-US/docs/MDN/About">About MDN</a></li><li><a href="/en-US/docs/MDN/Feedback">Feedback</a></li></ul><ul class="link-list-moz"><li><a href="https://www.mozilla.org/about/" target="_blank" rel="noopener noreferrer">About</a></li><li><a href="https://shop.spreadshirt.com/mdn-store/" target="_blank" rel="noopener noreferrer">MDN Web Docs Store</a></li><li><a href="https://www.mozilla.org/contact/" target="_blank" rel="noopener noreferrer">Contact Us</a></li><li><a href="https://www.mozilla.org/firefox/?utm_source=developer.mozilla.org&amp;utm_campaign=footer&amp;utm_medium=referral" target="_blank" rel="noopener noreferrer">Firefox</a></li></ul><div class="social social-mdn"><h4>MDN</h4><ul><li><a href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><svg class="icon icon-twitter" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 28" aria-label="Twitter" role="img" focusable="false"><path d="M25.312 6.375a10.85 10.85 0 01-2.531 2.609c.016.219.016.438.016.656 0 6.672-5.078 14.359-14.359 14.359-2.859 0-5.516-.828-7.75-2.266.406.047.797.063 1.219.063 2.359 0 4.531-.797 6.266-2.156a5.056 5.056 0 01-4.719-3.5c.313.047.625.078.953.078.453 0 .906-.063 1.328-.172a5.048 5.048 0 01-4.047-4.953v-.063a5.093 5.093 0 002.281.641 5.044 5.044 0 01-2.25-4.203c0-.938.25-1.797.688-2.547a14.344 14.344 0 0010.406 5.281 5.708 5.708 0 01-.125-1.156 5.045 5.045 0 015.047-5.047 5.03 5.03 0 013.687 1.594 9.943 9.943 0 003.203-1.219 5.032 5.032 0 01-2.219 2.781c1.016-.109 2-.391 2.906-.781z"></path></svg></a></li><li><a href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><svg class="icon icon-github" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" aria-label="GitHub" role="img" focusable="false"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-.609.109-.828-.266-.828-.578 0-.391.016-1.687.016-3.297 0-1.125-.375-1.844-.812-2.219 2.672-.297 5.484-1.313 5.484-5.922 0-1.313-.469-2.375-1.234-3.219.125-.313.531-1.531-.125-3.187-1-.313-3.297 1.234-3.297 1.234a11.28 11.28 0 00-6 0S6.704 6.656 5.704 6.969c-.656 1.656-.25 2.875-.125 3.187-.766.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-.344.313-.656.844-.766 1.609-.688.313-2.438.844-3.484-1-.656-1.141-1.844-1.234-1.844-1.234-1.172-.016-.078.734-.078.734.781.359 1.328 1.75 1.328 1.75.703 2.141 4.047 1.422 4.047 1.422 0 1 .016 1.937.016 2.234 0 .313-.219.688-.828.578C3.439 23.796.002 19.296.002 13.999c0-6.625 5.375-12 12-12zM4.547 19.234c.031-.063-.016-.141-.109-.187-.094-.031-.172-.016-.203.031-.031.063.016.141.109.187.078.047.172.031.203-.031zm.484.532c.063-.047.047-.156-.031-.25-.078-.078-.187-.109-.25-.047-.063.047-.047.156.031.25.078.078.187.109.25.047zm.469.703c.078-.063.078-.187 0-.297-.063-.109-.187-.156-.266-.094-.078.047-.078.172 0 .281s.203.156.266.109zm.656.656c.063-.063.031-.203-.063-.297-.109-.109-.25-.125-.313-.047-.078.063-.047.203.063.297.109.109.25.125.313.047zm.891.391c.031-.094-.063-.203-.203-.25-.125-.031-.266.016-.297.109s.063.203.203.234c.125.047.266 0 .297-.094zm.984.078c0-.109-.125-.187-.266-.172-.141 0-.25.078-.25.172 0 .109.109.187.266.172.141 0 .25-.078.25-.172zm.906-.156c-.016-.094-.141-.156-.281-.141-.141.031-.234.125-.219.234.016.094.141.156.281.125s.234-.125.219-.219z"></path></svg></a></li></ul></div><div class="social social-moz"><h4>Mozilla</h4><ul><li><a href="https://twitter.com/mozilla" target="_blank" rel="noopener noreferrer"><svg class="icon icon-twitter" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 28" aria-label="Twitter" role="img" focusable="false"><path d="M25.312 6.375a10.85 10.85 0 01-2.531 2.609c.016.219.016.438.016.656 0 6.672-5.078 14.359-14.359 14.359-2.859 0-5.516-.828-7.75-2.266.406.047.797.063 1.219.063 2.359 0 4.531-.797 6.266-2.156a5.056 5.056 0 01-4.719-3.5c.313.047.625.078.953.078.453 0 .906-.063 1.328-.172a5.048 5.048 0 01-4.047-4.953v-.063a5.093 5.093 0 002.281.641 5.044 5.044 0 01-2.25-4.203c0-.938.25-1.797.688-2.547a14.344 14.344 0 0010.406 5.281 5.708 5.708 0 01-.125-1.156 5.045 5.045 0 015.047-5.047 5.03 5.03 0 013.687 1.594 9.943 9.943 0 003.203-1.219 5.032 5.032 0 01-2.219 2.781c1.016-.109 2-.391 2.906-.781z"></path></svg></a></li><li><a href="https://www.instagram.com/mozillagram/" target="_blank" rel="noopener noreferrer"><svg class="icon icon-instagram" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" aria-label="Instagram" role="img" focusable="false"><path d="M16 14c0-2.203-1.797-4-4-4s-4 1.797-4 4 1.797 4 4 4 4-1.797 4-4zm2.156 0c0 3.406-2.75 6.156-6.156 6.156S5.844 17.406 5.844 14 8.594 7.844 12 7.844s6.156 2.75 6.156 6.156zm1.688-6.406c0 .797-.641 1.437-1.437 1.437S16.97 8.39 16.97 7.594s.641-1.437 1.437-1.437 1.437.641 1.437 1.437zM12 4.156c-1.75 0-5.5-.141-7.078.484-.547.219-.953.484-1.375.906s-.688.828-.906 1.375c-.625 1.578-.484 5.328-.484 7.078s-.141 5.5.484 7.078c.219.547.484.953.906 1.375s.828.688 1.375.906c1.578.625 5.328.484 7.078.484s5.5.141 7.078-.484c.547-.219.953-.484 1.375-.906s.688-.828.906-1.375c.625-1.578.484-5.328.484-7.078s.141-5.5-.484-7.078c-.219-.547-.484-.953-.906-1.375s-.828-.688-1.375-.906C17.5 4.015 13.75 4.156 12 4.156zM24 14c0 1.656.016 3.297-.078 4.953-.094 1.922-.531 3.625-1.937 5.031s-3.109 1.844-5.031 1.937c-1.656.094-3.297.078-4.953.078s-3.297.016-4.953-.078c-1.922-.094-3.625-.531-5.031-1.937S.173 20.875.08 18.953C-.014 17.297.002 15.656.002 14s-.016-3.297.078-4.953c.094-1.922.531-3.625 1.937-5.031s3.109-1.844 5.031-1.937c1.656-.094 3.297-.078 4.953-.078s3.297-.016 4.953.078c1.922.094 3.625.531 5.031 1.937s1.844 3.109 1.937 5.031C24.016 10.703 24 12.344 24 14z"></path></svg></a></li></ul></div><p id="license" class="footer-license">© 2005-<!-- -->2020<!-- --> Mozilla and individual contributors. Content is available under<!-- --> <a href="/docs/MDN/About#Copyrights_and_licenses">these licenses</a>.</p><ul class="footer-legal"><li><a href="https://www.mozilla.org/about/legal/terms/mozilla" target="_blank" rel="noopener noreferrer">Terms</a></li><li><a href="https://www.mozilla.org/privacy/websites/" target="_blank" rel="noopener noreferrer">Privacy</a></li><li><a href="https://www.mozilla.org/privacy/websites/#cookies" target="_blank" rel="noopener noreferrer">Cookies</a></li></ul></div></footer></div>
<script>window._react_data = JSON.parse("{\"locale\":\"en-US\",\"stringCatalog\":{},\"pluralExpression\":null,\"url\":\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"documentData\":{\"locale\":\"en-US\",\"slug\":\"Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"enSlug\":\"Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"id\":172143,\"title\":\"runtime.onMessage\",\"summary\":\"Use this event to listen for messages from another part of your extension.\",\"language\":\"English (US)\",\"hrefLang\":\"en\",\"absoluteURL\":\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"wikiURL\":\"https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"editURL\":\"https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage$edit\",\"translateURL\":\"https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage$locales\",\"translationStatus\":null,\"bodyHTML\":\"<nav></nav>\\n\\n<p>Use this event to listen for messages from another part of your extension.</p>\\n\\n<p>Some example use cases are:</p>\\n\\n<ul>\\n <li><strong>in a <a href=\\\"/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Content_scripts\\\">content script</a></strong>, to listen for messages from a <a href=\\\"/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Background_scripts\\\">background script.</a></li>\\n <li><strong>in a background script</strong>, to listen for messages from a content script.</li>\\n <li><strong>in an <a href=\\\"/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Options_pages\\\">options page</a> or <a href=\\\"/en-US/Add-ons/WebExtensions/User_interface_components#Popups\\\">popup</a> script</strong>, to listen for messages from a background script.</li>\\n <li><strong>in a background script</strong>, to listen for messages from an options page or popup script.</li>\\n</ul>\\n\\n<p>To send a message that is received by the <code>onMessage()</code> listener, use <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage\\\" title=\\\"Sends a single message to event listeners within your extension or a different extension.\\\"><code>runtime.sendMessage()</code></a> or (to send a message to a content script) <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/sendMessage\\\" title=\\\"Sends a single message from the extension's background scripts (or other privileged scripts, such as popup scripts or options page scripts) to any content scripts or extension pages/iframes that belong to the extension and are running in the specified tab.\\\"><code>tabs.sendMessage()</code></a>.</p>\\n\\n<div class=\\\"blockIndicator note\\\">\\n<p>Avoid creating multiple <code>onMessage()</code> listeners for the same type of message, because the order in which multiple listeners will fire is not guaranteed.</p>\\n\\n<p>If you want to guarantee the delivery of a message to a specific end point, use the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#Connection-based_messaging\\\">connection-based approach to exchange messages</a>.</p>\\n</div>\\n\\n<p>Along with the message itself, the listener is passed:</p>\\n\\n<ul>\\n <li>a <code>sender</code> object giving details about the message sender.</li>\\n <li>a <code>sendResponse()</code> function that can be used\u00A0to send a response back to the sender.</li>\\n</ul>\\n\\n<p>You can send a synchronous response to the message by calling the <code>sendResponse()</code> function inside your listener. <a href=\\\"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_a_synchronous_response\\\">See an example</a>.</p>\\n\\n<p>To send an asynchronous response, there are two options:</p>\\n\\n<ul>\\n <li>return <code>true</code> from the event listener. This keeps the <code>sendResponse()</code> function valid after the listener returns, so you can call it later. <a href=\\\"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_an_asynchronous_response_using_sendResponse\\\">See an example</a>.</li>\\n <li>return a <code>Promise</code> from the event listener, and resolve when you have the response (or reject it in case of an error). <a href=\\\"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_an_asynchronous_response_using_a_Promise\\\">See an example</a>.</li>\\n</ul>\\n\\n<div class=\\\"warning\\\">\\n<p>Returning a <code>Promise</code> is now preferred, as <code>sendResponse()</code> <a class=\\\"external\\\" href=\\\"https://github.com/mozilla/webextension-polyfill/issues/16#issuecomment-296693219\\\" rel=\\\"noopener\\\">will be removed from the W3C spec</a>.</p>\\n\\n<p>The popular <a class=\\\"external\\\" href=\\\"https://github.com/mozilla/webextension-polyfill\\\" rel=\\\"noopener\\\">webextension-polyfill</a> library has already removed the <code>sendResponse()</code> function from its implementation.</p>\\n</div>\\n\\n<div class=\\\"blockIndicator note\\\">\\n<p>You can also use a <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#Connection-based_messaging\\\">connection-based approach to exchange messages</a>.</p>\\n</div>\\n\\n<h2 id=\\\"Syntax\\\">Syntax</h2>\\n\\n<pre class=\\\"syntaxbox brush:js notranslate\\\">browser.runtime.onMessage.addListener(<var>listener</var>)\\nbrowser.runtime.onMessage.removeListener(<var>listener</var>)\\nbrowser.runtime.onMessage.hasListener(<var>listener</var>)\\n</pre>\\n\\n<p>Events have three functions:</p>\\n\\n<dl>\\n <dt><code>addListener(<var>listener</var>)</code></dt>\\n <dd>Adds a listener to this event.</dd>\\n <dt><code>removeListener(<var>listener</var>)</code></dt>\\n <dd>Stop listening to this event. The <code><var>listener</var></code> argument is the listener to remove.</dd>\\n <dt><code>hasListener(<var>listener</var>)</code></dt>\\n <dd>Checks whether at least one\u00A0listener is registered for this event. Returns <code>true</code> if it is listening, <code>false</code> otherwise.</dd>\\n</dl>\\n\\n<h2 id=\\\"addListener_syntax\\\">addListener syntax</h2>\\n\\n<h3 id=\\\"Parameters\\\">Parameters</h3>\\n\\n<dl>\\n <dt><code><var>listener</var></code></dt>\\n <dd>\\n <p>A callback function that will be called when this event occurs. The function will be passed the following arguments:</p>\\n\\n <dl class=\\\"reference-values\\\">\\n  <dt><code><var>message</var></code></dt>\\n  <dd><code>object</code>. The message itself. This is a JSON-ifiable object.</dd>\\n  <dt><code><var>sender</var></code></dt>\\n  <dd>A <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/MessageSender\\\" title=\\\"An object containing information about the sender of a message or connection request; this is passed to the runtime.onMessage() listener.\\\"><code>runtime.MessageSender</code></a> object representing the sender of the message.</dd>\\n  <dt><code><var>sendResponse</var></code></dt>\\n  <dd>\\n  <p>A function to call, at most once, to send a response to the <code><var>message</var></code>. The function takes a single argument, which may be any JSON-ifiable object. This argument is passed back to the message sender.</p>\\n\\n  <p>If you have more than one <code>onMessage()</code> listener in the same document, then only one may send a response.</p>\\n\\n  <p>To send a response synchronously, call <code>sendResponse()</code> before the listener function returns.</p>\\n\\n  <p>To send a response asynchronously:</p>\\n\\n  <ul>\\n   <li>either keep a reference to the <code>sendResponse()</code> argument and return <code>true</code> from the listener function. You will then be able to call <code>sendResponse()</code> after the listener function has returned.</li>\\n   <li>or return a <a href=\\\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\\\"><code>Promise</code></a> from the listener function and resolve the promise when the response is ready. This is a preferred way.</li>\\n  </ul>\\n  </dd>\\n </dl>\\n\\n <p>The <code><var>listener</var></code> function can return either a Boolean or a <a href=\\\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\\\"><code>Promise</code></a>.</p>\\n\\n <div class=\\\"blockIndicator note\\\">\\n <p><strong>Important:</strong> Do not call <code>addListener()</code> using an <code>async</code> function:</p>\\n\\n <pre class=\\\"brush: js example-bad notranslate\\\">// don't do this\\nbrowser.runtime.onMessage.addListener(\\n\u00A0 async (data, sender) =&gt; {\\n    if (data.type === 'handle_me') { return 'done'; }\\n  }\\n);\\n</pre>\\n\\n <p>This will cause the listener to consume every message it receives, effectively blocking all other listeners from receiving and processing messages.</p>\\n\\n <p>If you want to take an asynchronous approach, use a Promise instead, like this:</p>\\n\\n <pre class=\\\"brush: js example-good notranslate\\\">browser.runtime.onMessage.addListener( \\n\u00A0 (data, sender) =&gt; {\\n    if (data.type === 'handle_me') {\\n\u00A0     return Promise.resolve('done');\\n\u00A0   }\\n  }\\n);\\n</pre>\\n </div>\\n </dd>\\n</dl>\\n\\n<h2 id=\\\"Browser_compatibility\\\">Browser compatibility</h2>\\n\\n<p class=\\\"hidden\\\">The compatibility table in this page is generated from structured data. If you'd like to contribute to the data, please check out <a class=\\\"external\\\" href=\\\"https://github.com/mdn/browser-compat-data\\\" rel=\\\"noopener\\\">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</p>\\n\\n<p>No compatibility data found. Please contribute data for \\\"webextensions.api.runtime.onMessage()\\\" (depth: 1) to the <a class=\\\"external\\\" href=\\\"https://github.com/mdn/browser-compat-data\\\" rel=\\\"noopener\\\">MDN compatibility data repository</a>.</p>\\n\\n<h2 id=\\\"Examples\\\">Examples</h2>\\n\\n<h3 id=\\\"Simple_example\\\">Simple example</h3>\\n\\n<p>This content script listens for click events on the web page. If the click was on a link, it messages the background page with the target URL:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// content-script.js\\n\\nwindow.addEventListener(\\\"click\\\", notifyExtension);\\n\\nfunction notifyExtension(e) {\\n  if (e.target.tagName != \\\"A\\\") {\\n    return;\\n  }\\n  browser.runtime.sendMessage({\\\"url\\\": e.target.href});\\n}\\n</pre>\\n\\n<p>The background script listens for these messages and displays a notification using the <code><a href=\\\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/notifications\\\">notifications</a></code> API:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// background-script.js\\n\\nbrowser.runtime.onMessage.addListener(notify);\\n\\nfunction notify(message) {\\n  browser.notifications.create({\\n    \\\"type\\\": \\\"basic\\\",\\n    \\\"iconUrl\\\": browser.extension.getURL(\\\"link.png\\\"),\\n    \\\"title\\\": \\\"You clicked a link!\\\",\\n    \\\"message\\\": message.url\\n  });\\n}\\n</pre>\\n\\n<h3 id=\\\"Sending_a_synchronous_response\\\">Sending a synchronous response</h3>\\n\\n<p>This content script sends a message to the background script when the user clicks on the page. It also logs any response sent by the background script:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// content-script.js\\n\\nfunction handleResponse(message) {\\n  console.log(`background script sent a response: ${message.response}`);\\n}\\n\\nfunction handleError(error) {\\n  console.log(`Error: ${error}`);\\n}\\n\\nfunction sendMessage(e) {\\n  const sending = browser.runtime.sendMessage({content: \\\"message from the content script\\\"});\\n  sending.then(handleResponse, handleError);  \\n}\\n\\nwindow.addEventListener(\\\"click\\\", sendMessage);</pre>\\n\\n<p>Here is a version of the corresponding background script, that sends a response synchronously, from inside in the listener:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// background-script.js\\n\\nfunction handleMessage(request, sender, sendResponse) {\\n  console.log(`content script sent a message: ${request.content}`);\\n  sendResponse({response: \\\"response from background script\\\"});\\n}\\n\\nbrowser.runtime.onMessage.addListener(handleMessage);</pre>\\n\\n<p>And here is another version which uses <a href=\\\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve\\\"><code>Promise.resolve()</code></a>:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// background-script.js\\n\\nfunction handleMessage(request, sender, sendResponse) {\\n  console.log(`content script sent a message: ${request.content}`);\\n  return Promise.resolve({response: \\\"response from background script\\\"});\\n}\\n\\nbrowser.runtime.onMessage.addListener(handleMessage);</pre>\\n\\n<h3 id=\\\"Sending_an_asynchronous_response_using_sendResponse\\\">Sending an asynchronous response using sendResponse</h3>\\n\\n<p>Here is an alternative version of the background script from the previous example. It sends a response asynchronously after the listener has returned. Note <code>return true;</code> in the listener: this tells the browser that you intend to use the <code>sendResponse</code> argument after the listener has returned.</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// background-script.js\\n\\nfunction handleMessage(request, sender, sendResponse) {  \\n  console.log(`content script sent a message: ${request.content}`);\\n  setTimeout(() =&gt; {\\n    sendResponse({response: \\\"async response from background script\\\"});\\n  }, 1000);  \\n  return true;\\n}\\n\\nbrowser.runtime.onMessage.addListener(handleMessage);\\n</pre>\\n\\n<h3 id=\\\"Sending_an_asynchronous_response_using_a_Promise\\\">Sending an asynchronous response using a Promise</h3>\\n\\n<p>This content script gets the first <code>&lt;a&gt;</code> link on the page and sends a message asking if the link's location is bookmarked. It expects to get a Boolean response (<code>true</code> if the location is bookmarked, <code>false</code> otherwise):</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// content-script.js\\n\\nconst firstLink = document.querySelector(\\\"a\\\");\\n\\nfunction handleResponse(isBookmarked) {\\n  if (isBookmarked) {\\n    firstLink.classList.add(\\\"bookmarked\\\");\\n  }\\n}\\n\\nbrowser.runtime.sendMessage({\\n  url: firstLink.href\\n}).then(handleResponse);</pre>\\n\\n<p>Here is the background script. It uses <code><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks/search\\\" title=\\\"The bookmarks.search() function searches for bookmark tree nodes matching the given query.\\\"><code>bookmarks.search()</code></a></code> to see if the link is bookmarked, which returns a <a href=\\\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\\\"><code>Promise</code></a>:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// background-script.js\\n\\nfunction isBookmarked(message, sender, response) {\\n  return browser.bookmarks.search({\\n    url: message.url\\n  }).then(function(results) {\\n    return results.length &gt; 0;\\n  });\\n}\\n\\nbrowser.runtime.onMessage.addListener(isBookmarked);</pre>\\n\\n<p>If the asynchronous handler doesn't return a Promise, you can explicitly construct a promise. This rather contrived example sends a response after a 1-second delay, using <code><a href=\\\"/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout\\\">Window.setTimeout()</a></code>:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">// background-script.js\\n\\nfunction handleMessage(request, sender, sendResponse) {\\n  return new Promise(resolve =&gt; {\\n    setTimeout( () =&gt; {\\n      resolve({response: \\\"async response from background script\\\"});\\n    }, 1000);\\n  });\\n}\\n\\nbrowser.runtime.onMessage.addListener(handleMessage);</pre>\\n\\n<h3 id=\\\"Example_extensions\\\">Example extensions</h3><ul><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/beastify\\\" rel=\\\"noopener\\\">beastify</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/content-script-register\\\" rel=\\\"noopener\\\">content-script-register</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/cookie-bg-picker\\\" rel=\\\"noopener\\\">cookie-bg-picker</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/devtools-panels\\\" rel=\\\"noopener\\\">devtools-panels</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/export-helpers\\\" rel=\\\"noopener\\\">export-helpers</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/find-across-tabs\\\" rel=\\\"noopener\\\">find-across-tabs</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/imagify\\\" rel=\\\"noopener\\\">imagify</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/mocha-client-tests\\\" rel=\\\"noopener\\\">mocha-client-tests</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n\\\" rel=\\\"noopener\\\">notify-link-clicks-i18n</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/store-collected-images\\\" rel=\\\"noopener\\\">store-collected-images</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/user-script-register\\\" rel=\\\"noopener\\\">user-script-register</a></li><li><a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/webpack-modules\\\" rel=\\\"noopener\\\">webpack-modules</a></li></ul>\\n\\n<div class=\\\"note\\\"><strong>Acknowledgements</strong>\\n\\n<p>This API is based on Chromium's <a class=\\\"external\\\" href=\\\"https://developer.chrome.com/extensions/runtime#event-onMessage\\\" rel=\\\"noopener\\\"><code>chrome.runtime</code></a> API. This documentation is derived from <a class=\\\"external\\\" href=\\\"https://chromium.googlesource.com/chromium/src/+/master/extensions/common/api/runtime.json\\\" rel=\\\"noopener\\\"><code>runtime.json</code></a> in the Chromium code.</p>\\n\\n<p>Microsoft Edge compatibility data is supplied by Microsoft Corporation and is included here under the Creative Commons Attribution 3.0 United States License.</p>\\n</div>\\n\\n<div class=\\\"hidden\\\">\\n<pre class=\\\"brush: js notranslate\\\">// Copyright 2015 The Chromium Authors. All rights reserved.\\n//\\n// Redistribution and use in source and binary forms, with or without\\n// modification, are permitted provided that the following conditions are\\n// met:\\n//\\n//    * Redistributions of source code must retain the above copyright\\n// notice, this list of conditions and the following disclaimer.\\n//    * Redistributions in binary form must reproduce the above\\n// copyright notice, this list of conditions and the following disclaimer\\n// in the documentation and/or other materials provided with the\\n// distribution.\\n//    * Neither the name of Google Inc. nor the names of its\\n// contributors may be used to endorse or promote products derived from\\n// this software without specific prior written permission.\\n//\\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\\n// \\\"AS IS\\\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n</pre>\\n</div>\",\"quickLinksHTML\":\"\\n  <ol>\\n    <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions\\\"><strong>Browser extensions</strong></a></li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Getting started</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\\\">What are extensions?</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\\\">Your first extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\\\">Your second extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\\\">Anatomy of an extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Examples\\\">Example extensions</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/What_next_\\\">What next?</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Concepts</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\\\">Using the JavaScript APIs</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\\\">Content scripts</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\\\">Match patterns</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\\\">Working with files</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Internationalization\\\">Internationalization</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\\\">Content Security Policy</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\\\">Native messaging</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\\\">Differences between API implementations</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\\\">Chrome incompatibilities</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>User interface</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface\\\">User Interface</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\\\">Toolbar button</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\\\">Address bar button</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\\\">Sidebars</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\\\">Context menu items</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\\\">Options page</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\\\">Extension pages</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\\\">Notifications</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\\\">Address bar suggestions</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\\\">Developer tools panels</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>How to</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\\\">Intercept HTTP requests</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\\\">Modify a web page</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\\\">Insert external content</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\\\">Share objects with page scripts</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\\\">Add a button to the toolbar</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\\\">Implement a settings page</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\\\">Work with the Tabs API</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\\\">Work with the Bookmarks API</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\\\">Work with the Cookies API</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\\\">Work with contextual identities</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\\\">Build a cross-browser extension</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\\\">Firefox differentiators</a></summary>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details open>\\n        <summary>JavaScript APIs</summary>\\n        <ol><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\\\">Browser support for JavaScript APIs</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/alarms\\\">alarms</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\\\">bookmarks</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\\\">browserAction</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings\\\">browserSettings</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browsingData\\\">browsingData</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal\\\">captivePortal</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\\\">clipboard</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/commands\\\">commands</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\\\">contentScripts</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities\\\">contextualIdentities</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies\\\">cookies</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools\\\">devtools</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.inspectedWindow\\\">devtools.inspectedWindow</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.network\\\">devtools.network</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.panels\\\">devtools.panels</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/dns\\\">dns</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/downloads\\\">downloads</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/events\\\">events</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension\\\">extension</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes\\\">extensionTypes</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/find\\\">find</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/history\\\">history</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n\\\">i18n</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/identity\\\">identity</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/idle\\\">idle</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/management\\\">management</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/menus\\\">menus</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/notifications\\\">notifications</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/omnibox\\\">omnibox</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pageAction\\\">pageAction</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/permissions\\\">permissions</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11\\\">pkcs11</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/privacy\\\">privacy</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/proxy\\\">proxy</a></li><li class=\\\"webextension-api-sidebar\\\"><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime\\\">runtime</a><ol><li data-default-state=\\\"open\\\"><a href=\\\"#\\\"><strong>Methods</strong></a><ol><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connect\\\" title=\\\"Make a connection between different contexts inside the extension.\\\"><code>connect()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connectNative\\\" title=\\\"For more information, see Native messaging.\\\"><code>connectNative()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getBackgroundPage\\\" title=\\\"Retrieves the\u00A0Window object for the background page running inside the current extension.\\\"><code>getBackgroundPage()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getBrowserInfo\\\" title=\\\"Returns information about the browser in which the extension is installed.\\\"><code>getBrowserInfo()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getManifest\\\" title=\\\"None.\\\"><code>getManifest()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getPackageDirectoryEntry\\\" title=\\\"Returns a DirectoryEntry object representing the package directory.\\\"><code>getPackageDirectoryEntry()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getPlatformInfo\\\" title=\\\"Returns information about the current platform. This can only be called in the background script context.\\\"><code>getPlatformInfo()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/getURL\\\" title=\\\"string. The fully-qualified URL to the resource.\\\"><code>getURL()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/openOptionsPage\\\" title=\\\"This is an asynchronous function that returns a Promise.\\\"><code>openOptionsPage()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/reload\\\" title=\\\"Reloads the extension.\\\"><code>reload()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/requestUpdateCheck\\\" title=\\\"Checks to see if an update for the extension is available.\\\"><code>requestUpdateCheck()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage\\\" title=\\\"Sends a single message to event listeners within your extension or a different extension.\\\"><code>sendMessage()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendNativeMessage\\\" title=\\\"Sends a single message from an extension to a native application.\\\"><code>sendNativeMessage()</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/setUninstallURL\\\" title=\\\"Sets the URL to be visited when the extension is uninstalled. This may be used to clean up server-side data, do analytics, or implement surveys. The URL can be a maximum 255 characters.\\\"><code>setUninstallURL()</code></a></li></ol></li><li data-default-state=\\\"open\\\"><a href=\\\"#\\\"><strong>Properties</strong></a><ol><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/id\\\" title=\\\"The ID of the extension.\\\"><code>id</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/lastError\\\" title=\\\"This value is used to report an error message from an asynchronous API, when the asynchronous API is given a callback. This is useful for extensions that are using the callback-based version of the WebExtension APIs.\\\"><code>lastError</code></a></li></ol></li><li data-default-state=\\\"open\\\"><a href=\\\"#\\\"><strong>Types</strong></a><ol><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/MessageSender\\\" title=\\\"An object containing information about the sender of a message or connection request; this is passed to the runtime.onMessage() listener.\\\"><code>MessageSender</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/OnInstalledReason\\\" title=\\\"The reason that the runtime.onInstalled event is being dispatched.\\\"><code>OnInstalledReason</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/OnRestartRequiredReason\\\" title=\\\"The reason that the onRestartRequired event is being dispatched.\\\"><code>OnRestartRequiredReason</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/PlatformArch\\\" title=\\\"The machine's processor architecture.\\\"><code>PlatformArch</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/PlatformInfo\\\" title=\\\"An object containing information about the current platform.\\\"><code>PlatformInfo</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/PlatformNaclArch\\\" title=\\\"The native client architecture. This may be different from arch on some platforms.\\\"><code>PlatformNaclArch</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/PlatformOs\\\" title=\\\"The operating system the browser is running on.\\\"><code>PlatformOs</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port\\\" title=\\\"A Port object represents one end of a connection between two specific contexts, which can be used to exchange messages.\\\"><code>Port</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/RequestUpdateCheckStatus\\\" title=\\\"Result of a call to runtime.requestUpdateCheck().\\\"><code>RequestUpdateCheckStatus</code></a></li></ol></li><li data-default-state=\\\"open\\\"><a href=\\\"#\\\"><strong>Events</strong></a><ol><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onBrowserUpdateAvailable\\\" title=\\\"Fired when an update for the browser is available, but it isn't installed immediately because a browser restart is required.\\\"><code>onBrowserUpdateAvailable</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect\\\" title=\\\"Fired when a connection is made with either an extension process or a content script.\\\"><code>onConnect</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnectExternal\\\" title=\\\"Fired when an extension receives a connection request from a different extension.\\\"><code>onConnectExternal</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onInstalled\\\" title=\\\"Fired when the extension is first installed, when the extension is updated to a new version, and when the browser is updated to a new version.\\\"><code>onInstalled</code></a></li><li><em><code>onMessage</code></em></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessageExternal\\\" title=\\\"This API can't be used in a content script.\\\"><code>onMessageExternal</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onRestartRequired\\\" title=\\\"Fired when an app or the device that it runs on needs to be restarted. The app should close all its windows at its earliest convenience to let the restart happen. If the app does nothing, a restart will be enforced after a 24-hour grace period has passed. Currently, this event is only fired for Chrome OS kiosk apps.\\\"><code>onRestartRequired</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onStartup\\\" title=\\\"Fired when a profile that has this extension installed first starts up. This event is not fired when a private browsing/incognito profile is started, even if this extension is operating in 'split' incognito mode.\\\"><code>onStartup</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onSuspend\\\" title=\\\"Sent to the event page just before it is unloaded. This gives the extension an opportunity to do some cleanup. Note that since the page is unloading, any asynchronous operations started while handling this event are not guaranteed to complete.\\\"><code>onSuspend</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onSuspendCanceled\\\" title=\\\"Sent after runtime.onSuspend to indicate that the app won't be unloaded after all.\\\"><code>onSuspendCanceled</code></a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onUpdateAvailable\\\" title=\\\"Fired when an update to the extension is available. This event enables an extension to delay an update: for example, because it is in the middle of some operation which should not be interrupted.\\\"><code>onUpdateAvailable</code></a></li></ol></li></ol></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/search\\\">search</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sessions\\\">sessions</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction\\\">sidebarAction</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage\\\">storage</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs\\\">tabs</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/theme\\\">theme</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/topSites\\\">topSites</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/types\\\">types</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/userScripts\\\">userScripts</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\\\">webNavigation</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\\\">webRequest</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/windows\\\">windows</a></li></ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n      <summary>Manifest keys</summary>\\n      <ol><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\\\">author</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\\\">background</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\\\">browser_action</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides\\\">chrome_settings_overrides</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides\\\">chrome_url_overrides</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands\\\">commands</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\\\">content_scripts</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy\\\">content_security_policy</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\\\">default_locale</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\\\">description</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\\\">developer</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page\\\">devtools_page</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries\\\">dictionaries</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable\\\">externally_connectable</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\\\">homepage_url</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\\\">icons</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito\\\">incognito</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\\\">manifest_version</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\\\">name</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled\\\">offline_enabled</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox\\\">omnibox</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions\\\">optional_permissions</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page\\\">options_page</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\\\">options_ui</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action\\\">page_action</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\\\">permissions</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers\\\">protocol_handlers</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\\\">short_name</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action\\\">sidebar_action</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage\\\">storage</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme\\\">theme</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment\\\">theme_experiment</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts\\\">user_scripts</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\\\">version</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name\\\">version_name</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\\\">web_accessible_resources</a></li></ol>\\n      </details>\\n    </li>\\n     <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Extension Workshop</summary>\\n        <ol>\\n          <li><a class=\\\"external\\\" href=\\\"https://extensionworkshop.com/documentation/develop/\\\" rel=\\\"noopener\\\">Develop</a></li>\\n          <li><a class=\\\"external\\\" href=\\\"https://extensionworkshop.com/documentation/publish/\\\" rel=\\\"noopener\\\">Publish</a></li>\\n          <li><a class=\\\"external\\\" href=\\\"https://extensionworkshop.com/documentation/manage/\\\" rel=\\\"noopener\\\">Manage</a></li>\\n          <li><a class=\\\"external\\\" href=\\\"https://extensionworkshop.com/documentation/enterprise/\\\" rel=\\\"noopener\\\">Enterprise</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Contact_us\\\"><strong>Contact us</strong></a></li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Channels</summary>\\n        <ol>\\n          <li><a class=\\\"external\\\" href=\\\"https://blog.mozilla.org/addons\\\" rel=\\\"noopener\\\">Add-ons blog</a></li>\\n          <li><a class=\\\"external\\\" href=\\\"https://discourse.mozilla.org/c/add-ons\\\" rel=\\\"noopener\\\">Add-ons forum</a></li>\\n          <li><a class=\\\"external\\\" href=\\\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\\\" rel=\\\"noopener\\\">Add-ons chat</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n  </ol>\\n\",\"tocHTML\":\"<li><a href=\\\"#Syntax\\\" rel=\\\"internal\\\">Syntax</a><li><a href=\\\"#addListener_syntax\\\" rel=\\\"internal\\\">addListener syntax</a><li><a href=\\\"#Browser_compatibility\\\" rel=\\\"internal\\\">Browser compatibility</a><li><a href=\\\"#Examples\\\" rel=\\\"internal\\\">Examples</a>\",\"raw\":\"<nav>{{AddonSidebar()}}</nav>\\n\\n<p>Use this event to listen for messages from another part of your extension.</p>\\n\\n<p>Some example use cases are:</p>\\n\\n<ul>\\n <li><strong>in a <a href=\\\"/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Content_scripts\\\">content script</a></strong>, to listen for messages from a <a href=\\\"/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Background_scripts\\\">background script.</a></li>\\n <li><strong>in a background script</strong>, to listen for messages from a content script.</li>\\n <li><strong>in an <a href=\\\"/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Options_pages\\\">options page</a> or <a href=\\\"/en-US/Add-ons/WebExtensions/User_interface_components#Popups\\\">popup</a> script</strong>, to listen for messages from a background script.</li>\\n <li><strong>in a background script</strong>, to listen for messages from an options page or popup script.</li>\\n</ul>\\n\\n<p>To send a message that is received by the <code>onMessage()</code> listener, use {{WebExtAPIRef(\\\"runtime.sendMessage()\\\")}} or (to send a message to a content script) {{WebExtAPIRef(\\\"tabs.sendMessage()\\\")}}.</p>\\n\\n<div class=\\\"blockIndicator note\\\">\\n<p>Avoid creating multiple <code>onMessage()</code> listeners for the same type of message, because the order in which multiple listeners will fire is not guaranteed.</p>\\n\\n<p>If you want to guarantee the delivery of a message to a specific end point, use the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#Connection-based_messaging\\\">connection-based approach to exchange messages</a>.</p>\\n</div>\\n\\n<p>Along with the message itself, the listener is passed:</p>\\n\\n<ul>\\n <li>a <code>sender</code> object giving details about the message sender.</li>\\n <li>a <code>sendResponse()</code> function that can be used\u00A0to send a response back to the sender.</li>\\n</ul>\\n\\n<p>You can send a synchronous response to the message by calling the <code>sendResponse()</code> function inside your listener. <a href=\\\"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_a_synchronous_response\\\">See an example</a>.</p>\\n\\n<p>To send an asynchronous response, there are two options:</p>\\n\\n<ul>\\n <li>return <code>true</code> from the event listener. This keeps the <code>sendResponse()</code> function valid after the listener returns, so you can call it later. <a href=\\\"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_an_asynchronous_response_using_sendResponse\\\">See an example</a>.</li>\\n <li>return a <code>Promise</code> from the event listener, and resolve when you have the response (or reject it in case of an error). <a href=\\\"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage#Sending_an_asynchronous_response_using_a_Promise\\\">See an example</a>.</li>\\n</ul>\\n\\n<div class=\\\"warning\\\">\\n<p>Returning a <code>Promise</code> is now preferred, as <code>sendResponse()</code> <a href=\\\"https://github.com/mozilla/webextension-polyfill/issues/16#issuecomment-296693219\\\">will be removed from the W3C spec</a>.</p>\\n\\n<p>The popular <a href=\\\"https://github.com/mozilla/webextension-polyfill\\\">webextension-polyfill</a> library has already removed the <code>sendResponse()</code> function from its implementation.</p>\\n</div>\\n\\n<div class=\\\"blockIndicator note\\\">\\n<p>You can also use a <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#Connection-based_messaging\\\">connection-based approach to exchange messages</a>.</p>\\n</div>\\n\\n<h2 id=\\\"Syntax\\\">Syntax</h2>\\n\\n<pre class=\\\"syntaxbox brush:js\\\">browser.runtime.onMessage.addListener(<var>listener</var>)\\nbrowser.runtime.onMessage.removeListener(<var>listener</var>)\\nbrowser.runtime.onMessage.hasListener(<var>listener</var>)\\n</pre>\\n\\n<p>Events have three functions:</p>\\n\\n<dl>\\n <dt><code>addListener(<var>listener</var>)</code></dt>\\n <dd>Adds a listener to this event.</dd>\\n <dt><code>removeListener(<var>listener</var>)</code></dt>\\n <dd>Stop listening to this event. The <code><var>listener</var></code> argument is the listener to remove.</dd>\\n <dt><code>hasListener(<var>listener</var>)</code></dt>\\n <dd>Checks whether at least one\u00A0listener is registered for this event. Returns <code>true</code> if it is listening, <code>false</code> otherwise.</dd>\\n</dl>\\n\\n<h2 id=\\\"addListener_syntax\\\">addListener syntax</h2>\\n\\n<h3 id=\\\"Parameters\\\">Parameters</h3>\\n\\n<dl>\\n <dt><code><var>listener</var></code></dt>\\n <dd>\\n <p>A callback function that will be called when this event occurs. The function will be passed the following arguments:</p>\\n\\n <dl class=\\\"reference-values\\\">\\n  <dt><code><var>message</var></code></dt>\\n  <dd><code>object</code>. The message itself. This is a JSON-ifiable object.</dd>\\n  <dt><code><var>sender</var></code></dt>\\n  <dd>A {{WebExtAPIRef('runtime.MessageSender')}} object representing the sender of the message.</dd>\\n  <dt><code><var>sendResponse</var></code></dt>\\n  <dd>\\n  <p>A function to call, at most once, to send a response to the <code><var>message</var></code>. The function takes a single argument, which may be any JSON-ifiable object. This argument is passed back to the message sender.</p>\\n\\n  <p>If you have more than one <code>onMessage()</code> listener in the same document, then only one may send a response.</p>\\n\\n  <p>To send a response synchronously, call <code>sendResponse()</code> before the listener function returns.</p>\\n\\n  <p>To send a response asynchronously:</p>\\n\\n  <ul>\\n   <li>either keep a reference to the <code>sendResponse()</code> argument and return <code>true</code> from the listener function. You will then be able to call <code>sendResponse()</code> after the listener function has returned.</li>\\n   <li>or return a {{jsxref(\\\"Promise\\\")}} from the listener function and resolve the promise when the response is ready. This is a preferred way.</li>\\n  </ul>\\n  </dd>\\n </dl>\\n\\n <p>The <code><var>listener</var></code> function can return either a Boolean or a {{jsxref(\\\"Promise\\\")}}.</p>\\n\\n <div class=\\\"blockIndicator note\\\">\\n <p><strong>Important:</strong> Do not call <code>addListener()</code> using an <code>async</code> function:</p>\\n\\n <pre class=\\\"brush: js example-bad\\\">// don't do this\\nbrowser.runtime.onMessage.addListener(\\n\u00A0 async (data, sender) =&gt; {\\n    if (data.type === 'handle_me') { return 'done'; }\\n  }\\n);\\n</pre>\\n\\n <p>This will cause the listener to consume every message it receives, effectively blocking all other listeners from receiving and processing messages.</p>\\n\\n <p>If you want to take an asynchronous approach, use a Promise instead, like this:</p>\\n\\n <pre class=\\\"brush: js example-good\\\">browser.runtime.onMessage.addListener( \\n\u00A0 (data, sender) =&gt; {\\n    if (data.type === 'handle_me') {\\n\u00A0     return Promise.resolve('done');\\n\u00A0   }\\n  }\\n);\\n</pre>\\n </div>\\n </dd>\\n</dl>\\n\\n<h2 id=\\\"Browser_compatibility\\\">Browser compatibility</h2>\\n\\n<p class=\\\"hidden\\\">The compatibility table in this page is generated from structured data. If you'd like to contribute to the data, please check out <a href=\\\"https://github.com/mdn/browser-compat-data\\\">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</p>\\n\\n<p>{{Compat(\\\"webextensions.api.runtime.onMessage()\\\")}}</p>\\n\\n<h2 id=\\\"Examples\\\">Examples</h2>\\n\\n<h3 id=\\\"Simple_example\\\">Simple example</h3>\\n\\n<p>This content script listens for click events on the web page. If the click was on a link, it messages the background page with the target URL:</p>\\n\\n<pre class=\\\"brush: js\\\">// content-script.js\\n\\nwindow.addEventListener(\\\"click\\\", notifyExtension);\\n\\nfunction notifyExtension(e) {\\n  if (e.target.tagName != \\\"A\\\") {\\n    return;\\n  }\\n  browser.runtime.sendMessage({\\\"url\\\": e.target.href});\\n}\\n</pre>\\n\\n<p>The background script listens for these messages and displays a notification using the <code><a href=\\\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/notifications\\\">notifications</a></code> API:</p>\\n\\n<pre class=\\\"brush: js\\\">// background-script.js\\n\\nbrowser.runtime.onMessage.addListener(notify);\\n\\nfunction notify(message) {\\n  browser.notifications.create({\\n    \\\"type\\\": \\\"basic\\\",\\n    \\\"iconUrl\\\": browser.extension.getURL(\\\"link.png\\\"),\\n    \\\"title\\\": \\\"You clicked a link!\\\",\\n    \\\"message\\\": message.url\\n  });\\n}\\n</pre>\\n\\n<h3 id=\\\"Sending_a_synchronous_response\\\">Sending a synchronous response</h3>\\n\\n<p>This content script sends a message to the background script when the user clicks on the page. It also logs any response sent by the background script:</p>\\n\\n<pre class=\\\"brush: js\\\">// content-script.js\\n\\nfunction handleResponse(message) {\\n  console.log(`background script sent a response: ${message.response}`);\\n}\\n\\nfunction handleError(error) {\\n  console.log(`Error: ${error}`);\\n}\\n\\nfunction sendMessage(e) {\\n  const sending = browser.runtime.sendMessage({content: \\\"message from the content script\\\"});\\n  sending.then(handleResponse, handleError);  \\n}\\n\\nwindow.addEventListener(\\\"click\\\", sendMessage);</pre>\\n\\n<p>Here is a version of the corresponding background script, that sends a response synchronously, from inside in the listener:</p>\\n\\n<pre class=\\\"brush: js\\\">// background-script.js\\n\\nfunction handleMessage(request, sender, sendResponse) {\\n  console.log(`content script sent a message: ${request.content}`);\\n  sendResponse({response: \\\"response from background script\\\"});\\n}\\n\\nbrowser.runtime.onMessage.addListener(handleMessage);</pre>\\n\\n<p>And here is another version which uses {{jsxref(\\\"Promise.resolve()\\\")}}:</p>\\n\\n<pre class=\\\"brush: js\\\">// background-script.js\\n\\nfunction handleMessage(request, sender, sendResponse) {\\n  console.log(`content script sent a message: ${request.content}`);\\n  return Promise.resolve({response: \\\"response from background script\\\"});\\n}\\n\\nbrowser.runtime.onMessage.addListener(handleMessage);</pre>\\n\\n<h3 id=\\\"Sending_an_asynchronous_response_using_sendResponse\\\">Sending an asynchronous response using sendResponse</h3>\\n\\n<p>Here is an alternative version of the background script from the previous example. It sends a response asynchronously after the listener has returned. Note <code>return true;</code> in the listener: this tells the browser that you intend to use the <code>sendResponse</code> argument after the listener has returned.</p>\\n\\n<pre class=\\\"brush: js\\\">// background-script.js\\n\\nfunction handleMessage(request, sender, sendResponse) {  \\n  console.log(`content script sent a message: ${request.content}`);\\n  setTimeout(() =&gt; {\\n    sendResponse({response: \\\"async response from background script\\\"});\\n  }, 1000);  \\n  return true;\\n}\\n\\nbrowser.runtime.onMessage.addListener(handleMessage);\\n</pre>\\n\\n<h3 id=\\\"Sending_an_asynchronous_response_using_a_Promise\\\">Sending an asynchronous response using a Promise</h3>\\n\\n<p>This content script gets the first <code>&lt;a&gt;</code> link on the page and sends a message asking if the link's location is bookmarked. It expects to get a Boolean response (<code>true</code> if the location is bookmarked, <code>false</code> otherwise):</p>\\n\\n<pre class=\\\"brush: js\\\">// content-script.js\\n\\nconst firstLink = document.querySelector(\\\"a\\\");\\n\\nfunction handleResponse(isBookmarked) {\\n  if (isBookmarked) {\\n    firstLink.classList.add(\\\"bookmarked\\\");\\n  }\\n}\\n\\nbrowser.runtime.sendMessage({\\n  url: firstLink.href\\n}).then(handleResponse);</pre>\\n\\n<p>Here is the background script. It uses <code>{{WebExtAPIRef(\\\"bookmarks.search()\\\")}}</code> to see if the link is bookmarked, which returns a {{jsxref(\\\"Promise\\\")}}:</p>\\n\\n<pre class=\\\"brush: js\\\">// background-script.js\\n\\nfunction isBookmarked(message, sender, response) {\\n  return browser.bookmarks.search({\\n    url: message.url\\n  }).then(function(results) {\\n    return results.length &gt; 0;\\n  });\\n}\\n\\nbrowser.runtime.onMessage.addListener(isBookmarked);</pre>\\n\\n<p>If the asynchronous handler doesn't return a Promise, you can explicitly construct a promise. This rather contrived example sends a response after a 1-second delay, using <code><a href=\\\"/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout\\\">Window.setTimeout()</a></code>:</p>\\n\\n<pre class=\\\"brush: js\\\">// background-script.js\\n\\nfunction handleMessage(request, sender, sendResponse) {\\n  return new Promise(resolve =&gt; {\\n    setTimeout( () =&gt; {\\n      resolve({response: \\\"async response from background script\\\"});\\n    }, 1000);\\n  });\\n}\\n\\nbrowser.runtime.onMessage.addListener(handleMessage);</pre>\\n\\n<p>{{WebExtExamples}}</p>\\n\\n<div class=\\\"note\\\"><strong>Acknowledgements</strong>\\n\\n<p>This API is based on Chromium's <a href=\\\"https://developer.chrome.com/extensions/runtime#event-onMessage\\\"><code>chrome.runtime</code></a> API. This documentation is derived from <a href=\\\"https://chromium.googlesource.com/chromium/src/+/master/extensions/common/api/runtime.json\\\"><code>runtime.json</code></a> in the Chromium code.</p>\\n\\n<p>Microsoft Edge compatibility data is supplied by Microsoft Corporation and is included here under the Creative Commons Attribution 3.0 United States License.</p>\\n</div>\\n\\n<div class=\\\"hidden\\\">\\n<pre class=\\\"brush: js\\\">// Copyright 2015 The Chromium Authors. All rights reserved.\\n//\\n// Redistribution and use in source and binary forms, with or without\\n// modification, are permitted provided that the following conditions are\\n// met:\\n//\\n//    * Redistributions of source code must retain the above copyright\\n// notice, this list of conditions and the following disclaimer.\\n//    * Redistributions in binary form must reproduce the above\\n// copyright notice, this list of conditions and the following disclaimer\\n// in the documentation and/or other materials provided with the\\n// distribution.\\n//    * Neither the name of Google Inc. nor the names of its\\n// contributors may be used to endorse or promote products derived from\\n// this software without specific prior written permission.\\n//\\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\\n// \\\"AS IS\\\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n</pre>\\n</div>\",\"parents\":[{\"url\":\"/en-US/docs/Mozilla\",\"title\":\"Mozilla\"},{\"url\":\"/en-US/docs/Mozilla/Add-ons\",\"title\":\"Add-ons\"},{\"url\":\"/en-US/docs/Mozilla/Add-ons/WebExtensions\",\"title\":\"Browser Extensions\"},{\"url\":\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API\",\"title\":\"JavaScript APIs\"},{\"url\":\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime\",\"title\":\"runtime\"}],\"translations\":[{\"language\":\"\u0641\u0627\u0631\u0633\u06CC\",\"hrefLang\":\"fa\",\"localizedLanguage\":\"Persian\",\"locale\":\"fa\",\"url\":\"/fa/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"title\":\"runtime.onMessage\"},{\"language\":\"Fran\u00E7ais\",\"hrefLang\":\"fr\",\"localizedLanguage\":\"French\",\"locale\":\"fr\",\"url\":\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"title\":\"runtime.onMessage\"},{\"language\":\"\u65E5\u672C\u8A9E\",\"hrefLang\":\"ja\",\"localizedLanguage\":\"Japanese\",\"locale\":\"ja\",\"url\":\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"title\":\"runtime.onMessage\"},{\"language\":\"\u4E2D\u6587 (\u7B80\u4F53)\",\"hrefLang\":\"zh\",\"localizedLanguage\":\"Chinese (Simplified)\",\"locale\":\"zh-CN\",\"url\":\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\",\"title\":\"runtime.onMessage\"}],\"lastModified\":\"2020-01-25T12:47:39.697331\"}}");</script>


  
    <div id="auth-modal" class="modal hidden">
    <section class="auth-providers" tabindex="-1" role="dialog" aria-modal="true" aria-labelledby="modal-main-heading">
        <header>
            <h2 id="modal-main-heading">Sign In</h2>
        </header>
        
  <p>
    Sign in to enjoy the benefits of an MDN account. If you haven’t already created an account, you will be prompted to do so after signing in.
</p>
<div class="auth-button-container">
    <a href="/users/github/login/?next=%2Fen-US%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FAPI%2Fruntime%2FonMessage" class="github-auth" data-first-focusable="true">
        Sign in with Github
    </a>
    <a href="/users/google/login/?next=%2Fen-US%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FAPI%2Fruntime%2FonMessage" class="google-auth">
        Sign in with Google
    </a>
</div>

        <button id="close-modal" class="close-modal" data-last-focusable="true">
            <span>Close modal</span>
        </button>
    </section>
</div>
  

  <!-- site js -->
  <script defer="" type="text/javascript" src="/static/build/js/react-main.565de59c3f6c.js" charset="utf-8"></script>
  <script defer="" type="text/javascript" src="/static/build/js/mathml.3cb4c04c0706.js" charset="utf-8"></script>
  <script defer="" type="text/javascript" src="/static/build/js/auth-modal.119e5d70465f.js" charset="utf-8"></script>
  
    <script defer="" type="text/javascript" src="/static/build/js/react-bcd-signal.cf0fc711cfa2.js" charset="utf-8"></script>
  

</body>