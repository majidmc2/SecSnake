<body style="border: 10px solid blue;">
  <script>
    // make sure global mdn object exists
    var mdn = window.mdn || {};

    (function(win) {
        'use strict';

        win.mdn.features = {};
        win.mdn.stripePublicKey = 'pk_live_GZl4tCi8J5mWhKbJeRey4DSy';
        win.mdn.contributionSupportEmail = 'mdn-support@mozilla.com';

        win.mdn.siteUrl = 'https://developer.mozilla.org';
        win.mdn.wikiSiteUrl = 'https://wiki.developer.mozilla.org';
        win.mdn.staticPath = '/static/';
        win.mdn.wiki = {
            autosuggestTitleUrl: '/en-US/docs/get-documents'
        };

        win.mdn.notifications = [];

        

        // interactive editor config
        win.mdn.interactiveEditor = {
            siteUrl: "https://developer.mozilla.org",
            editorUrl: "https://interactive-examples.mdn.mozilla.net"
        };
        win.mdn.langCookieName = "django_language";

    })(this);
</script>

  

  <div id="react-container" data-component-name="SPA"><div class="loading-bar"></div><ul id="nav-access" data-testid="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-language" href="#language">Select language</a></li><li><a id="skip-search" href="#main-q">Skip to search</a></li></ul><header class="page-header" data-testid="header"><a href="/en-US/" class="logo" aria-label="MDN Web Docs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 219 48" role="img"><path d="M49.752 30.824h59.917v17.132H49.75zm57.23 12.3c-.103.03-.21.048-.316.05-.338 0-.514-.15-.514-.582v-3.256c0-1.71-1.352-2.543-2.976-2.543a7.206 7.206 0 00-3.21.676l-.29 1.724 1.71.182.245-.842a2.338 2.338 0 011.147-.216c1.214 0 1.23.913 1.23 1.69v.234c-.407-.048-.818-.07-1.23-.068-1.71 0-3.49.433-3.49 2.276 0 1.563 1.23 2.144 2.31 2.144a2.7 2.7 0 002.41-1.494c.018.88.77 1.563 1.648 1.494a2.89 2.89 0 001.353-.338zm-4.604-.05a.787.787 0 01-.88-.867c0-.815.677-1.015 1.432-1.015.36.008.722.04 1.078.098-.05 1.235-.852 1.783-1.63 1.783zM97.388 33l-3.24 11.433h2.11L99.5 33.002zm-4.353 0l-3.24 11.433h2.11L95.145 33zm-6.89 6.645h2.243V36.94h-2.242zm0 4.802h2.243v-2.706h-2.242zm-3.617-1.64H80.1l4.156-4.736-.166-1.13h-6.58l-.268 2.63 1.546.164.338-1.163h2.343l-4.123 4.734.216 1.13h6.544l.467-2.63-1.69-.164zM72.143 36.79c-2.706 0-4.02 1.812-4.02 4.004 0 2.394 1.595 3.804 3.905 3.804 2.394 0 4.122-1.51 4.122-3.905-.003-2.093-1.32-3.906-4.01-3.906zm-.054 6.154c-1.165 0-1.763-.997-1.763-2.292 0-1.414.676-2.23 1.778-2.23 1.015 0 1.83.677 1.83 2.196 0 1.438-.73 2.327-1.846 2.327zm-5.906-3.564c0-1.78-1.224-2.594-2.577-2.594a2.51 2.51 0 00-2.44 1.612c-.367-1.1-1.364-1.613-2.443-1.613a2.48 2.48 0 00-2.276 1.278v-1.13h-3.14v1.63h.996v4.24h-.997v1.63h4.572v-1.63h-1.432V40.2c0-1.048.433-1.78 1.448-1.78.845 0 1.278.502 1.278 1.797v4.224h3.14v-1.63h-.996v-2.612c0-1.048.433-1.78 1.447-1.78.846 0 1.278.502 1.278 1.797v4.214h3.142V42.8h-.998zm78.791-22.39h-6.29c.23-1.935 1.16-3.558 3.274-3.558 2.245 0 3.2 1.857 3.016 3.558zM218.952 0v29.137h-169.2V0zM71.706 6.885h-3.85L61.51 20.01h-.104L54.882 6.884h-3.84v1.65h2.19V21.98H51.12v1.65h5.927v-1.65h-2.012V11.24h.1l5.75 11.553H61.9l5.62-11.474h.105v10.66h-1.962v1.65h5.942v-1.65h-2.09V8.536h2.19zm9.993 16.76c5.285 0 8.484-3.48 8.484-8.42 0-4.847-3.094-8.353-8.56-8.353H74.12v1.623h2.114v13.527H74.12v1.623zm27.05-16.76h-6.426v1.65h2.526v11.268h-.1L95.21 6.885H91.6v1.65h2.22V21.98h-1.935v1.65h6.385v-1.65h-2.655V10.444h.1l9.724 13.202h1.21V8.535h2.09zm26.71 5.29h-5.156v1.467h1.83l-1.857 7.247h-.128l-3.586-8.716h-1.21l-3.423 8.718h-.127l-2.14-7.247h1.933v-1.47h-5.41v1.467h1.522l3.25 10.003h1.352l3.432-8.766h.13l3.496 8.765h1.393l3.122-10.003h1.573zm6.704 11.727c2.837 0 4.514-1.583 4.83-3.568l-1.523-.338c-.36 1.42-1.365 2.347-3.17 2.347-2.283 0-3.53-1.468-3.636-4.02h8.058c.1-.445.153-.898.156-1.354-.024-2.71-1.728-5.03-4.873-5.03-3.246 0-5.26 2.58-5.26 6.14 0 3.712 2.162 5.825 5.412 5.825zm13.408 0c3.663 0 5.134-3.25 5.134-6.294 0-3.642-2.063-5.67-4.924-5.67-2.19 0-3.402 1.186-4.1 2.603V5.905h-3.53v1.47h1.692v12.923a22.8 22.8 0 01-.338 3.35h1.805a44.05 44.05 0 00.235-1.906c.747 1.39 2.242 2.165 4.02 2.165zm26.198-1.728h-1.985V5.904h-4.6v1.47h2.798v6.653c-.748-1.342-2.15-2.09-3.842-2.09-3.74 0-5.183 3.2-5.183 6.267 0 3.584 1.958 5.698 4.924 5.698 2.087 0 3.352-1.224 4.1-2.577v2.323h3.784zm6.963 1.728c3.53 0 5.75-2.526 5.742-6.006 0-3.25-1.934-5.982-5.647-5.982s-5.67 2.735-5.67 6.087c0 3.457 2.09 5.905 5.568 5.905zm12.942 0c3.172 0 4.538-2.114 4.866-4.112l-1.548-.34c-.334 1.885-1.315 2.917-3.094 2.917-2.27 0-3.507-1.637-3.507-4.397 0-2.475.982-4.487 3.43-4.487a4.4 4.4 0 012.45.646l.42 1.936 1.496-.18-.44-2.758c-1.16-.876-2.397-1.187-3.92-1.187-3.556 0-5.362 2.966-5.362 6.14 0 3.685 2.036 5.825 5.208 5.825zm11.166 0c2.76 0 4.874-1.34 4.847-3.595 0-4.565-7.1-2.195-7.1-5.184 0-1.177 1.03-1.69 2.474-1.69.826-.015 1.64.18 2.368.567l.267 1.864 1.495-.18-.284-2.68a8.135 8.135 0 00-3.997-1.06c-2.088 0-4.255.903-4.255 3.328 0 4.46 7.193 2.063 7.193 5.208 0 1.315-1.495 1.934-3.095 1.934a5.812 5.812 0 01-2.553-.568l.078-1.522-1.444-.156-.362 2.604c.977.643 2.736 1.133 4.36 1.133zm-54.042-6.11c0 2.373-1.058 4.564-3.584 4.564a3.455 3.455 0 01-3.534-3.456v-1.728c.05-1.7 1.444-3.686 3.635-3.686 1.948 0 3.48 1.444 3.483 4.305zm19.18-1.06v1.833c-.076 1.73-1.57 3.79-3.634 3.79-1.985 0-3.48-1.47-3.48-4.28 0-2.425 1.133-4.59 3.686-4.59a3.36 3.36 0 013.43 3.248zm14.597 1.133c0 2.58-1.34 4.488-3.79 4.488-2.453 0-3.74-1.958-3.74-4.46 0-2.55 1.34-4.434 3.74-4.434 2.397 0 3.79 1.778 3.79 4.405zm-104.39-2.593c0 4.16-2.32 6.763-6.574 6.763h-3.478V8.508h3.466c4.254 0 6.574 2.71 6.587 6.764zM.116 0h47.956v47.956H.116zM42.01 22.02c-.036-.723-.12-1.448-.17-2.166a1.74 1.74 0 00-.395-.98 2.465 2.465 0 00-1.026-.74c-.808-.314-1.622-.664-2.435-.975a21.509 21.509 0 01-3.342-1.472 2.626 2.626 0 01-1.296-1.972 2.954 2.954 0 00-1.47-2.228 4.062 4.062 0 00-2.958-.35c-.734.176-1.5.165-2.23-.033l-1.112-.34-.302-.09-.873-.26c-1.57-.468-2.228-.713-4.773-.278a14.678 14.678 0 00-7.09 3.897l-6.37 6.76h5.72l-3.504 3.71h6.026l-3.503 3.71h4.844l-1.548 4.06c5.93 6.07 12.25 7.295 12.25 7.295 0-1.673.38-8.24.826-9.34a5.25 5.25 0 01.762-1.54 4.211 4.211 0 013.393-1.547c1.303 0 2.597.238 3.815.702.74.31 1.577.264 2.277-.122a38.42 38.42 0 001.498-.94.839.839 0 01.556-.18c.54.06 1.054-.237 1.27-.734.16-.33.35-.64.524-.97.472-.884.69-1.88.633-2.88z"></path></svg></a><nav class="main-nav" aria-label="Main menu"><button type="button" class="ghost main-menu-toggle" aria-haspopup="true" aria-label="Show Menu"></button><ul class="main-menu "><li class="top-level-entry-container"><button type="button" class="top-level-entry" aria-haspopup="true">Technologies</button><ul aria-expanded="false"><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web">Technologies Overview</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/HTML">HTML</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/CSS">CSS</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/JavaScript">JavaScript</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/Guide/Graphics">Graphics</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/HTTP">HTTP</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/API">APIs / DOM</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions">Browser Extensions</a></li><li data-item="Technologies" role="menuitem"><a href="/en-US/docs/Web/MathML">MathML</a></li></ul></li><li class="top-level-entry-container"><button type="button" class="top-level-entry" aria-haspopup="true">References &amp; Guides</button><ul aria-expanded="false"><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Learn">Learn web development</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web/Tutorials">Tutorials</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web/Reference">References</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web/Guide">Developer Guides</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web/Accessibility">Accessibility</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Games">Game development</a></li><li data-item="References &amp; Guides" role="menuitem"><a href="/en-US/docs/Web">...more docs</a></li></ul></li><li class="top-level-entry-container"><button type="button" class="top-level-entry" aria-haspopup="true">Feedback</button><ul aria-expanded="false"><li data-item="Feedback" role="menuitem"><a href="/en-US/docs/MDN/Feedback">Send Feedback</a></li><li data-item="Feedback" role="menuitem"><a target="_blank" rel="noopener noreferrer" href="https://support.mozilla.org/">Get Firefox help<!-- --> 🌐</a></li><li data-item="Feedback" role="menuitem"><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/">Get web development help<!-- --> 🌐</a></li><li data-item="Feedback" role="menuitem"><a href="/en-US/docs/MDN/Community">Join the MDN community</a></li><li data-item="Feedback" role="menuitem"><a target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/sprints/issues/new?template=issue-template.md&amp;projects=mdn/sprints/2&amp;labels=user-report&amp;title=https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">Report a content problem<!-- --> 🌐</a></li><li data-item="Feedback" role="menuitem"><a target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/kuma/issues/new/choose">Report an issue<!-- --> 🌐</a></li></ul></li></ul></nav><div class="header-search "><form id="nav-main-search" action="/en-US/search" method="get" role="search"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" class="search-icon"><path fill-rule="nonzero" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg><label for="main-q" class="visually-hidden">Search MDN</label><input type="search" class="search-input-field" id="main-q" name="q" placeholder="Search MDN" pattern="(.|\s)*\S(.|\s)*" required=""></form><button class="toggle-form"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" class="close-icon hide"><path d="M18.3 5.71a.996.996 0 00-1.41 0L12 10.59 7.11 5.7A.996.996 0 105.7 7.11L10.59 12 5.7 16.89a.996.996 0 101.41 1.41L12 13.41l4.89 4.89a.996.996 0 101.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z" fill-rule="nonzero"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" class="search-icon"><path fill-rule="nonzero" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg><span>Open search</span></button></div><a href="/en-US/users/account/signup-landing?next=/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging" rel="nofollow" class="signin-link">Sign in</a></header><main role="main"><header class="documentation-page-header"><div class="titlebar-container"><div class="titlebar"><h1 class="title">Native messaging</h1></div></div><div class="full-width-row-container"><div class="max-content-width-container"><nav class="breadcrumbs" role="navigation"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla" class="breadcrumb-chevron" property="item" typeof="WebPage"><span class="pre-text">See<!-- -->&nbsp;</span><span property="name">Mozilla</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla/Add-ons" class="breadcrumb-chevron" property="item" typeof="WebPage"><span class="pre-text">See<!-- -->&nbsp;</span><span property="name">Add-ons</span></a><meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions" class="breadcrumb-previous" property="item" typeof="WebPage"><span class="pre-text">See<!-- -->&nbsp;</span><span property="name">Browser Extensions</span></a><meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem"><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging" class="crumb-current-page" property="item" typeof="WebPage"><span property="name" aria-current="page">Native messaging</span></a><meta property="position" content="4"></li></ol></nav><div class="dropdown-container language-menu"><button id="header-language-menu" type="button" class="dropdown-menu-label" aria-haspopup="true" aria-owns="language-menu" aria-label="Current language is English. Choose your preferred language.">English<span class="dropdown-arrow-down" aria-hidden="true">▼</span></button><ul id="language-menu" class="dropdown-menu-items right " aria-expanded="false" role="menu"><li role="menuitem" lang="fr"><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Native_messaging" title="French"><bdi>Français</bdi></a></li><li role="menuitem" lang="ja"><a href="/ja/docs/Mozilla/Add-ons/WebExtensions/Native_messaging" title="Japanese"><bdi>日本語</bdi></a></li><li role="menuitem" lang="zh-CN"><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Native_messaging" title="Chinese (Simplified)"><bdi>中文 (简体)</bdi></a></li><li><a href="https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging$locales" rel="nofollow" id="translations-add">Add a translation</a></li></ul></div></div></div></header><div class="wiki-left-present content-layout"><aside class="document-toc-container"><section class="document-toc"><header><h2>On this Page</h2><button type="button" class="toc-trigger-mobile">Jump to section<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 28" aria-hidden="true" role="img"><path d="M16 11a.99.99 0 01-.297.703l-7 7C8.516 18.89 8.265 19 8 19s-.516-.109-.703-.297l-7-7A.996.996 0 010 11c0-.547.453-1 1-1h14c.547 0 1 .453 1 1z"></path></svg></button></header><ul><li><a href="#Setup" rel="internal">Setup</a></li><li><a href="#Exchanging_messages" rel="internal">Exchanging messages</a></li><li><a href="#Closing_the_native_app" rel="internal">Closing the native app</a></li><li><a href="#Troubleshooting" rel="internal">Troubleshooting</a></li><li><a href="#Chrome_incompatibilities" rel="internal">Chrome incompatibilities</a></li><li class="toc-related-topics"><a href="#sidebar-quicklinks">Related topics</a></li></ul></section></aside><div id="content" class="article text-content"><article id="wikiArticle"><div></div>

<p><span class="seoSummary"><strong>Native messaging</strong> enables an extension to exchange messages with a native application installed on the user's computer. This enables native applications to provide a service to extensions without needing to be reachable over the web.</span></p>

<p>One common example here is password managers: the native application manages storage and encryption of passwords, and communicates with the extension to populate web forms. Native messaging also enables extensions to access resources that are not accessible through WebExtension APIs, such as some particular piece of hardware.</p>

<p>The native application is not installed or managed by the browser; it's installed using the underlying operating system's installation machinery. Along with the native application itself, you'll need to provide a JSON file called the "host manifest" or "app manifest", and install it in a defined location on the user's computer. The app manifest file describes how the browser can connect to the native application.</p>

<p>The extension must request the <code>"nativeMessaging"</code> <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">permission</a> in its <code>manifest.json</code> file. Conversely, the native application must grant permission for the extension by including its ID in the <code>"allowed_extensions"</code> field of the app manifest.</p>

<p>After that the extension can exchange JSON messages with the native application using a set of functions in the <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime" title="This module provides information about your extension and&nbsp;the&nbsp;environment it's running in."><code>runtime</code></a> API. On the native app side, messages are received using standard input (<code>stdin</code>) and sent using standard output (<code>stdout</code>).</p>

<p><img alt="" src="https://mdn.mozillademos.org/files/13833/native-messaging.png" style="display: block; height: 548px; margin-left: auto; margin-right: auto; width: 672px;"></p>

<p>Support for native messaging in extensions is mostly compatible with Chrome, with two main differences:</p>

<ul>
 <li>The app manifest lists <code>allowed_extensions</code> as an array of app IDs, while Chrome lists <code>allowed_origins</code>, as an array of <code>"chrome-extension"</code> URLs.</li>
 <li>The app manifest is stored in a different location <a class="external" href="https://developer.chrome.com/extensions/nativeMessaging#native-messaging-host-location" rel="noopener">compared to Chrome</a>.</li>
</ul>

<p>There's a complete example in the <a class="external" href="https://github.com/mdn/webextensions-examples/tree/master/native-messaging" rel="noopener">"<code>native-messaging</code>" directory</a> of the <code>"webextensions-examples"</code> repository on GitHub. Most example code in this article is taken from that example.</p>

<h2 id="Setup">Setup</h2>

<h3 id="Extension_manifest">Extension manifest</h3>

<p>If you want your extension to communicate with a native application, then:</p>

<ul>
 <li>You must set the&nbsp;<code>"nativeMessaging"</code> <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">permission</a> in its <code><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json">manifest.json</a></code> file.</li>
 <li>You should probably specify your add-on ID explicitly, using the <code><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a></code> manifest key. (This is because the app's manifest will identify the set of extensions that are allowed to connect to it by listing their IDs).</li>
</ul>

<p>Here's an example <code>manifest.json</code> file:</p>

<pre class="brush: json notranslate line-numbers  language-json"><code class="  language-json"><span class="token punctuation">{</span>

  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Native messaging example add-on"</span><span class="token punctuation">,</span>
  <span class="token property">"manifest_version"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Native messaging example"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
  <span class="token property">"icons"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"48"</span><span class="token operator">:</span> <span class="token string">"icons/message.svg"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token property">"browser_specific_settings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"gecko"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"ping_pong@example.org"</span><span class="token punctuation">,</span>
      <span class="token property">"strict_min_version"</span><span class="token operator">:</span> <span class="token string">"50.0"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token property">"background"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"background.js"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token property">"browser_action"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"default_icon"</span><span class="token operator">:</span> <span class="token string">"icons/message.svg"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
 
  <span class="token property">"permissions"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"nativeMessaging"</span><span class="token punctuation">]</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<div class="blockIndicator note">
<p><strong>Note:</strong> Chrome does not support the <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a> key. You will need to use another manifest without this key to install an equivalent WebExtension on Chrome. See <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities">Chrome incompatibilities below</a>.</p>
</div>

<h3 id="App_manifest">App manifest</h3>

<p>The app manifest describes to the browser how it can connect to the native application.</p>

<p>The app manifest file must be installed along with the native application. That is, the browser reads and validates app manifest files but it does not install or manage them. Thus the security model for when and how these files are installed and updated is much more like that for native applications than that for extensions using WebExtension APIs.</p>

<p>For details of native app manifest syntax and location, see <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_manifests">Native manifests</a>.</p>

<p>For example, here's a manifest for the <code>"ping_pong"</code> native application:</p>

<pre class="brush: json notranslate line-numbers  language-json"><code class="  language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ping_pong"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Example host for native messaging"</span><span class="token punctuation">,</span>
  <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"/path/to/native-messaging/app/ping_pong.py"</span><span class="token punctuation">,</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"stdio"</span><span class="token punctuation">,</span>
  <span class="token property">"allowed_extensions"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"ping_pong@example.org"</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>This allows the extension whose ID is <code>"ping_pong@example.org"</code> to connect, by passing the name <code>"ping_pong"</code> into the relevant <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime" title="This module provides information about your extension and&nbsp;the&nbsp;environment it's running in."><code>runtime</code></a> API function. The application itself is at <code>"/path/to/native-messaging/app/ping_pong.py"</code>.</p>

<div class="blockIndicator note">
<p><strong>Note:</strong> Chrome identifies allowed extensions with another key: <code>allowed_origins</code>, using the ID of the WebExtension. Refer to <a class="external" href="https://developer.chrome.com/apps/nativeMessaging#native-messaging-host" rel="noopener">Chrome documentation for more details </a>and see <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities">Chrome incompatibilities below</a>.</p>
</div>

<h3 id="Windows_setup">Windows setup</h3>

<p>As an example, you can also refer to <a class="external" href="https://github.com/SphinxKnight/webextensions-examples/tree/master/native-messaging#windows-setup" rel="noopener">the readme on the native messaging extension on GitHub</a>. If you want to check your local setup after having forked this repository on a Windows machine, you may run <code>check_config_win.py</code> to troubleshoot some issues.</p>

<h4 id="App_manifest_2">App manifest</h4>

<p>In the example above, the native application is a Python script. It can be difficult to get Windows to run Python scripts reliably in this way, so an alternative is to provide a <code>.bat</code> file, and link to that from the application's manifest:</p>

<pre class="brush: json notranslate line-numbers  language-json"><code class="  language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ping_pong"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Example host for native messaging"</span><span class="token punctuation">,</span>
  <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"c:\\path\\to\\native-messaging\\app\\ping_pong_win.bat"</span><span class="token punctuation">,</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"stdio"</span><span class="token punctuation">,</span>
  <span class="token property">"allowed_extensions"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"ping_pong@example.org"</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(See note above about <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities">Chrome compatiblity</a> regarding the <code>allowed_extensions</code> key and its counterpart in Chrome).</p>

<p>The batch file then invokes the Python script:</p>

<pre class="brush: bash notranslate line-numbers  language-bash"><code class="  language-bash">@echo off

python -u <span class="token string">"c:<span class="token entity" title="\\">\\</span>path<span class="token entity" title="\\">\\</span>to<span class="token entity" title="\\">\\</span>native-messaging<span class="token entity" title="\\">\\</span>app<span class="token entity" title="\\">\\</span>ping_pong.py"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="Registry">Registry</h4>

<p>The browser is able to find the extension based on registry keys which are located in a specific location. You need to add them either programmatically with your final application or manually if you are using the example from GitHub. For more details, refer to <a href="/en-US/Add-ons/WebExtensions/Native_manifests#Manifest_location">Manifest location</a>.</p>

<p>Following with the <code>ping_pong</code> example, if using Firefox (see <a class="external" href="https://developer.chrome.com/apps/nativeMessaging#native-messaging-host-location" rel="noopener">this page for Chrome</a>), two registry entries should be created for the messaging to work:</p>

<ul>
 <li><code>HKEY_CURRENT_USER\Software\Mozilla\NativeMessagingHosts\ping_pong</code>

  <ul>
   <li>The default value for this key should be the path to the <em>application</em> manifest: ex. <code>C:\Users\&lt;myusername&gt;\webextensions-examples\native-messaging\app\ping_pong.json</code></li>
  </ul>
 </li>
 <li><code>HKEY_LOCAL_MACHINE\Software\Mozilla\NativeMessagingHosts\ping_pong</code>
  <ul>
   <li>Idem, the default value for this key should be the path to the application manifest.</li>
  </ul>
 </li>
</ul>

<div class="note">
<p><strong>Note:</strong> If you base your work on the example located on GitHub, please read <a class="external" href="https://github.com/SphinxKnight/webextensions-examples/tree/master/native-messaging#windows-setup" rel="noopener">this part of the readme</a> and check the output of <code>check_config_win.py</code> before installing the WebExtension on your browser.</p>
</div>

<ul>
</ul>

<h2 id="Exchanging_messages">Exchanging messages</h2>

<p>Given the above setup, an extension can exchange JSON messages with a native application.</p>

<h3 id="Extension_side">Extension side</h3>

<p>Native messaging cannot directly be used in content scripts. You must&nbsp;<a href="/en-US/Add-ons/WebExtensions/Content_scripts#Communicating_with_background_scripts">do it indirectly via background scripts</a>.</p>

<p>There are two patterns to use here: <strong>connection-based messaging</strong> and <strong>connectionless messaging</strong>.</p>

<h4 id="Connection-based_messaging">Connection-based messaging</h4>

<p>With this pattern you call <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connectNative" title="For more information, see Native messaging."><code>runtime.connectNative()</code></a>, passing the name of the application (the value of the <code>"name"</code> property in the app's manifest). This launches the application if it is not already running and returns a <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port" title="A Port object represents one end of a connection between two specific contexts, which can be used to exchange messages."><code>runtime.Port</code></a> object to the extension.</p>

<p>Two arguments are passed to the native app when it starts:</p>

<ul>
 <li>The complete path to the app manifest</li>
 <li>(new in Firefox 55) the ID (as given in the <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a> <code>manifest.json</code> key) of the add-on that started it.</li>
</ul>

<div class="note">
<p>Chrome&nbsp; handles the passed arguments differently:</p>

<ul>
 <li>On Linux and Mac, Chrome passes <em>one</em> argument: the origin of the extension that started it (in the form&nbsp;<code>chrome-extension://[extensionID]</code>). This enables the app to identify the extension.</li>
 <li>On Windows, Chrome passes <em>two</em> arguments: the first is the origin of the extension, and the second is a handle to the Chrome native window that started the app.</li>
</ul>
</div>

<p>The application stays running until the extension calls <code>Port.disconnect()</code> or the page that connected to it is closed.</p>

<p>To send messages using <code>Port</code>, call its <code>postMessage()</code> function, passing the JSON message to send. To listen for messages using <code>Port</code>, add the listener using its <code>onMessage.addListener()</code> function.</p>

<p>Here's an example background script that establishes a connection with the <code>"ping_pong"</code> app, listens for messages from it, then sends it a <code>"ping"</code> message whenever the user clicks the browser action:</p>

<pre class="brush: js notranslate line-numbers  language-js"><code class="  language-js"><span class="token comment">/*
On startup, connect to the "ping_pong" app.
*/</span>
<span class="token keyword">var</span> port <span class="token operator">=</span> browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span><span class="token function">connectNative</span><span class="token punctuation">(</span><span class="token string">"ping_pong"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
Listen for messages from the app.
*/</span>
port<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Received: "</span> <span class="token operator">+</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
On a click on the browser action, send the app a message.
*/</span>
browser<span class="token punctuation">.</span>browserAction<span class="token punctuation">.</span>onClicked<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Sending:  ping"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  port<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">"ping"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Connectionless_messaging">Connectionless messaging</h4>

<p>With this pattern you call <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendNativeMessage" title="Sends a single message from an extension to a native application."><code>runtime.sendNativeMessage()</code></a>, passing it:</p>

<ul>
 <li>the name of the application</li>
 <li>the JSON message to send</li>
 <li>optionally, a callback.</li>
</ul>

<p>A new instance of the app is created for each message. The app is passed two arguments when it starts:</p>

<ul>
 <li>the complete path to the app manifest</li>
 <li>(new in Firefox 55) the ID (as given in the <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a> manifest.json key) of the add-on that started it.</li>
</ul>

<p>The first message sent by the app is treated as a response to the <code>sendNativeMessage()</code> call, and will be passed into the callback.</p>

<p>Here's the example above, rewritten to use <code>runtime.sendNativeMessage()</code>:</p>

<pre class="brush: js notranslate line-numbers  language-js"><code class="  language-js"><span class="token keyword">function</span> <span class="token function">onResponse</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Received "</span> <span class="token operator">+</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
On a click on the browser action, send the app a message.
*/</span>
browser<span class="token punctuation">.</span>browserAction<span class="token punctuation">.</span>onClicked<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Sending:  ping"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> sending <span class="token operator">=</span> browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span><span class="token function">sendNativeMessage</span><span class="token punctuation">(</span>
    <span class="token string">"ping_pong"</span><span class="token punctuation">,</span>
    <span class="token string">"ping"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sending<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>onResponse<span class="token punctuation">,</span> onError<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="App_side">App side</h3>

<p>On the application side, you use standard input to receive messages and standard output to send them.</p>

<p>Each message is serialized using JSON, UTF-8 encoded and is preceded with a 32-bit value containing the message length in native byte order.</p>

<p>The maximum size of a single message from the application is 1 MB. The maximum size of a message sent to the application is 4 GB.</p>

<p>You can quickly get started sending and receiving messages with this NodeJS code:</p>

<pre class="brush: js notranslate line-numbers  language-js"><code class="  language-js">#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span><span class="token function">node</span>

<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> payloadSize <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token comment">// A queue to store the chunks as we read them from stdin.</span>
    <span class="token comment">// This queue can be flushed when `payloadSize` data has been read</span>
    <span class="token keyword">let</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// Only read the size once for each payload</span>
    <span class="token keyword">const</span> <span class="token function-variable function">sizeHasBeenRead</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>payloadSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// All the data has been read, reset everything for the next message</span>
    <span class="token keyword">const</span> <span class="token function-variable function">flushChunksQueue</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        payloadSize <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        chunks<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">processData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// Create one big buffer with all all the chunks</span>
        <span class="token keyword">const</span> stringData <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// The browser will emit the size as a header of the payload,</span>
        <span class="token comment">// if it hasn't been read yet, do it.</span>
        <span class="token comment">// The next time we'll need to read the payload size is when all of the data</span>
        <span class="token comment">// of the current payload has been read (ie. data.length &gt;= payloadSize + 4)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">sizeHasBeenRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            payloadSize <span class="token operator">=</span> stringData<span class="token punctuation">.</span><span class="token function">readUInt32LE</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// If the data we have read so far is &gt;= to the size advertised in the header,</span>
        <span class="token comment">// it means we have all of the data sent.</span>
        <span class="token comment">// We add 4 here because that's the size of the bytes that old the payloadSize</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stringData<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token punctuation">(</span>payloadSize <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Remove the header</span>
            <span class="token keyword">const</span> contentWithoutSize <span class="token operator">=</span> stringData<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>payloadSize <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Reset the read size and the queued chunks</span>
            <span class="token function">flushChunksQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>contentWithoutSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Do something with the data...</span>
            <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'readable'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// A temporary variable holding the nodejs.Buffer of each</span>
        <span class="token comment">// chunk of data read off stdin</span>
        <span class="token keyword">let</span> chunk <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token comment">// Read all of the available data</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>chunk <span class="token operator">=</span> process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">processData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Here's another example written in Python. It listens for messages from the extension. Note that the file has to be executable on Linux. If the message is <code>"ping"</code>, then it responds with a message <code>"pong"</code>.</p>

<p>This is the Python 2 version:</p>

<pre class="brush: python notranslate line-numbers"><code>#!/usr/bin/python -u

# Note that running python with the `-u` flag is required on Windows,
# in order to ensure that stdin and stdout are opened in binary, rather
# than text, mode.

import json
import sys
import struct


# Read a message from stdin and decode it.
def get_message():
    raw_length = sys.stdin.read(4)
    if not raw_length:
        sys.exit(0)
    message_length = struct.unpack('=I', raw_length)[0]
    message = sys.stdin.read(message_length)
    return json.loads(message)


# Encode a message for transmission, given its content.
def encode_message(message_content):
    encoded_content = json.dumps(message_content)
    encoded_length = struct.pack('=I', len(encoded_content))
    return {'length': encoded_length, 'content': encoded_content}


# Send an encoded message to stdout.
def send_message(encoded_message):
    sys.stdout.write(encoded_message['length'])
    sys.stdout.write(encoded_message['content'])
    sys.stdout.flush()


while True:
    message = get_message()
    if message == "ping":
        send_message(encode_message("pong"))</code></pre>

<p>In Python 3, the received binary data must be decoded into a string. The content to be sent back to the addon must be encoded into binary data using a struct:</p>

<pre class="brush: python notranslate line-numbers"><code>#!/usr/bin/python -u

# Note that running python with the `-u` flag is required on Windows,
# in order to ensure that stdin and stdout are opened in binary, rather
# than text, mode.

import json
import sys
import struct


# Read a message from stdin and decode it.
def get_message():
    raw_length = sys.stdin.buffer.read(4)

    if not raw_length:
        sys.exit(0)
    message_length = struct.unpack('=I', raw_length)[0]
    message = sys.stdin.buffer.read(message_length).decode("utf-8")
    return json.loads(message)


# Encode a message for transmission, given its content.
def encode_message(message_content):
    encoded_content = json.dumps(message_content).encode("utf-8")
    encoded_length = struct.pack('=I', len(encoded_content))
    #  use struct.pack("10s", bytes), to pack a string of the length of 10 characters
    return {'length': encoded_length, 'content': struct.pack(str(len(encoded_content))+"s",encoded_content)}


# Send an encoded message to stdout.
def send_message(encoded_message):
    sys.stdout.buffer.write(encoded_message['length'])
    sys.stdout.buffer.write(encoded_message['content'])
    sys.stdout.buffer.flush()


while True:
    message = get_message()
    if message == "ping":
        send_message(encode_message("pong"))</code></pre>

<h2 id="Closing_the_native_app">Closing the native app</h2>

<p>If you connected to the native application using <code>runtime.connectNative()</code>, then it stays running until the extension calls <code>Port.disconnect()</code> or the page that connected to it is closed. If you started the native application by sending <code>runtime.sendNativeMessage()</code>, then it is closed after it has received the message and sent a response.</p>

<p>To close the native application:</p>

<ul>
 <li>On *nix systems like macOS and Linux, the browser sends <code>SIGTERM</code> to the native application, then <code>SIGKILL</code> after the application has had a chance to exit gracefully. These signals propagate to any subprocesses unless they break away into a new process group.</li>
 <li>On Windows, the browser puts the native application's process into a <a class="external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms684161(v=vs.85).aspx" rel="noopener">Job object</a>, and kills the job. If the native application launches any additional processes and wants them to remain open after the native application itself is killed, then the native application must launch the additional process with the&nbsp;<code><a class="external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms684863(v=vs.85).aspx" rel="noopener">CREATE_BREAKAWAY_FROM_JOB</a></code> flag.</li>
</ul>

<h2 id="Troubleshooting">Troubleshooting</h2>

<p>If something goes wrong, check the <a href="/en-US/Add-ons/WebExtensions/Debugging#Viewing_log_output">browser console</a>. If the native application sends any output to stderr, the browser will redirect it to the browser console. So if you've got as far as launching the native application, you will see any error messages it emits.</p>

<p>If you haven't managed to run the application, you should see an error message giving you a clue about the problem.</p>

<pre class="notranslate line-numbers  language-html"><code class="  language-html">"No such native application <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
 <li>Check that the name passed to <code>runtime.connectNative()</code> matches the name in the app manifest</li>
 <li>macOS/Linux: check that name of the app manifest is <code>&lt;name&gt;.json</code>.</li>
 <li>macOS/Linux: check the native application's manifest file location as mentioned <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_manifests#Mac_OS_X">here</a>.&nbsp;</li>
 <li>Windows: check that the registry key is in the correct place, and that its name matches the name in the app manifest.</li>
 <li>Windows: check that the path given in the registry key points to the app manifest.</li>
</ul>

<pre class="notranslate line-numbers  language-html"><code class="  language-html">"Error: Invalid application <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
 <li>Check that the application's name contains no invalid characters.</li>
</ul>

<pre class="notranslate line-numbers  language-html"><code class="  language-html">"'python' is not recognized as an internal or external command, ..."<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
 <li>Windows: if your application is a Python script, check that you have Python installed and have your path set up for it.</li>
</ul>

<pre class="notranslate line-numbers  language-html"><code class="  language-html">"File at path <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span> does not exist, or is not executable"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
 <li>If you see this, then the app manifest has been found successfully.</li>
 <li>Check that the "path" in the app's manifest is correct.</li>
 <li>Windows: check that you've escaped the path separators (<code>"c:\\path\\to\\file"</code>).</li>
 <li>Check that the app is at the location pointed to by the <code>"path"</code> property in the app's manifest.</li>
 <li>Check that the app is executable.</li>
</ul>

<pre class="notranslate line-numbers  language-html"><code class="  language-html">"This extension does not have permission to use native application <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
 <li>Check that the <code>"allowed_extensions"</code> key in the app manifest contains the add-on's ID.</li>
</ul>

<pre class="notranslate line-numbers  language-html"><code class="  language-html">"TypeError: browser.runtime.connectNative is not a function"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
 <li>Check that the extension has the <code>"nativeMessaging"</code> permission</li>
</ul>

<pre class="notranslate line-numbers  language-html"><code class="  language-html">"[object Object]       NativeMessaging.jsm:218"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
 <li>There was a problem starting the application.</li>
</ul>

<h2 id="Chrome_incompatibilities">Chrome incompatibilities</h2>

<h3 id="Connection-based_messaging_arguments">Connection-based messaging arguments</h3>

<dl>
 <dt>On Linux and Mac</dt>
 <dd>Chrome passes one argument to the native app, which is the origin of the extension that started it, in the form: <code>chrome-extension://«<var>extensionID</var>»</code>. This enables the app to identify the extension.</dd>
 <dt>On Windows</dt>
 <dd>
 <p>Chrome passes two arguments:</p>

 <ol>
  <li>The origin of the extension</li>
  <li>A handle to the Chrome native window that started the app</li>
 </ol>
 </dd>
</dl>

<h3 id="allowed_extensions">allowed_extensions</h3>

<dl>
 <dt>In Firefox</dt>
 <dd>The manifest key is called <code>allowed_extensions</code>.</dd>
 <dt>In Chrome</dt>
 <dd>The manifest key is called <code>allowed_origins</code> instead.</dd>
</dl>

<h3 id="App_manifest_location">App manifest location</h3>

<dl>
 <dt>In Chrome</dt>
 <dd>The app manifest is expected in a different place. See <a class="external" href="https://developer.chrome.com/extensions/nativeMessaging#native-messaging-host-location" rel="noopener">Native messaging host location</a> in the Chrome docs.</dd>
</dl></article><div class="metadata"><section class="document-meta"><header class="visually-hidden"><h4>Metadata</h4></header> <ul><li class="last-modified"><b>Last modified:</b> <time datetime="2020-04-30T01:40:54.154795">Apr 30, 2020</time>,<!-- --> <a href="https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging$history" rel="nofollow">by MDN contributors</a></li></ul></section></div></div><div id="sidebar-quicklinks" class="sidebar"><div class="quick-links"><div class="quick-links-head sidebar-heading">Related Topics</div><div>
  <ol>
    <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions"><strong>Browser extensions</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Getting started</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions">What are extensions?</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension">Your first extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension">Your second extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension">Anatomy of an extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Examples">Example extensions</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/What_next_">What next?</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Concepts</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs">Using the JavaScript APIs</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts">Content scripts</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">Match patterns</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_files">Working with files</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Internationalization">Internationalization</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Security_best_practices">Security best practices</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy">Content Security Policy</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">Native messaging</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>User interface</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface">User Interface</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Accessibility_guidelines">Accessibility guidelines</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action">Toolbar button</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions">Address bar button</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars">Sidebars</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items">Context menu items</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages">Options page</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages">Extension pages</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications">Notifications</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox">Address bar suggestions</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels">Developer tools panels</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>How to</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests">Intercept HTTP requests</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page">Modify a web page</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page">Insert external content</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts">Share objects with page scripts</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar">Add a button to the toolbar</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page">Implement a settings page</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API">Work with the Tabs API</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API">Work with the Bookmarks API</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API">Work with the Cookies API</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities">Work with contextual identities</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension">Build a cross-browser extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/onboarding_upboarding_offboarding_best_practices">Onboard, upboard, and offboard users</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Porting</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators">Firefox differentiators</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Porting_a_Google_Chrome_extension">Porting a Google Chrome extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Porting_a_legacy_Firefox_add-on">Porting a legacy Firefox extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_the_Add-on_SDK">Comparison with the Add-on SDK</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_XUL_XPCOM_extensions">Comparison with XUL/XPCOM extensions</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations">Differences between API implementations</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities">Chrome incompatibilities</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Differences_between_desktop_and_Android">Differences between desktop and Android</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Firefox workflow</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Development_Tools">Developer tools</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Choose_a_Firefox_version_for_web_extension_develop">Choose a Firefox version</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/User_experience_best_practices">User Experience</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Prompt_users_for_data_and_privacy_consents">Prompt users for data and privacy consents</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox">Temporary Installation in Firefox</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Debugging">Debugging</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Testing_persistent_and_restart_features">Testing persistent and restart features</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Test_permission_requests">Test permission requests</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Developing_WebExtensions_for_Firefox_for_Android">Developing for Firefox for Android</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Getting_started_with_web-ext">Getting started with web-ext</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/web-ext_command_reference">web-ext command reference</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/WebExtensions_and_the_Add-on_ID">Extensions and the Add-on ID</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Request_the_right_permissions">Request the right permissions</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Best_practices_for_updating_your_extension">Best practices for updating your extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>JavaScript APIs</summary>
        <ol><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs">Browser support for JavaScript APIs</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/alarms">alarms</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks">bookmarks</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserAction">browserAction</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings">browserSettings</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browsingData">browsingData</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal">captivePortal</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/clipboard">clipboard</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/commands">commands</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts">contentScripts</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities">contextualIdentities</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies">cookies</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools">devtools</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.inspectedWindow">devtools.inspectedWindow</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.network">devtools.network</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.panels">devtools.panels</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/dns">dns</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/downloads">downloads</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/events">events</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension">extension</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes">extensionTypes</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/find">find</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/history">history</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n">i18n</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/identity">identity</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/idle">idle</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/management">management</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/menus">menus</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/notifications">notifications</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/omnibox">omnibox</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pageAction">pageAction</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/permissions">permissions</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11">pkcs11</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/privacy">privacy</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/proxy">proxy</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime">runtime</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/search">search</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sessions">sessions</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction">sidebarAction</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage">storage</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs">tabs</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/theme">theme</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/topSites">topSites</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/types">types</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/userScripts">userScripts</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation">webNavigation</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest">webRequest</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/windows">windows</a></li></ol>
      </details>
    </li>

    <li class="toggle">
      <details>
      <summary>Manifest keys</summary>
      <ol><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author">author</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background">background</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action">browser_action</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides">chrome_settings_overrides</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides">chrome_url_overrides</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands">commands</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts">content_scripts</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy">content_security_policy</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale">default_locale</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description">description</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer">developer</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page">devtools_page</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries">dictionaries</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable">externally_connectable</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url">homepage_url</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons">icons</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito">incognito</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version">manifest_version</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name">name</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled">offline_enabled</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox">omnibox</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions">optional_permissions</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page">options_page</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui">options_ui</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action">page_action</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">permissions</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers">protocol_handlers</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name">short_name</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action">sidebar_action</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage">storage</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme">theme</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment">theme_experiment</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts">user_scripts</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version">version</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name">version_name</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources">web_accessible_resources</a></li></ol>
      </details>
    </li>
    <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Distribution_options">Distribution Options</a></li>
    <li><a href="/en-US/docs/Mozilla/Add-ons/Themes"><strong>Themes</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Browser themes</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Themes/Theme_concepts">Browser theme concepts</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Themes/Using_the_AMO_theme_generator">Using the AMO theme generator</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/en-US/docs/Mozilla/Add-ons/Distribution"><strong>Publishing and Distribution</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Publishing add-ons</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Developer_accounts">Developer accounts</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Distribution">Signing and distribution overview</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Package_your_extension_">Package your extension</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Distribution/Submitting_an_add-on">Submit an add-on</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Source_Code_Submission">Source code submission</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Distribution/Resources_for_publishers">Resources for publishers</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Listing">Creating an appealing listing</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Distribution/Make_money_from_browser_extensions">Make money from browser extensions</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Distribution/Promoting_your_extension_or_theme">Promoting your extension or theme</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/AMO/Policy/Reviews">Add-on policies</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/AMO/Policy/Agreement">Developer agreement</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/AMO/Policy/Featured">Featured add-ons</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/Distribution/Retiring_your_extension">Retiring your extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Distributing add-ons</summary>
        <ol>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Sideloading_add-ons">For sideloading</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_for_desktop_apps">For desktop apps</a></li>
          <li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_in_the_enterprise">For an enterprise</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/en-US/docs/Mozilla/Add-ons/Contact_us"><strong>Contact us</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Channels</summary>
        <ol>
          <li><a class="external" href="https://blog.mozilla.org/addons" rel="noopener">Add-ons blog</a></li>
          <li><a class="external" href="https://discourse.mozilla.org/c/add-ons" rel="noopener">Add-ons forum</a></li>
          <li><a class="external" href="https://chat.mozilla.org/#/room/%23addons:mozilla.org" rel="noopener">Add-ons chat</a></li>
        </ol>
      </details>
    </li>
  </ol>
</div></div></div></div></main><section class="newsletter-container"><div id="newsletter-form-container" class="newsletter"><form class="newsletter-form nodisable" name="newsletter-form"><section class="newsletter-head"><h2 class="newsletter-teaser">Learn the best of web development</h2><p class="newsletter-description">Get the latest and greatest from MDN delivered straight to your inbox.</p><p class="hidden" aria-hidden="true">The newsletter is offered in English only at the moment.</p></section><fieldset class="newsletter-fields"><input type="hidden" name="fmt" value="H"><input type="hidden" name="newsletters" value="app-dev"><div class="form-group newsletter-group-email"><label for="newsletter-email-input" class="form-label offscreen">E-mail</label><input type="email" id="newsletter-email-input" name="email" class="form-input newsletter-input-email" placeholder="you@example.com" required=""></div><div id="newsletter-privacy" class="hidden" aria-hidden="true"><input type="checkbox" id="newsletter-privacy-input" name="privacy" required=""><label for="newsletter-privacy-input">I’m okay with Mozilla handling my info as explained in this <a href="https://www.mozilla.org/privacy/">Privacy Policy</a>.</label></div><div class="newsletter-group-submit"><button id="newsletter-submit" type="submit" class="button neutral newsletter-submit">Sign up now</button></div></fieldset></form><button type="button" class="only-icon newsletter-hide" aria-controls="newsletter-form-container"><span>Hide Newsletter Sign-up</span><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><path d="M18.3 5.71a.996.996 0 00-1.41 0L12 10.59 7.11 5.7A.996.996 0 105.7 7.11L10.59 12 5.7 16.89a.996.996 0 101.41 1.41L12 13.41l4.89 4.89a.996.996 0 101.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z" fill-rule="nonzero"></path></svg></button></div></section><footer id="nav-footer" class="nav-footer" data-testid="footer"><div class="content-container"><a href="/en-US/" class="nav-footer-logo">MDN Web Docs</a><ul class="link-list-mdn"><li><a href="/en-US/docs/Web">Web Technologies</a></li><li><a href="/en-US/docs/Learn">Learn Web Development</a></li><li><a href="/en-US/docs/MDN/About">About MDN</a></li><li><a href="/en-US/docs/MDN/Feedback">Feedback</a></li></ul><ul class="link-list-moz"><li><a href="https://www.mozilla.org/about/" target="_blank" rel="noopener noreferrer">About</a></li><li><a href="https://shop.spreadshirt.com/mdn-store/" target="_blank" rel="noopener noreferrer">MDN Web Docs Store</a></li><li><a href="https://www.mozilla.org/contact/" target="_blank" rel="noopener noreferrer">Contact Us</a></li><li><a href="https://www.mozilla.org/firefox/?utm_source=developer.mozilla.org&amp;utm_campaign=footer&amp;utm_medium=referral" target="_blank" rel="noopener noreferrer">Firefox</a></li></ul><div class="social social-mdn"><h4>MDN</h4><ul><li><a href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><svg class="icon icon-twitter" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 28" aria-label="Twitter" role="img" focusable="false"><path d="M25.312 6.375a10.85 10.85 0 01-2.531 2.609c.016.219.016.438.016.656 0 6.672-5.078 14.359-14.359 14.359-2.859 0-5.516-.828-7.75-2.266.406.047.797.063 1.219.063 2.359 0 4.531-.797 6.266-2.156a5.056 5.056 0 01-4.719-3.5c.313.047.625.078.953.078.453 0 .906-.063 1.328-.172a5.048 5.048 0 01-4.047-4.953v-.063a5.093 5.093 0 002.281.641 5.044 5.044 0 01-2.25-4.203c0-.938.25-1.797.688-2.547a14.344 14.344 0 0010.406 5.281 5.708 5.708 0 01-.125-1.156 5.045 5.045 0 015.047-5.047 5.03 5.03 0 013.687 1.594 9.943 9.943 0 003.203-1.219 5.032 5.032 0 01-2.219 2.781c1.016-.109 2-.391 2.906-.781z"></path></svg></a></li><li><a href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><svg class="icon icon-github" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" aria-label="GitHub" role="img" focusable="false"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-.609.109-.828-.266-.828-.578 0-.391.016-1.687.016-3.297 0-1.125-.375-1.844-.812-2.219 2.672-.297 5.484-1.313 5.484-5.922 0-1.313-.469-2.375-1.234-3.219.125-.313.531-1.531-.125-3.187-1-.313-3.297 1.234-3.297 1.234a11.28 11.28 0 00-6 0S6.704 6.656 5.704 6.969c-.656 1.656-.25 2.875-.125 3.187-.766.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-.344.313-.656.844-.766 1.609-.688.313-2.438.844-3.484-1-.656-1.141-1.844-1.234-1.844-1.234-1.172-.016-.078.734-.078.734.781.359 1.328 1.75 1.328 1.75.703 2.141 4.047 1.422 4.047 1.422 0 1 .016 1.937.016 2.234 0 .313-.219.688-.828.578C3.439 23.796.002 19.296.002 13.999c0-6.625 5.375-12 12-12zM4.547 19.234c.031-.063-.016-.141-.109-.187-.094-.031-.172-.016-.203.031-.031.063.016.141.109.187.078.047.172.031.203-.031zm.484.532c.063-.047.047-.156-.031-.25-.078-.078-.187-.109-.25-.047-.063.047-.047.156.031.25.078.078.187.109.25.047zm.469.703c.078-.063.078-.187 0-.297-.063-.109-.187-.156-.266-.094-.078.047-.078.172 0 .281s.203.156.266.109zm.656.656c.063-.063.031-.203-.063-.297-.109-.109-.25-.125-.313-.047-.078.063-.047.203.063.297.109.109.25.125.313.047zm.891.391c.031-.094-.063-.203-.203-.25-.125-.031-.266.016-.297.109s.063.203.203.234c.125.047.266 0 .297-.094zm.984.078c0-.109-.125-.187-.266-.172-.141 0-.25.078-.25.172 0 .109.109.187.266.172.141 0 .25-.078.25-.172zm.906-.156c-.016-.094-.141-.156-.281-.141-.141.031-.234.125-.219.234.016.094.141.156.281.125s.234-.125.219-.219z"></path></svg></a></li></ul></div><div class="social social-moz"><h4>Mozilla</h4><ul><li><a href="https://twitter.com/mozilla" target="_blank" rel="noopener noreferrer"><svg class="icon icon-twitter" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 28" aria-label="Twitter" role="img" focusable="false"><path d="M25.312 6.375a10.85 10.85 0 01-2.531 2.609c.016.219.016.438.016.656 0 6.672-5.078 14.359-14.359 14.359-2.859 0-5.516-.828-7.75-2.266.406.047.797.063 1.219.063 2.359 0 4.531-.797 6.266-2.156a5.056 5.056 0 01-4.719-3.5c.313.047.625.078.953.078.453 0 .906-.063 1.328-.172a5.048 5.048 0 01-4.047-4.953v-.063a5.093 5.093 0 002.281.641 5.044 5.044 0 01-2.25-4.203c0-.938.25-1.797.688-2.547a14.344 14.344 0 0010.406 5.281 5.708 5.708 0 01-.125-1.156 5.045 5.045 0 015.047-5.047 5.03 5.03 0 013.687 1.594 9.943 9.943 0 003.203-1.219 5.032 5.032 0 01-2.219 2.781c1.016-.109 2-.391 2.906-.781z"></path></svg></a></li><li><a href="https://www.instagram.com/mozillagram/" target="_blank" rel="noopener noreferrer"><svg class="icon icon-instagram" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" aria-label="Instagram" role="img" focusable="false"><path d="M16 14c0-2.203-1.797-4-4-4s-4 1.797-4 4 1.797 4 4 4 4-1.797 4-4zm2.156 0c0 3.406-2.75 6.156-6.156 6.156S5.844 17.406 5.844 14 8.594 7.844 12 7.844s6.156 2.75 6.156 6.156zm1.688-6.406c0 .797-.641 1.437-1.437 1.437S16.97 8.39 16.97 7.594s.641-1.437 1.437-1.437 1.437.641 1.437 1.437zM12 4.156c-1.75 0-5.5-.141-7.078.484-.547.219-.953.484-1.375.906s-.688.828-.906 1.375c-.625 1.578-.484 5.328-.484 7.078s-.141 5.5.484 7.078c.219.547.484.953.906 1.375s.828.688 1.375.906c1.578.625 5.328.484 7.078.484s5.5.141 7.078-.484c.547-.219.953-.484 1.375-.906s.688-.828.906-1.375c.625-1.578.484-5.328.484-7.078s.141-5.5-.484-7.078c-.219-.547-.484-.953-.906-1.375s-.828-.688-1.375-.906C17.5 4.015 13.75 4.156 12 4.156zM24 14c0 1.656.016 3.297-.078 4.953-.094 1.922-.531 3.625-1.937 5.031s-3.109 1.844-5.031 1.937c-1.656.094-3.297.078-4.953.078s-3.297.016-4.953-.078c-1.922-.094-3.625-.531-5.031-1.937S.173 20.875.08 18.953C-.014 17.297.002 15.656.002 14s-.016-3.297.078-4.953c.094-1.922.531-3.625 1.937-5.031s3.109-1.844 5.031-1.937c1.656-.094 3.297-.078 4.953-.078s3.297-.016 4.953.078c1.922.094 3.625.531 5.031 1.937s1.844 3.109 1.937 5.031C24.016 10.703 24 12.344 24 14z"></path></svg></a></li></ul></div><p id="license" class="footer-license">© 2005-<!-- -->2020<!-- --> Mozilla and individual contributors. Content is available under<!-- --> <a href="/docs/MDN/About#Copyrights_and_licenses">these licenses</a>.</p><ul class="footer-legal"><li><a href="https://www.mozilla.org/about/legal/terms/mozilla" target="_blank" rel="noopener noreferrer">Terms</a></li><li><a href="https://www.mozilla.org/privacy/websites/" target="_blank" rel="noopener noreferrer">Privacy</a></li><li><a href="https://www.mozilla.org/privacy/websites/#cookies" target="_blank" rel="noopener noreferrer">Cookies</a></li></ul></div></footer></div>
<script>window._react_data = JSON.parse("{\"locale\":\"en-US\",\"stringCatalog\":{},\"pluralExpression\":null,\"url\":\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\",\"documentData\":{\"locale\":\"en-US\",\"slug\":\"Mozilla/Add-ons/WebExtensions/Native_messaging\",\"enSlug\":\"Mozilla/Add-ons/WebExtensions/Native_messaging\",\"id\":193317,\"title\":\"Native messaging\",\"summary\":\"<strong>Native messaging</strong> enables an extension to exchange messages with a native application installed on the user's computer. This enables native applications to provide a service to extensions without needing to be reachable over the web.\",\"language\":\"English (US)\",\"hrefLang\":\"en\",\"absoluteURL\":\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\",\"wikiURL\":\"https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\",\"editURL\":\"https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging$edit\",\"translateURL\":\"https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging$locales\",\"translationStatus\":null,\"bodyHTML\":\"<div></div>\\n\\n<p><span class=\\\"seoSummary\\\"><strong>Native messaging</strong> enables an extension to exchange messages with a native application installed on the user's computer. This enables native applications to provide a service to extensions without needing to be reachable over the web.</span></p>\\n\\n<p>One common example here is password managers: the native application manages storage and encryption of passwords, and communicates with the extension to populate web forms. Native messaging also enables extensions to access resources that are not accessible through WebExtension APIs, such as some particular piece of hardware.</p>\\n\\n<p>The native application is not installed or managed by the browser; it's installed using the underlying operating system's installation machinery. Along with the native application itself, you'll need to provide a JSON file called the \\\"host manifest\\\" or \\\"app manifest\\\", and install it in a defined location on the user's computer. The app manifest file describes how the browser can connect to the native application.</p>\\n\\n<p>The extension must request the <code>\\\"nativeMessaging\\\"</code> <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\\\">permission</a> in its <code>manifest.json</code> file. Conversely, the native application must grant permission for the extension by including its ID in the <code>\\\"allowed_extensions\\\"</code> field of the app manifest.</p>\\n\\n<p>After that the extension can exchange JSON messages with the native application using a set of functions in the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime\\\" title=\\\"This module provides information about your extension and\u00A0the\u00A0environment it's running in.\\\"><code>runtime</code></a> API. On the native app side, messages are received using standard input (<code>stdin</code>) and sent using standard output (<code>stdout</code>).</p>\\n\\n<p><img alt=\\\"\\\" src=\\\"https://mdn.mozillademos.org/files/13833/native-messaging.png\\\" style=\\\"display: block; height: 548px; margin-left: auto; margin-right: auto; width: 672px;\\\"></p>\\n\\n<p>Support for native messaging in extensions is mostly compatible with Chrome, with two main differences:</p>\\n\\n<ul>\\n <li>The app manifest lists <code>allowed_extensions</code> as an array of app IDs, while Chrome lists <code>allowed_origins</code>, as an array of <code>\\\"chrome-extension\\\"</code> URLs.</li>\\n <li>The app manifest is stored in a different location <a class=\\\"external\\\" href=\\\"https://developer.chrome.com/extensions/nativeMessaging#native-messaging-host-location\\\" rel=\\\"noopener\\\">compared to Chrome</a>.</li>\\n</ul>\\n\\n<p>There's a complete example in the <a class=\\\"external\\\" href=\\\"https://github.com/mdn/webextensions-examples/tree/master/native-messaging\\\" rel=\\\"noopener\\\">\\\"<code>native-messaging</code>\\\" directory</a> of the <code>\\\"webextensions-examples\\\"</code> repository on GitHub. Most example code in this article is taken from that example.</p>\\n\\n<h2 id=\\\"Setup\\\">Setup</h2>\\n\\n<h3 id=\\\"Extension_manifest\\\">Extension manifest</h3>\\n\\n<p>If you want your extension to communicate with a native application, then:</p>\\n\\n<ul>\\n <li>You must set the\u00A0<code>\\\"nativeMessaging\\\"</code> <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\\\">permission</a> in its <code><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json\\\">manifest.json</a></code> file.</li>\\n <li>You should probably specify your add-on ID explicitly, using the <code><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a></code> manifest key. (This is because the app's manifest will identify the set of extensions that are allowed to connect to it by listing their IDs).</li>\\n</ul>\\n\\n<p>Here's an example <code>manifest.json</code> file:</p>\\n\\n<pre class=\\\"brush: json notranslate\\\">{\\n\\n  \\\"description\\\": \\\"Native messaging example add-on\\\",\\n  \\\"manifest_version\\\": 2,\\n  \\\"name\\\": \\\"Native messaging example\\\",\\n  \\\"version\\\": \\\"1.0\\\",\\n  \\\"icons\\\": {\\n    \\\"48\\\": \\\"icons/message.svg\\\"\\n  },\\n\\n  \\\"browser_specific_settings\\\": {\\n    \\\"gecko\\\": {\\n      \\\"id\\\": \\\"ping_pong@example.org\\\",\\n      \\\"strict_min_version\\\": \\\"50.0\\\"\\n    }\\n  },\\n\\n  \\\"background\\\": {\\n    \\\"scripts\\\": [\\\"background.js\\\"]\\n  },\\n\\n  \\\"browser_action\\\": {\\n    \\\"default_icon\\\": \\\"icons/message.svg\\\"\\n  },\\n \\n  \\\"permissions\\\": [\\\"nativeMessaging\\\"]\\n\\n}</pre>\\n\\n<div class=\\\"blockIndicator note\\\">\\n<p><strong>Note:</strong> Chrome does not support the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a> key. You will need to use another manifest without this key to install an equivalent WebExtension on Chrome. See <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities\\\">Chrome incompatibilities below</a>.</p>\\n</div>\\n\\n<h3 id=\\\"App_manifest\\\">App manifest</h3>\\n\\n<p>The app manifest describes to the browser how it can connect to the native application.</p>\\n\\n<p>The app manifest file must be installed along with the native application. That is, the browser reads and validates app manifest files but it does not install or manage them. Thus the security model for when and how these files are installed and updated is much more like that for native applications than that for extensions using WebExtension APIs.</p>\\n\\n<p>For details of native app manifest syntax and location, see <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_manifests\\\">Native manifests</a>.</p>\\n\\n<p>For example, here's a manifest for the <code>\\\"ping_pong\\\"</code> native application:</p>\\n\\n<pre class=\\\"brush: json notranslate\\\">{\\n  \\\"name\\\": \\\"ping_pong\\\",\\n  \\\"description\\\": \\\"Example host for native messaging\\\",\\n  \\\"path\\\": \\\"/path/to/native-messaging/app/ping_pong.py\\\",\\n  \\\"type\\\": \\\"stdio\\\",\\n  \\\"allowed_extensions\\\": [ \\\"ping_pong@example.org\\\" ]\\n}</pre>\\n\\n<p>This allows the extension whose ID is <code>\\\"ping_pong@example.org\\\"</code> to connect, by passing the name <code>\\\"ping_pong\\\"</code> into the relevant <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime\\\" title=\\\"This module provides information about your extension and\u00A0the\u00A0environment it's running in.\\\"><code>runtime</code></a> API function. The application itself is at <code>\\\"/path/to/native-messaging/app/ping_pong.py\\\"</code>.</p>\\n\\n<div class=\\\"blockIndicator note\\\">\\n<p><strong>Note:</strong> Chrome identifies allowed extensions with another key: <code>allowed_origins</code>, using the ID of the WebExtension. Refer to <a class=\\\"external\\\" href=\\\"https://developer.chrome.com/apps/nativeMessaging#native-messaging-host\\\" rel=\\\"noopener\\\">Chrome documentation for more details </a>and see <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities\\\">Chrome incompatibilities below</a>.</p>\\n</div>\\n\\n<h3 id=\\\"Windows_setup\\\">Windows setup</h3>\\n\\n<p>As an example, you can also refer to <a class=\\\"external\\\" href=\\\"https://github.com/SphinxKnight/webextensions-examples/tree/master/native-messaging#windows-setup\\\" rel=\\\"noopener\\\">the readme on the native messaging extension on GitHub</a>. If you want to check your local setup after having forked this repository on a Windows machine, you may run <code>check_config_win.py</code> to troubleshoot some issues.</p>\\n\\n<h4 id=\\\"App_manifest_2\\\">App manifest</h4>\\n\\n<p>In the example above, the native application is a Python script. It can be difficult to get Windows to run Python scripts reliably in this way, so an alternative is to provide a <code>.bat</code> file, and link to that from the application's manifest:</p>\\n\\n<pre class=\\\"brush: json notranslate\\\">{\\n  \\\"name\\\": \\\"ping_pong\\\",\\n  \\\"description\\\": \\\"Example host for native messaging\\\",\\n  \\\"path\\\": \\\"c:\\\\\\\\path\\\\\\\\to\\\\\\\\native-messaging\\\\\\\\app\\\\\\\\ping_pong_win.bat\\\",\\n  \\\"type\\\": \\\"stdio\\\",\\n  \\\"allowed_extensions\\\": [ \\\"ping_pong@example.org\\\" ]\\n}</pre>\\n\\n<p>(See note above about <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities\\\">Chrome compatiblity</a> regarding the <code>allowed_extensions</code> key and its counterpart in Chrome).</p>\\n\\n<p>The batch file then invokes the Python script:</p>\\n\\n<pre class=\\\"brush: bash notranslate\\\">@echo off\\n\\npython -u \\\"c:\\\\\\\\path\\\\\\\\to\\\\\\\\native-messaging\\\\\\\\app\\\\\\\\ping_pong.py\\\"</pre>\\n\\n<h4 id=\\\"Registry\\\">Registry</h4>\\n\\n<p>The browser is able to find the extension based on registry keys which are located in a specific location. You need to add them either programmatically with your final application or manually if you are using the example from GitHub. For more details, refer to <a href=\\\"/en-US/Add-ons/WebExtensions/Native_manifests#Manifest_location\\\">Manifest location</a>.</p>\\n\\n<p>Following with the <code>ping_pong</code> example, if using Firefox (see <a class=\\\"external\\\" href=\\\"https://developer.chrome.com/apps/nativeMessaging#native-messaging-host-location\\\" rel=\\\"noopener\\\">this page for Chrome</a>), two registry entries should be created for the messaging to work:</p>\\n\\n<ul>\\n <li><code>HKEY_CURRENT_USER\\\\Software\\\\Mozilla\\\\NativeMessagingHosts\\\\ping_pong</code>\\n\\n  <ul>\\n   <li>The default value for this key should be the path to the <em>application</em> manifest: ex. <code>C:\\\\Users\\\\&lt;myusername&gt;\\\\webextensions-examples\\\\native-messaging\\\\app\\\\ping_pong.json</code></li>\\n  </ul>\\n </li>\\n <li><code>HKEY_LOCAL_MACHINE\\\\Software\\\\Mozilla\\\\NativeMessagingHosts\\\\ping_pong</code>\\n  <ul>\\n   <li>Idem, the default value for this key should be the path to the application manifest.</li>\\n  </ul>\\n </li>\\n</ul>\\n\\n<div class=\\\"note\\\">\\n<p><strong>Note:</strong> If you base your work on the example located on GitHub, please read <a class=\\\"external\\\" href=\\\"https://github.com/SphinxKnight/webextensions-examples/tree/master/native-messaging#windows-setup\\\" rel=\\\"noopener\\\">this part of the readme</a> and check the output of <code>check_config_win.py</code> before installing the WebExtension on your browser.</p>\\n</div>\\n\\n<ul>\\n</ul>\\n\\n<h2 id=\\\"Exchanging_messages\\\">Exchanging messages</h2>\\n\\n<p>Given the above setup, an extension can exchange JSON messages with a native application.</p>\\n\\n<h3 id=\\\"Extension_side\\\">Extension side</h3>\\n\\n<p>Native messaging cannot directly be used in content scripts. You must\u00A0<a href=\\\"/en-US/Add-ons/WebExtensions/Content_scripts#Communicating_with_background_scripts\\\">do it indirectly via background scripts</a>.</p>\\n\\n<p>There are two patterns to use here: <strong>connection-based messaging</strong> and <strong>connectionless messaging</strong>.</p>\\n\\n<h4 id=\\\"Connection-based_messaging\\\">Connection-based messaging</h4>\\n\\n<p>With this pattern you call <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connectNative\\\" title=\\\"For more information, see Native messaging.\\\"><code>runtime.connectNative()</code></a>, passing the name of the application (the value of the <code>\\\"name\\\"</code> property in the app's manifest). This launches the application if it is not already running and returns a <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port\\\" title=\\\"A Port object represents one end of a connection between two specific contexts, which can be used to exchange messages.\\\"><code>runtime.Port</code></a> object to the extension.</p>\\n\\n<p>Two arguments are passed to the native app when it starts:</p>\\n\\n<ul>\\n <li>The complete path to the app manifest</li>\\n <li>(new in Firefox 55) the ID (as given in the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a> <code>manifest.json</code> key) of the add-on that started it.</li>\\n</ul>\\n\\n<div class=\\\"note\\\">\\n<p>Chrome\u00A0 handles the passed arguments differently:</p>\\n\\n<ul>\\n <li>On Linux and Mac, Chrome passes <em>one</em> argument: the origin of the extension that started it (in the form\u00A0<code>chrome-extension://[extensionID]</code>). This enables the app to identify the extension.</li>\\n <li>On Windows, Chrome passes <em>two</em> arguments: the first is the origin of the extension, and the second is a handle to the Chrome native window that started the app.</li>\\n</ul>\\n</div>\\n\\n<p>The application stays running until the extension calls <code>Port.disconnect()</code> or the page that connected to it is closed.</p>\\n\\n<p>To send messages using <code>Port</code>, call its <code>postMessage()</code> function, passing the JSON message to send. To listen for messages using <code>Port</code>, add the listener using its <code>onMessage.addListener()</code> function.</p>\\n\\n<p>Here's an example background script that establishes a connection with the <code>\\\"ping_pong\\\"</code> app, listens for messages from it, then sends it a <code>\\\"ping\\\"</code> message whenever the user clicks the browser action:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">/*\\nOn startup, connect to the \\\"ping_pong\\\" app.\\n*/\\nvar port = browser.runtime.connectNative(\\\"ping_pong\\\");\\n\\n/*\\nListen for messages from the app.\\n*/\\nport.onMessage.addListener((response) =&gt; {\\n  console.log(\\\"Received: \\\" + response);\\n});\\n\\n/*\\nOn a click on the browser action, send the app a message.\\n*/\\nbrowser.browserAction.onClicked.addListener(() =&gt; {\\n  console.log(\\\"Sending:  ping\\\");\\n  port.postMessage(\\\"ping\\\");\\n});</pre>\\n\\n<h4 id=\\\"Connectionless_messaging\\\">Connectionless messaging</h4>\\n\\n<p>With this pattern you call <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendNativeMessage\\\" title=\\\"Sends a single message from an extension to a native application.\\\"><code>runtime.sendNativeMessage()</code></a>, passing it:</p>\\n\\n<ul>\\n <li>the name of the application</li>\\n <li>the JSON message to send</li>\\n <li>optionally, a callback.</li>\\n</ul>\\n\\n<p>A new instance of the app is created for each message. The app is passed two arguments when it starts:</p>\\n\\n<ul>\\n <li>the complete path to the app manifest</li>\\n <li>(new in Firefox 55) the ID (as given in the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a> manifest.json key) of the add-on that started it.</li>\\n</ul>\\n\\n<p>The first message sent by the app is treated as a response to the <code>sendNativeMessage()</code> call, and will be passed into the callback.</p>\\n\\n<p>Here's the example above, rewritten to use <code>runtime.sendNativeMessage()</code>:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">function onResponse(response) {\\n  console.log(\\\"Received \\\" + response);\\n}\\n\\nfunction onError(error) {\\n  console.log(`Error: ${error}`);\\n}\\n\\n/*\\nOn a click on the browser action, send the app a message.\\n*/\\nbrowser.browserAction.onClicked.addListener(() =&gt; {\\n  console.log(\\\"Sending:  ping\\\");\\n  var sending = browser.runtime.sendNativeMessage(\\n    \\\"ping_pong\\\",\\n    \\\"ping\\\");\\n  sending.then(onResponse, onError);\\n});\\n</pre>\\n\\n<h3 id=\\\"App_side\\\">App side</h3>\\n\\n<p>On the application side, you use standard input to receive messages and standard output to send them.</p>\\n\\n<p>Each message is serialized using JSON, UTF-8 encoded and is preceded with a 32-bit value containing the message length in native byte order.</p>\\n\\n<p>The maximum size of a single message from the application is 1 MB. The maximum size of a message sent to the application is 4 GB.</p>\\n\\n<p>You can quickly get started sending and receiving messages with this NodeJS code:</p>\\n\\n<pre class=\\\"brush: js notranslate\\\">#!/usr/local/bin/node\\n\\n(() =&gt; {\\n\\n    let payloadSize = null;\\n\\n    // A queue to store the chunks as we read them from stdin.\\n    // This queue can be flushed when `payloadSize` data has been read\\n    let chunks = [];\\n\\n    // Only read the size once for each payload\\n    const sizeHasBeenRead = () =&gt; Boolean(payloadSize);\\n\\n    // All the data has been read, reset everything for the next message\\n    const flushChunksQueue = () =&gt; {\\n        payloadSize = null;\\n        chunks.splice(0);\\n    };\\n\\n    const processData = () =&gt; {\\n        // Create one big buffer with all all the chunks\\n        const stringData = Buffer.concat(chunks);\\n\\n        // The browser will emit the size as a header of the payload,\\n        // if it hasn't been read yet, do it.\\n        // The next time we'll need to read the payload size is when all of the data\\n        // of the current payload has been read (ie. data.length &gt;= payloadSize + 4)\\n        if (!sizeHasBeenRead()) {\\n            payloadSize = stringData.readUInt32LE(0);\\n        }\\n\\n        // If the data we have read so far is &gt;= to the size advertised in the header,\\n        // it means we have all of the data sent.\\n        // We add 4 here because that's the size of the bytes that old the payloadSize\\n        if (stringData.length &gt;= (payloadSize + 4)) {\\n            // Remove the header\\n            const contentWithoutSize = stringData.slice(4, (payloadSize + 4));\\n\\n            // Reset the read size and the queued chunks\\n            flushChunksQueue();\\n\\n            const json = JSON.parse(contentWithoutSize);\\n            // Do something with the data...\\n            }\\n    };\\n\\n    process.stdin.on('readable', () =&gt; {\\n        // A temporary variable holding the nodejs.Buffer of each\\n        // chunk of data read off stdin\\n        let chunk = null;\\n\\n        // Read all of the available data\\n        while ((chunk = process.stdin.read()) !== null) {\\n            chunks.push(chunk);\\n        }\\n\\n        processData();\\n \\n    });\\n})();\\n</pre>\\n\\n<p>Here's another example written in Python. It listens for messages from the extension. Note that the file has to be executable on Linux. If the message is <code>\\\"ping\\\"</code>, then it responds with a message <code>\\\"pong\\\"</code>.</p>\\n\\n<p>This is the Python 2 version:</p>\\n\\n<pre class=\\\"brush: python notranslate\\\">#!/usr/bin/python -u\\n\\n# Note that running python with the `-u` flag is required on Windows,\\n# in order to ensure that stdin and stdout are opened in binary, rather\\n# than text, mode.\\n\\nimport json\\nimport sys\\nimport struct\\n\\n\\n# Read a message from stdin and decode it.\\ndef get_message():\\n    raw_length = sys.stdin.read(4)\\n    if not raw_length:\\n        sys.exit(0)\\n    message_length = struct.unpack('=I', raw_length)[0]\\n    message = sys.stdin.read(message_length)\\n    return json.loads(message)\\n\\n\\n# Encode a message for transmission, given its content.\\ndef encode_message(message_content):\\n    encoded_content = json.dumps(message_content)\\n    encoded_length = struct.pack('=I', len(encoded_content))\\n    return {'length': encoded_length, 'content': encoded_content}\\n\\n\\n# Send an encoded message to stdout.\\ndef send_message(encoded_message):\\n    sys.stdout.write(encoded_message['length'])\\n    sys.stdout.write(encoded_message['content'])\\n    sys.stdout.flush()\\n\\n\\nwhile True:\\n    message = get_message()\\n    if message == \\\"ping\\\":\\n        send_message(encode_message(\\\"pong\\\"))</pre>\\n\\n<p>In Python 3, the received binary data must be decoded into a string. The content to be sent back to the addon must be encoded into binary data using a struct:</p>\\n\\n<pre class=\\\"brush: python notranslate\\\">#!/usr/bin/python -u\\n\\n# Note that running python with the `-u` flag is required on Windows,\\n# in order to ensure that stdin and stdout are opened in binary, rather\\n# than text, mode.\\n\\nimport json\\nimport sys\\nimport struct\\n\\n\\n# Read a message from stdin and decode it.\\ndef get_message():\\n    raw_length = sys.stdin.buffer.read(4)\\n\\n    if not raw_length:\\n        sys.exit(0)\\n    message_length = struct.unpack('=I', raw_length)[0]\\n    message = sys.stdin.buffer.read(message_length).decode(\\\"utf-8\\\")\\n    return json.loads(message)\\n\\n\\n# Encode a message for transmission, given its content.\\ndef encode_message(message_content):\\n    encoded_content = json.dumps(message_content).encode(\\\"utf-8\\\")\\n    encoded_length = struct.pack('=I', len(encoded_content))\\n    #  use struct.pack(\\\"10s\\\", bytes), to pack a string of the length of 10 characters\\n    return {'length': encoded_length, 'content': struct.pack(str(len(encoded_content))+\\\"s\\\",encoded_content)}\\n\\n\\n# Send an encoded message to stdout.\\ndef send_message(encoded_message):\\n    sys.stdout.buffer.write(encoded_message['length'])\\n    sys.stdout.buffer.write(encoded_message['content'])\\n    sys.stdout.buffer.flush()\\n\\n\\nwhile True:\\n    message = get_message()\\n    if message == \\\"ping\\\":\\n        send_message(encode_message(\\\"pong\\\"))</pre>\\n\\n<h2 id=\\\"Closing_the_native_app\\\">Closing the native app</h2>\\n\\n<p>If you connected to the native application using <code>runtime.connectNative()</code>, then it stays running until the extension calls <code>Port.disconnect()</code> or the page that connected to it is closed. If you started the native application by sending <code>runtime.sendNativeMessage()</code>, then it is closed after it has received the message and sent a response.</p>\\n\\n<p>To close the native application:</p>\\n\\n<ul>\\n <li>On *nix systems like macOS and Linux, the browser sends <code>SIGTERM</code> to the native application, then <code>SIGKILL</code> after the application has had a chance to exit gracefully. These signals propagate to any subprocesses unless they break away into a new process group.</li>\\n <li>On Windows, the browser puts the native application's process into a <a class=\\\"external\\\" href=\\\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684161(v=vs.85).aspx\\\" rel=\\\"noopener\\\">Job object</a>, and kills the job. If the native application launches any additional processes and wants them to remain open after the native application itself is killed, then the native application must launch the additional process with the\u00A0<code><a class=\\\"external\\\" href=\\\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684863(v=vs.85).aspx\\\" rel=\\\"noopener\\\">CREATE_BREAKAWAY_FROM_JOB</a></code> flag.</li>\\n</ul>\\n\\n<h2 id=\\\"Troubleshooting\\\">Troubleshooting</h2>\\n\\n<p>If something goes wrong, check the <a href=\\\"/en-US/Add-ons/WebExtensions/Debugging#Viewing_log_output\\\">browser console</a>. If the native application sends any output to stderr, the browser will redirect it to the browser console. So if you've got as far as launching the native application, you will see any error messages it emits.</p>\\n\\n<p>If you haven't managed to run the application, you should see an error message giving you a clue about the problem.</p>\\n\\n<pre class=\\\"notranslate\\\">\\\"No such native application &lt;name&gt;\\\"</pre>\\n\\n<ul>\\n <li>Check that the name passed to <code>runtime.connectNative()</code> matches the name in the app manifest</li>\\n <li>macOS/Linux: check that name of the app manifest is <code>&lt;name&gt;.json</code>.</li>\\n <li>macOS/Linux: check the native application's manifest file location as mentioned <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_manifests#Mac_OS_X\\\">here</a>.\u00A0</li>\\n <li>Windows: check that the registry key is in the correct place, and that its name matches the name in the app manifest.</li>\\n <li>Windows: check that the path given in the registry key points to the app manifest.</li>\\n</ul>\\n\\n<pre class=\\\"notranslate\\\">\\\"Error: Invalid application &lt;name&gt;\\\"</pre>\\n\\n<ul>\\n <li>Check that the application's name contains no invalid characters.</li>\\n</ul>\\n\\n<pre class=\\\"notranslate\\\">\\\"'python' is not recognized as an internal or external command, ...\\\"</pre>\\n\\n<ul>\\n <li>Windows: if your application is a Python script, check that you have Python installed and have your path set up for it.</li>\\n</ul>\\n\\n<pre class=\\\"notranslate\\\">\\\"File at path &lt;path&gt; does not exist, or is not executable\\\"</pre>\\n\\n<ul>\\n <li>If you see this, then the app manifest has been found successfully.</li>\\n <li>Check that the \\\"path\\\" in the app's manifest is correct.</li>\\n <li>Windows: check that you've escaped the path separators (<code>\\\"c:\\\\\\\\path\\\\\\\\to\\\\\\\\file\\\"</code>).</li>\\n <li>Check that the app is at the location pointed to by the <code>\\\"path\\\"</code> property in the app's manifest.</li>\\n <li>Check that the app is executable.</li>\\n</ul>\\n\\n<pre class=\\\"notranslate\\\">\\\"This extension does not have permission to use native application &lt;name&gt;\\\"</pre>\\n\\n<ul>\\n <li>Check that the <code>\\\"allowed_extensions\\\"</code> key in the app manifest contains the add-on's ID.</li>\\n</ul>\\n\\n<pre class=\\\"notranslate\\\">\\\"TypeError: browser.runtime.connectNative is not a function\\\"</pre>\\n\\n<ul>\\n <li>Check that the extension has the <code>\\\"nativeMessaging\\\"</code> permission</li>\\n</ul>\\n\\n<pre class=\\\"notranslate\\\">\\\"[object Object]       NativeMessaging.jsm:218\\\"</pre>\\n\\n<ul>\\n <li>There was a problem starting the application.</li>\\n</ul>\\n\\n<h2 id=\\\"Chrome_incompatibilities\\\">Chrome incompatibilities</h2>\\n\\n<h3 id=\\\"Connection-based_messaging_arguments\\\">Connection-based messaging arguments</h3>\\n\\n<dl>\\n <dt>On Linux and Mac</dt>\\n <dd>Chrome passes one argument to the native app, which is the origin of the extension that started it, in the form: <code>chrome-extension://\u00AB<var>extensionID</var>\u00BB</code>. This enables the app to identify the extension.</dd>\\n <dt>On Windows</dt>\\n <dd>\\n <p>Chrome passes two arguments:</p>\\n\\n <ol>\\n  <li>The origin of the extension</li>\\n  <li>A handle to the Chrome native window that started the app</li>\\n </ol>\\n </dd>\\n</dl>\\n\\n<h3 id=\\\"allowed_extensions\\\">allowed_extensions</h3>\\n\\n<dl>\\n <dt>In Firefox</dt>\\n <dd>The manifest key is called <code>allowed_extensions</code>.</dd>\\n <dt>In Chrome</dt>\\n <dd>The manifest key is called <code>allowed_origins</code> instead.</dd>\\n</dl>\\n\\n<h3 id=\\\"App_manifest_location\\\">App manifest location</h3>\\n\\n<dl>\\n <dt>In Chrome</dt>\\n <dd>The app manifest is expected in a different place. See <a class=\\\"external\\\" href=\\\"https://developer.chrome.com/extensions/nativeMessaging#native-messaging-host-location\\\" rel=\\\"noopener\\\">Native messaging host location</a> in the Chrome docs.</dd>\\n</dl>\",\"quickLinksHTML\":\"\\n  <ol>\\n    <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions\\\"><strong>Browser extensions</strong></a></li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Getting started</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\\\">What are extensions?</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\\\">Your first extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\\\">Your second extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\\\">Anatomy of an extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Examples\\\">Example extensions</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/What_next_\\\">What next?</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Concepts</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\\\">Using the JavaScript APIs</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\\\">Content scripts</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\\\">Match patterns</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\\\">Working with files</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Internationalization\\\">Internationalization</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Security_best_practices\\\">Security best practices</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\\\">Content Security Policy</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\\\">Native messaging</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>User interface</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface\\\">User Interface</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Accessibility_guidelines\\\">Accessibility guidelines</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\\\">Toolbar button</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\\\">Address bar button</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\\\">Sidebars</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\\\">Context menu items</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\\\">Options page</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\\\">Extension pages</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\\\">Notifications</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\\\">Address bar suggestions</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\\\">Developer tools panels</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>How to</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\\\">Intercept HTTP requests</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\\\">Modify a web page</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\\\">Insert external content</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\\\">Share objects with page scripts</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\\\">Add a button to the toolbar</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\\\">Implement a settings page</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\\\">Work with the Tabs API</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\\\">Work with the Bookmarks API</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\\\">Work with the Cookies API</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\\\">Work with contextual identities</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\\\">Build a cross-browser extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/onboarding_upboarding_offboarding_best_practices\\\">Onboard, upboard, and offboard users</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Porting</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\\\">Firefox differentiators</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Porting_a_Google_Chrome_extension\\\">Porting a Google Chrome extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Porting_a_legacy_Firefox_add-on\\\">Porting a legacy Firefox extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_the_Add-on_SDK\\\">Comparison with the Add-on SDK</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_XUL_XPCOM_extensions\\\">Comparison with XUL/XPCOM extensions</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\\\">Differences between API implementations</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\\\">Chrome incompatibilities</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Differences_between_desktop_and_Android\\\">Differences between desktop and Android</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Firefox workflow</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Development_Tools\\\">Developer tools</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Choose_a_Firefox_version_for_web_extension_develop\\\">Choose a Firefox version</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/User_experience_best_practices\\\">User Experience</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Prompt_users_for_data_and_privacy_consents\\\">Prompt users for data and privacy consents</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox\\\">Temporary Installation in Firefox</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Debugging\\\">Debugging</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Testing_persistent_and_restart_features\\\">Testing persistent and restart features</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Test_permission_requests\\\">Test permission requests</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Developing_WebExtensions_for_Firefox_for_Android\\\">Developing for Firefox for Android</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Getting_started_with_web-ext\\\">Getting started with web-ext</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/web-ext_command_reference\\\">web-ext command reference</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/WebExtensions_and_the_Add-on_ID\\\">Extensions and the Add-on ID</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Request_the_right_permissions\\\">Request the right permissions</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Best_practices_for_updating_your_extension\\\">Best practices for updating your extension</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>JavaScript APIs</summary>\\n        <ol><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\\\">Browser support for JavaScript APIs</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/alarms\\\">alarms</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\\\">bookmarks</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\\\">browserAction</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings\\\">browserSettings</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browsingData\\\">browsingData</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal\\\">captivePortal</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\\\">clipboard</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/commands\\\">commands</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\\\">contentScripts</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities\\\">contextualIdentities</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies\\\">cookies</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools\\\">devtools</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.inspectedWindow\\\">devtools.inspectedWindow</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.network\\\">devtools.network</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.panels\\\">devtools.panels</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/dns\\\">dns</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/downloads\\\">downloads</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/events\\\">events</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension\\\">extension</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes\\\">extensionTypes</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/find\\\">find</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/history\\\">history</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n\\\">i18n</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/identity\\\">identity</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/idle\\\">idle</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/management\\\">management</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/menus\\\">menus</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/notifications\\\">notifications</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/omnibox\\\">omnibox</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pageAction\\\">pageAction</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/permissions\\\">permissions</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11\\\">pkcs11</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/privacy\\\">privacy</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/proxy\\\">proxy</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime\\\">runtime</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/search\\\">search</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sessions\\\">sessions</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction\\\">sidebarAction</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage\\\">storage</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs\\\">tabs</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/theme\\\">theme</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/topSites\\\">topSites</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/types\\\">types</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/userScripts\\\">userScripts</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\\\">webNavigation</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\\\">webRequest</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/windows\\\">windows</a></li></ol>\\n      </details>\\n    </li>\\n\\n    <li class=\\\"toggle\\\">\\n      <details>\\n      <summary>Manifest keys</summary>\\n      <ol><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\\\">author</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\\\">background</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\\\">browser_action</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides\\\">chrome_settings_overrides</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides\\\">chrome_url_overrides</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands\\\">commands</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\\\">content_scripts</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy\\\">content_security_policy</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\\\">default_locale</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\\\">description</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\\\">developer</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page\\\">devtools_page</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries\\\">dictionaries</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable\\\">externally_connectable</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\\\">homepage_url</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\\\">icons</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito\\\">incognito</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\\\">manifest_version</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\\\">name</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled\\\">offline_enabled</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox\\\">omnibox</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions\\\">optional_permissions</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page\\\">options_page</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\\\">options_ui</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action\\\">page_action</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\\\">permissions</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers\\\">protocol_handlers</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\\\">short_name</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action\\\">sidebar_action</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage\\\">storage</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme\\\">theme</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment\\\">theme_experiment</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts\\\">user_scripts</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\\\">version</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name\\\">version_name</a></li><li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\\\">web_accessible_resources</a></li></ol>\\n      </details>\\n    </li>\\n    <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Distribution_options\\\">Distribution Options</a></li>\\n    <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Themes\\\"><strong>Themes</strong></a></li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Browser themes</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Themes/Theme_concepts\\\">Browser theme concepts</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Themes/Using_the_AMO_theme_generator\\\">Using the AMO theme generator</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Distribution\\\"><strong>Publishing and Distribution</strong></a></li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Publishing add-ons</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Developer_accounts\\\">Developer accounts</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Distribution\\\">Signing and distribution overview</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Package_your_extension_\\\">Package your extension</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Distribution/Submitting_an_add-on\\\">Submit an add-on</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Source_Code_Submission\\\">Source code submission</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Distribution/Resources_for_publishers\\\">Resources for publishers</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Listing\\\">Creating an appealing listing</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Distribution/Make_money_from_browser_extensions\\\">Make money from browser extensions</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Distribution/Promoting_your_extension_or_theme\\\">Promoting your extension or theme</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/AMO/Policy/Reviews\\\">Add-on policies</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/AMO/Policy/Agreement\\\">Developer agreement</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/AMO/Policy/Featured\\\">Featured add-ons</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Distribution/Retiring_your_extension\\\">Retiring your extension</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Distributing add-ons</summary>\\n        <ol>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Sideloading_add-ons\\\">For sideloading</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_for_desktop_apps\\\">For desktop apps</a></li>\\n          <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_in_the_enterprise\\\">For an enterprise</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n    <li><a href=\\\"/en-US/docs/Mozilla/Add-ons/Contact_us\\\"><strong>Contact us</strong></a></li>\\n    <li class=\\\"toggle\\\">\\n      <details>\\n        <summary>Channels</summary>\\n        <ol>\\n          <li><a class=\\\"external\\\" href=\\\"https://blog.mozilla.org/addons\\\" rel=\\\"noopener\\\">Add-ons blog</a></li>\\n          <li><a class=\\\"external\\\" href=\\\"https://discourse.mozilla.org/c/add-ons\\\" rel=\\\"noopener\\\">Add-ons forum</a></li>\\n          <li><a class=\\\"external\\\" href=\\\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\\\" rel=\\\"noopener\\\">Add-ons chat</a></li>\\n        </ol>\\n      </details>\\n    </li>\\n  </ol>\\n\",\"tocHTML\":\"<li><a href=\\\"#Setup\\\" rel=\\\"internal\\\">Setup</a><li><a href=\\\"#Exchanging_messages\\\" rel=\\\"internal\\\">Exchanging messages</a><li><a href=\\\"#Closing_the_native_app\\\" rel=\\\"internal\\\">Closing the native app</a><li><a href=\\\"#Troubleshooting\\\" rel=\\\"internal\\\">Troubleshooting</a><li><a href=\\\"#Chrome_incompatibilities\\\" rel=\\\"internal\\\">Chrome incompatibilities</a>\",\"raw\":\"<div>{{AddonSidebar}}</div>\\n\\n<p><span class=\\\"seoSummary\\\"><strong>Native messaging</strong> enables an extension to exchange messages with a native application installed on the user's computer. This enables native applications to provide a service to extensions without needing to be reachable over the web.</span></p>\\n\\n<p>One common example here is password managers: the native application manages storage and encryption of passwords, and communicates with the extension to populate web forms. Native messaging also enables extensions to access resources that are not accessible through WebExtension APIs, such as some particular piece of hardware.</p>\\n\\n<p>The native application is not installed or managed by the browser; it's installed using the underlying operating system's installation machinery. Along with the native application itself, you'll need to provide a JSON file called the \\\"host manifest\\\" or \\\"app manifest\\\", and install it in a defined location on the user's computer. The app manifest file describes how the browser can connect to the native application.</p>\\n\\n<p>The extension must request the <code>\\\"nativeMessaging\\\"</code> <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\\\">permission</a> in its <code>manifest.json</code> file. Conversely, the native application must grant permission for the extension by including its ID in the <code>\\\"allowed_extensions\\\"</code> field of the app manifest.</p>\\n\\n<p>After that the extension can exchange JSON messages with the native application using a set of functions in the {{WebExtAPIRef(\\\"runtime\\\")}} API. On the native app side, messages are received using standard input (<code>stdin</code>) and sent using standard output (<code>stdout</code>).</p>\\n\\n<p><img alt=\\\"\\\" src=\\\"https://mdn.mozillademos.org/files/13833/native-messaging.png\\\" style=\\\"display: block; height: 548px; margin-left: auto; margin-right: auto; width: 672px;\\\"></p>\\n\\n<p>Support for native messaging in extensions is mostly compatible with Chrome, with two main differences:</p>\\n\\n<ul>\\n <li>The app manifest lists <code>allowed_extensions</code> as an array of app IDs, while Chrome lists <code>allowed_origins</code>, as an array of <code>\\\"chrome-extension\\\"</code> URLs.</li>\\n <li>The app manifest is stored in a different location <a href=\\\"https://developer.chrome.com/extensions/nativeMessaging#native-messaging-host-location\\\">compared to Chrome</a>.</li>\\n</ul>\\n\\n<p>There's a complete example in the <a href=\\\"https://github.com/mdn/webextensions-examples/tree/master/native-messaging\\\">\\\"<code>native-messaging</code>\\\" directory</a> of the <code>\\\"webextensions-examples\\\"</code> repository on GitHub. Most example code in this article is taken from that example.</p>\\n\\n<h2 id=\\\"Setup\\\">Setup</h2>\\n\\n<h3 id=\\\"Extension_manifest\\\">Extension manifest</h3>\\n\\n<p>If you want your extension to communicate with a native application, then:</p>\\n\\n<ul>\\n <li>You must set the\u00A0<code>\\\"nativeMessaging\\\"</code> <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\\\">permission</a> in its <code><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json\\\">manifest.json</a></code> file.</li>\\n <li>You should probably specify your add-on ID explicitly, using the <code><a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a></code> manifest key. (This is because the app's manifest will identify the set of extensions that are allowed to connect to it by listing their IDs).</li>\\n</ul>\\n\\n<p>Here's an example <code>manifest.json</code> file:</p>\\n\\n<pre class=\\\"brush: json\\\">{\\n\\n  \\\"description\\\": \\\"Native messaging example add-on\\\",\\n  \\\"manifest_version\\\": 2,\\n  \\\"name\\\": \\\"Native messaging example\\\",\\n  \\\"version\\\": \\\"1.0\\\",\\n  \\\"icons\\\": {\\n    \\\"48\\\": \\\"icons/message.svg\\\"\\n  },\\n\\n  \\\"browser_specific_settings\\\": {\\n    \\\"gecko\\\": {\\n      \\\"id\\\": \\\"ping_pong@example.org\\\",\\n      \\\"strict_min_version\\\": \\\"50.0\\\"\\n    }\\n  },\\n\\n  \\\"background\\\": {\\n    \\\"scripts\\\": [\\\"background.js\\\"]\\n  },\\n\\n  \\\"browser_action\\\": {\\n    \\\"default_icon\\\": \\\"icons/message.svg\\\"\\n  },\\n \\n  \\\"permissions\\\": [\\\"nativeMessaging\\\"]\\n\\n}</pre>\\n\\n<div class=\\\"blockIndicator note\\\">\\n<p><strong>Note:</strong> Chrome does not support the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a> key. You will need to use another manifest without this key to install an equivalent WebExtension on Chrome. See <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities\\\">Chrome incompatibilities below</a>.</p>\\n</div>\\n\\n<h3 id=\\\"App_manifest\\\">App manifest</h3>\\n\\n<p>The app manifest describes to the browser how it can connect to the native application.</p>\\n\\n<p>The app manifest file must be installed along with the native application. That is, the browser reads and validates app manifest files but it does not install or manage them. Thus the security model for when and how these files are installed and updated is much more like that for native applications than that for extensions using WebExtension APIs.</p>\\n\\n<p>For details of native app manifest syntax and location, see <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_manifests\\\">Native manifests</a>.</p>\\n\\n<p>For example, here's a manifest for the <code>\\\"ping_pong\\\"</code> native application:</p>\\n\\n<pre class=\\\"brush: json\\\">{\\n  \\\"name\\\": \\\"ping_pong\\\",\\n  \\\"description\\\": \\\"Example host for native messaging\\\",\\n  \\\"path\\\": \\\"/path/to/native-messaging/app/ping_pong.py\\\",\\n  \\\"type\\\": \\\"stdio\\\",\\n  \\\"allowed_extensions\\\": [ \\\"ping_pong@example.org\\\" ]\\n}</pre>\\n\\n<p>This allows the extension whose ID is <code>\\\"ping_pong@example.org\\\"</code> to connect, by passing the name <code>\\\"ping_pong\\\"</code> into the relevant {{WebExtAPIRef(\\\"runtime\\\")}} API function. The application itself is at <code>\\\"/path/to/native-messaging/app/ping_pong.py\\\"</code>.</p>\\n\\n<div class=\\\"blockIndicator note\\\">\\n<p><strong>Note:</strong> Chrome identifies allowed extensions with another key: <code>allowed_origins</code>, using the ID of the WebExtension. Refer to <a href=\\\"https://developer.chrome.com/apps/nativeMessaging#native-messaging-host\\\">Chrome documentation for more details </a>and see <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities\\\">Chrome incompatibilities below</a>.</p>\\n</div>\\n\\n<h3 id=\\\"Windows_setup\\\">Windows setup</h3>\\n\\n<p>As an example, you can also refer to <a href=\\\"https://github.com/SphinxKnight/webextensions-examples/tree/master/native-messaging#windows-setup\\\">the readme on the native messaging extension on GitHub</a>. If you want to check your local setup after having forked this repository on a Windows machine, you may run <code>check_config_win.py</code> to troubleshoot some issues.</p>\\n\\n<h4 id=\\\"App_manifest_2\\\">App manifest</h4>\\n\\n<p>In the example above, the native application is a Python script. It can be difficult to get Windows to run Python scripts reliably in this way, so an alternative is to provide a <code>.bat</code> file, and link to that from the application's manifest:</p>\\n\\n<pre class=\\\"brush: json\\\">{\\n  \\\"name\\\": \\\"ping_pong\\\",\\n  \\\"description\\\": \\\"Example host for native messaging\\\",\\n  \\\"path\\\": \\\"c:\\\\\\\\path\\\\\\\\to\\\\\\\\native-messaging\\\\\\\\app\\\\\\\\ping_pong_win.bat\\\",\\n  \\\"type\\\": \\\"stdio\\\",\\n  \\\"allowed_extensions\\\": [ \\\"ping_pong@example.org\\\" ]\\n}</pre>\\n\\n<p>(See note above about <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#Chrome_incompatibilities\\\">Chrome compatiblity</a> regarding the <code>allowed_extensions</code> key and its counterpart in Chrome).</p>\\n\\n<p>The batch file then invokes the Python script:</p>\\n\\n<pre class=\\\"brush: bash\\\">@echo off\\n\\npython -u \\\"c:\\\\\\\\path\\\\\\\\to\\\\\\\\native-messaging\\\\\\\\app\\\\\\\\ping_pong.py\\\"</pre>\\n\\n<h4 id=\\\"Registry\\\">Registry</h4>\\n\\n<p>The browser is able to find the extension based on registry keys which are located in a specific location. You need to add them either programmatically with your final application or manually if you are using the example from GitHub. For more details, refer to <a href=\\\"/en-US/Add-ons/WebExtensions/Native_manifests#Manifest_location\\\">Manifest location</a>.</p>\\n\\n<p>Following with the <code>ping_pong</code> example, if using Firefox (see <a href=\\\"https://developer.chrome.com/apps/nativeMessaging#native-messaging-host-location\\\">this page for Chrome</a>), two registry entries should be created for the messaging to work:</p>\\n\\n<ul>\\n <li><code>HKEY_CURRENT_USER\\\\Software\\\\Mozilla\\\\NativeMessagingHosts\\\\ping_pong</code>\\n\\n  <ul>\\n   <li>The default value for this key should be the path to the <em>application</em> manifest: ex. <code>C:\\\\Users\\\\&lt;myusername&gt;\\\\webextensions-examples\\\\native-messaging\\\\app\\\\ping_pong.json</code></li>\\n  </ul>\\n </li>\\n <li><code>HKEY_LOCAL_MACHINE\\\\Software\\\\Mozilla\\\\NativeMessagingHosts\\\\ping_pong</code>\\n  <ul>\\n   <li>Idem, the default value for this key should be the path to the application manifest.</li>\\n  </ul>\\n </li>\\n</ul>\\n\\n<div class=\\\"note\\\">\\n<p><strong>Note:</strong> If you base your work on the example located on GitHub, please read <a href=\\\"https://github.com/SphinxKnight/webextensions-examples/tree/master/native-messaging#windows-setup\\\">this part of the readme</a> and check the output of <code>check_config_win.py</code> before installing the WebExtension on your browser.</p>\\n</div>\\n\\n<ul>\\n</ul>\\n\\n<h2 id=\\\"Exchanging_messages\\\">Exchanging messages</h2>\\n\\n<p>Given the above setup, an extension can exchange JSON messages with a native application.</p>\\n\\n<h3 id=\\\"Extension_side\\\">Extension side</h3>\\n\\n<p>Native messaging cannot directly be used in content scripts. You must\u00A0<a href=\\\"/en-US/Add-ons/WebExtensions/Content_scripts#Communicating_with_background_scripts\\\">do it indirectly via background scripts</a>.</p>\\n\\n<p>There are two patterns to use here: <strong>connection-based messaging</strong> and <strong>connectionless messaging</strong>.</p>\\n\\n<h4 id=\\\"Connection-based_messaging\\\">Connection-based messaging</h4>\\n\\n<p>With this pattern you call {{WebExtAPIRef(\\\"runtime.connectNative()\\\")}}, passing the name of the application (the value of the <code>\\\"name\\\"</code> property in the app's manifest). This launches the application if it is not already running and returns a {{WebExtAPIRef(\\\"runtime.Port\\\")}} object to the extension.</p>\\n\\n<p>Two arguments are passed to the native app when it starts:</p>\\n\\n<ul>\\n <li>The complete path to the app manifest</li>\\n <li>(new in Firefox 55) the ID (as given in the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a> <code>manifest.json</code> key) of the add-on that started it.</li>\\n</ul>\\n\\n<div class=\\\"note\\\">\\n<p>Chrome\u00A0 handles the passed arguments differently:</p>\\n\\n<ul>\\n <li>On Linux and Mac, Chrome passes <em>one</em> argument: the origin of the extension that started it (in the form\u00A0<code>chrome-extension://[extensionID]</code>). This enables the app to identify the extension.</li>\\n <li>On Windows, Chrome passes <em>two</em> arguments: the first is the origin of the extension, and the second is a handle to the Chrome native window that started the app.</li>\\n</ul>\\n</div>\\n\\n<p>The application stays running until the extension calls <code>Port.disconnect()</code> or the page that connected to it is closed.</p>\\n\\n<p>To send messages using <code>Port</code>, call its <code>postMessage()</code> function, passing the JSON message to send. To listen for messages using <code>Port</code>, add the listener using its <code>onMessage.addListener()</code> function.</p>\\n\\n<p>Here's an example background script that establishes a connection with the <code>\\\"ping_pong\\\"</code> app, listens for messages from it, then sends it a <code>\\\"ping\\\"</code> message whenever the user clicks the browser action:</p>\\n\\n<pre class=\\\"brush: js\\\">/*\\nOn startup, connect to the \\\"ping_pong\\\" app.\\n*/\\nvar port = browser.runtime.connectNative(\\\"ping_pong\\\");\\n\\n/*\\nListen for messages from the app.\\n*/\\nport.onMessage.addListener((response) =&gt; {\\n  console.log(\\\"Received: \\\" + response);\\n});\\n\\n/*\\nOn a click on the browser action, send the app a message.\\n*/\\nbrowser.browserAction.onClicked.addListener(() =&gt; {\\n  console.log(\\\"Sending:  ping\\\");\\n  port.postMessage(\\\"ping\\\");\\n});</pre>\\n\\n<h4 id=\\\"Connectionless_messaging\\\">Connectionless messaging</h4>\\n\\n<p>With this pattern you call {{WebExtAPIRef(\\\"runtime.sendNativeMessage()\\\")}}, passing it:</p>\\n\\n<ul>\\n <li>the name of the application</li>\\n <li>the JSON message to send</li>\\n <li>optionally, a callback.</li>\\n</ul>\\n\\n<p>A new instance of the app is created for each message. The app is passed two arguments when it starts:</p>\\n\\n<ul>\\n <li>the complete path to the app manifest</li>\\n <li>(new in Firefox 55) the ID (as given in the <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\\\">browser_specific_settings</a> manifest.json key) of the add-on that started it.</li>\\n</ul>\\n\\n<p>The first message sent by the app is treated as a response to the <code>sendNativeMessage()</code> call, and will be passed into the callback.</p>\\n\\n<p>Here's the example above, rewritten to use <code>runtime.sendNativeMessage()</code>:</p>\\n\\n<pre class=\\\"brush: js\\\">function onResponse(response) {\\n  console.log(\\\"Received \\\" + response);\\n}\\n\\nfunction onError(error) {\\n  console.log(`Error: ${error}`);\\n}\\n\\n/*\\nOn a click on the browser action, send the app a message.\\n*/\\nbrowser.browserAction.onClicked.addListener(() =&gt; {\\n  console.log(\\\"Sending:  ping\\\");\\n  var sending = browser.runtime.sendNativeMessage(\\n    \\\"ping_pong\\\",\\n    \\\"ping\\\");\\n  sending.then(onResponse, onError);\\n});\\n</pre>\\n\\n<h3 id=\\\"App_side\\\">App side</h3>\\n\\n<p>On the application side, you use standard input to receive messages and standard output to send them.</p>\\n\\n<p>Each message is serialized using JSON, UTF-8 encoded and is preceded with a 32-bit value containing the message length in native byte order.</p>\\n\\n<p>The maximum size of a single message from the application is 1 MB. The maximum size of a message sent to the application is 4 GB.</p>\\n\\n<p>You can quickly get started sending and receiving messages with this NodeJS code:</p>\\n\\n<pre class=\\\"brush: js\\\">#!/usr/local/bin/node\\n\\n(() =&gt; {\\n\\n    let payloadSize = null;\\n\\n    // A queue to store the chunks as we read them from stdin.\\n    // This queue can be flushed when `payloadSize` data has been read\\n    let chunks = [];\\n\\n    // Only read the size once for each payload\\n    const sizeHasBeenRead = () =&gt; Boolean(payloadSize);\\n\\n    // All the data has been read, reset everything for the next message\\n    const flushChunksQueue = () =&gt; {\\n        payloadSize = null;\\n        chunks.splice(0);\\n    };\\n\\n    const processData = () =&gt; {\\n        // Create one big buffer with all all the chunks\\n        const stringData = Buffer.concat(chunks);\\n\\n        // The browser will emit the size as a header of the payload,\\n        // if it hasn't been read yet, do it.\\n        // The next time we'll need to read the payload size is when all of the data\\n        // of the current payload has been read (ie. data.length &gt;= payloadSize + 4)\\n        if (!sizeHasBeenRead()) {\\n            payloadSize = stringData.readUInt32LE(0);\\n        }\\n\\n        // If the data we have read so far is &gt;= to the size advertised in the header,\\n        // it means we have all of the data sent.\\n        // We add 4 here because that's the size of the bytes that old the payloadSize\\n        if (stringData.length &gt;= (payloadSize + 4)) {\\n            // Remove the header\\n            const contentWithoutSize = stringData.slice(4, (payloadSize + 4));\\n\\n            // Reset the read size and the queued chunks\\n            flushChunksQueue();\\n\\n            const json = JSON.parse(contentWithoutSize);\\n            // Do something with the data...\\n            }\\n    };\\n\\n    process.stdin.on('readable', () =&gt; {\\n        // A temporary variable holding the nodejs.Buffer of each\\n        // chunk of data read off stdin\\n        let chunk = null;\\n\\n        // Read all of the available data\\n        while ((chunk = process.stdin.read()) !== null) {\\n            chunks.push(chunk);\\n        }\\n\\n        processData();\\n \\n    });\\n})();\\n</pre>\\n\\n<p>Here's another example written in Python. It listens for messages from the extension. Note that the file has to be executable on Linux. If the message is <code>\\\"ping\\\"</code>, then it responds with a message <code>\\\"pong\\\"</code>.</p>\\n\\n<p>This is the Python 2 version:</p>\\n\\n<pre class=\\\"brush: python\\\">#!/usr/bin/python -u\\n\\n# Note that running python with the `-u` flag is required on Windows,\\n# in order to ensure that stdin and stdout are opened in binary, rather\\n# than text, mode.\\n\\nimport json\\nimport sys\\nimport struct\\n\\n\\n# Read a message from stdin and decode it.\\ndef get_message():\\n    raw_length = sys.stdin.read(4)\\n    if not raw_length:\\n        sys.exit(0)\\n    message_length = struct.unpack('=I', raw_length)[0]\\n    message = sys.stdin.read(message_length)\\n    return json.loads(message)\\n\\n\\n# Encode a message for transmission, given its content.\\ndef encode_message(message_content):\\n    encoded_content = json.dumps(message_content)\\n    encoded_length = struct.pack('=I', len(encoded_content))\\n    return {'length': encoded_length, 'content': encoded_content}\\n\\n\\n# Send an encoded message to stdout.\\ndef send_message(encoded_message):\\n    sys.stdout.write(encoded_message['length'])\\n    sys.stdout.write(encoded_message['content'])\\n    sys.stdout.flush()\\n\\n\\nwhile True:\\n    message = get_message()\\n    if message == \\\"ping\\\":\\n        send_message(encode_message(\\\"pong\\\"))</pre>\\n\\n<p>In Python 3, the received binary data must be decoded into a string. The content to be sent back to the addon must be encoded into binary data using a struct:</p>\\n\\n<pre class=\\\"brush: python\\\">#!/usr/bin/python -u\\n\\n# Note that running python with the `-u` flag is required on Windows,\\n# in order to ensure that stdin and stdout are opened in binary, rather\\n# than text, mode.\\n\\nimport json\\nimport sys\\nimport struct\\n\\n\\n# Read a message from stdin and decode it.\\ndef get_message():\\n    raw_length = sys.stdin.buffer.read(4)\\n\\n    if not raw_length:\\n        sys.exit(0)\\n    message_length = struct.unpack('=I', raw_length)[0]\\n    message = sys.stdin.buffer.read(message_length).decode(\\\"utf-8\\\")\\n    return json.loads(message)\\n\\n\\n# Encode a message for transmission, given its content.\\ndef encode_message(message_content):\\n    encoded_content = json.dumps(message_content).encode(\\\"utf-8\\\")\\n    encoded_length = struct.pack('=I', len(encoded_content))\\n    #  use struct.pack(\\\"10s\\\", bytes), to pack a string of the length of 10 characters\\n    return {'length': encoded_length, 'content': struct.pack(str(len(encoded_content))+\\\"s\\\",encoded_content)}\\n\\n\\n# Send an encoded message to stdout.\\ndef send_message(encoded_message):\\n    sys.stdout.buffer.write(encoded_message['length'])\\n    sys.stdout.buffer.write(encoded_message['content'])\\n    sys.stdout.buffer.flush()\\n\\n\\nwhile True:\\n    message = get_message()\\n    if message == \\\"ping\\\":\\n        send_message(encode_message(\\\"pong\\\"))</pre>\\n\\n<h2 id=\\\"Closing_the_native_app\\\">Closing the native app</h2>\\n\\n<p>If you connected to the native application using <code>runtime.connectNative()</code>, then it stays running until the extension calls <code>Port.disconnect()</code> or the page that connected to it is closed. If you started the native application by sending <code>runtime.sendNativeMessage()</code>, then it is closed after it has received the message and sent a response.</p>\\n\\n<p>To close the native application:</p>\\n\\n<ul>\\n <li>On *nix systems like macOS and Linux, the browser sends <code>SIGTERM</code> to the native application, then <code>SIGKILL</code> after the application has had a chance to exit gracefully. These signals propagate to any subprocesses unless they break away into a new process group.</li>\\n <li>On Windows, the browser puts the native application's process into a <a href=\\\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684161(v=vs.85).aspx\\\">Job object</a>, and kills the job. If the native application launches any additional processes and wants them to remain open after the native application itself is killed, then the native application must launch the additional process with the\u00A0<code><a href=\\\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684863(v=vs.85).aspx\\\">CREATE_BREAKAWAY_FROM_JOB</a></code> flag.</li>\\n</ul>\\n\\n<h2 id=\\\"Troubleshooting\\\">Troubleshooting</h2>\\n\\n<p>If something goes wrong, check the <a href=\\\"/en-US/Add-ons/WebExtensions/Debugging#Viewing_log_output\\\">browser console</a>. If the native application sends any output to stderr, the browser will redirect it to the browser console. So if you've got as far as launching the native application, you will see any error messages it emits.</p>\\n\\n<p>If you haven't managed to run the application, you should see an error message giving you a clue about the problem.</p>\\n\\n<pre>\\\"No such native application &lt;name&gt;\\\"</pre>\\n\\n<ul>\\n <li>Check that the name passed to <code>runtime.connectNative()</code> matches the name in the app manifest</li>\\n <li>macOS/Linux: check that name of the app manifest is <code>&lt;name&gt;.json</code>.</li>\\n <li>macOS/Linux: check the native application's manifest file location as mentioned <a href=\\\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_manifests#Mac_OS_X\\\">here</a>.\u00A0</li>\\n <li>Windows: check that the registry key is in the correct place, and that its name matches the name in the app manifest.</li>\\n <li>Windows: check that the path given in the registry key points to the app manifest.</li>\\n</ul>\\n\\n<pre>\\\"Error: Invalid application &lt;name&gt;\\\"</pre>\\n\\n<ul>\\n <li>Check that the application's name contains no invalid characters.</li>\\n</ul>\\n\\n<pre>\\\"'python' is not recognized as an internal or external command, ...\\\"</pre>\\n\\n<ul>\\n <li>Windows: if your application is a Python script, check that you have Python installed and have your path set up for it.</li>\\n</ul>\\n\\n<pre>\\\"File at path &lt;path&gt; does not exist, or is not executable\\\"</pre>\\n\\n<ul>\\n <li>If you see this, then the app manifest has been found successfully.</li>\\n <li>Check that the \\\"path\\\" in the app's manifest is correct.</li>\\n <li>Windows: check that you've escaped the path separators (<code>\\\"c:\\\\\\\\path\\\\\\\\to\\\\\\\\file\\\"</code>).</li>\\n <li>Check that the app is at the location pointed to by the <code>\\\"path\\\"</code> property in the app's manifest.</li>\\n <li>Check that the app is executable.</li>\\n</ul>\\n\\n<pre>\\\"This extension does not have permission to use native application &lt;name&gt;\\\"</pre>\\n\\n<ul>\\n <li>Check that the <code>\\\"allowed_extensions\\\"</code> key in the app manifest contains the add-on's ID.</li>\\n</ul>\\n\\n<pre>\\\"TypeError: browser.runtime.connectNative is not a function\\\"</pre>\\n\\n<ul>\\n <li>Check that the extension has the <code>\\\"nativeMessaging\\\"</code> permission</li>\\n</ul>\\n\\n<pre>\\\"[object Object]       NativeMessaging.jsm:218\\\"</pre>\\n\\n<ul>\\n <li>There was a problem starting the application.</li>\\n</ul>\\n\\n<h2 id=\\\"Chrome_incompatibilities\\\">Chrome incompatibilities</h2>\\n\\n<p>{{Page(\\\"Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\\\", \\\"Native_messaging\\\")}}</p>\",\"parents\":[{\"url\":\"/en-US/docs/Mozilla\",\"title\":\"Mozilla\"},{\"url\":\"/en-US/docs/Mozilla/Add-ons\",\"title\":\"Add-ons\"},{\"url\":\"/en-US/docs/Mozilla/Add-ons/WebExtensions\",\"title\":\"Browser Extensions\"}],\"translations\":[{\"language\":\"Fran\u00E7ais\",\"hrefLang\":\"fr\",\"localizedLanguage\":\"French\",\"locale\":\"fr\",\"url\":\"/fr/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\",\"title\":\"Native messaging\"},{\"language\":\"\u65E5\u672C\u8A9E\",\"hrefLang\":\"ja\",\"localizedLanguage\":\"Japanese\",\"locale\":\"ja\",\"url\":\"/ja/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\",\"title\":\"Native messaging\"},{\"language\":\"\u4E2D\u6587 (\u7B80\u4F53)\",\"hrefLang\":\"zh\",\"localizedLanguage\":\"Chinese (Simplified)\",\"locale\":\"zh-CN\",\"url\":\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\",\"title\":\"\u4E0E\u672C\u5730\u5E94\u7528\u901A\u4FE1\"}],\"lastModified\":\"2020-04-30T01:40:54.154795\"}}");</script>


  
    <div id="auth-modal" class="modal hidden">
    <section class="auth-providers" tabindex="-1" role="dialog" aria-modal="true" aria-labelledby="modal-main-heading">
        <header>
            <h2 id="modal-main-heading">Sign In</h2>
        </header>
        
  <p>
    Sign in to enjoy the benefits of an MDN account. If you haven’t already created an account, you will be prompted to do so after signing in.
</p>
<div class="auth-button-container">
    <a href="/users/github/login/?next=%2Fen-US%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FNative_messaging" class="github-auth" data-first-focusable="true">
        Sign in with Github
    </a>
    <a href="/users/google/login/?next=%2Fen-US%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FNative_messaging" class="google-auth">
        Sign in with Google
    </a>
</div>

        <button id="close-modal" class="close-modal" data-last-focusable="true">
            <span>Close modal</span>
        </button>
    </section>
</div>
  

  <!-- site js -->
  <script defer="" type="text/javascript" src="/static/build/js/react-main.565de59c3f6c.js" charset="utf-8"></script>
  <script defer="" type="text/javascript" src="/static/build/js/mathml.3cb4c04c0706.js" charset="utf-8"></script>
  <script defer="" type="text/javascript" src="/static/build/js/auth-modal.119e5d70465f.js" charset="utf-8"></script>
  
    <script defer="" type="text/javascript" src="/static/build/js/react-bcd-signal.cf0fc711cfa2.js" charset="utf-8"></script>
  

</body>